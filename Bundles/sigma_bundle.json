{
    "type": "bundle",
    "id": "bundle--71fd1b72-cc4c-4319-9fec-3e000947bf60",
    "spec_version": "2.0",
    "objects": [
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0cf27d33-813e-45c1-a709-3328b216b98d",
            "created": "2018-12-03T23:30:44.303Z",
            "modified": "2018-12-03T23:30:44.303Z",
            "title": "Suspicious VSFTPD Error Messages",
            "description": "Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts",
            "references": [
                "https://github.com/dagwieers/vsftpd/"
            ],
            "author": "Florian Roth",
            "date": "2017/07/05",
            "logsource": {
                "product": "linux",
                "service": "vsftpd"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Connection refused: too many sessions for this address.",
                    "Connection refused: tcp_wrappers denial.",
                    "Bad HTTP verb.",
                    "port and pasv both active",
                    "pasv and port both active",
                    "Transfer done (but failed to open directory).",
                    "Could not set file modification time.",
                    "bug: pid active in ptrace_sandbox_free",
                    "PTRACE_SETOPTIONS failure",
                    "weird status:",
                    "couldn't handle sandbox event",
                    "syscall * out of bounds",
                    "syscall not permitted:",
                    "syscall validate failed:",
                    "Input line too long.",
                    "poor buffer accounting in str_netfd_alloc",
                    "vsf_sysutil_read_loop"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9fcde403-1e75-4d53-9265-670b62314a96",
            "created": "2018-12-03T23:30:44.305Z",
            "modified": "2018-12-03T23:30:44.305Z",
            "title": "Multiple Failed Logins with Different Accounts from Single Source System",
            "description": "Detects suspicious failed logins with different user accounts from a single source system",
            "logsource": {
                "product": "linux",
                "service": "auth"
            },
            "detection": {
                "condition": "selection | count(pam_user) by pam_rhost > 3",
                "selection": {
                    "pam_message": "authentication failure",
                    "pam_rhost": "*",
                    "pam_user": "*"
                },
                "timeframe": "24h"
            },
            "falsepositives": [
                "Terminal servers",
                "Jump servers",
                "Workstations with frequently changing users"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--23698c5c-6500-4b37-a296-0bdb3b577154",
            "created": "2018-12-03T23:30:44.307Z",
            "modified": "2018-12-03T23:30:44.307Z",
            "title": "Buffer Overflow Attempts",
            "description": "Detects buffer overflow attempts in Unix system log files",
            "references": [
                "https://github.com/ossec/ossec-hids/blob/master/etc/rules/attack_rules.xml"
            ],
            "logsource": {
                "product": "unix"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "attempt to execute code on stack by",
                    "FTP LOGIN FROM .* 0bin0sh",
                    "rpc.statd[\\d+]: gethostbyname error for",
                    "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                ]
            },
            "falsepositives": [
                "Unkown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--62906ba4-ea42-4ff2-be9d-fc6fd53a7886",
            "created": "2018-12-03T23:30:44.308Z",
            "modified": "2018-12-03T23:30:44.308Z",
            "title": "Shellshock Expression",
            "description": "Detects shellshock expressions in log files",
            "references": [
                "http://rubular.com/r/zxBfjWfFYs"
            ],
            "logsource": {
                "product": "linux"
            },
            "detection": {
                "condition": "expression",
                "expression": [
                    "/\\(\\)\\s*\\t*\\{.*;\\s*\\}\\s*;/"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0e121ce6-9b0c-4255-ad4e-66e85e280e5f",
            "created": "2018-12-03T23:30:44.309Z",
            "modified": "2018-12-03T23:30:44.309Z",
            "title": "SSHD Error Message CVE-2018-15473",
            "description": "Detects exploitation attempt using public exploit code for CVE-2018-15473",
            "references": [
                "https://github.com/Rhynorater/CVE-2018-15473-Exploit"
            ],
            "author": "Florian Roth",
            "date": "2017/08/24",
            "logsource": {
                "product": "linux",
                "service": "sshd"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "error: buffer_get_ret: trying to get more bytes 1907 than in buffer 308 [preauth]"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--5be7697e-94a1-4c42-bbd4-154b0146c113",
            "created": "2018-12-03T23:30:44.313Z",
            "modified": "2018-12-03T23:30:44.313Z",
            "title": "Suspicious Activity in Shell Commands",
            "description": "Detects suspicious shell commands used in various exploit codes (see references)",
            "references": [
                "http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html",
                "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb#L121",
                "http://pastebin.com/FtygZ1cg",
                "https://artkond.com/2017/03/23/pivoting-guide/"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "linux"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "wget * - http* | perl",
                    "wget * - http* | sh",
                    "wget * - http* | bash",
                    "python -m SimpleHTTPServer",
                    "import pty; pty.spawn",
                    "*wget *; chmod +x*",
                    "*wget *; chmod 777 *",
                    "*cd /tmp || cd /var/run || cd /mnt*",
                    "stop;service iptables stop;",
                    "stop;SuSEfirewall2 stop;",
                    "chmod 777 2020",
                    "\">>/etc/rc.local;",
                    "wget -c *;chmod 777",
                    "base64 -d /tmp/",
                    " | base64 -d",
                    "/bin/chmod u+s",
                    "chmod +s /tmp/",
                    "chmod u+s /tmp/",
                    "/tmp/haxhax",
                    "/tmp/ns_sploit",
                    "nc -l -p ",
                    "cp /bin/ksh ",
                    "cp /bin/sh ",
                    " /tmp/*.b64 ",
                    "/tmp/ysocereal.jar"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8a4056bb-a172-48e1-aec1-014b170f5afa",
            "created": "2018-12-03T23:30:44.315Z",
            "modified": "2018-12-03T23:30:44.315Z",
            "title": "Relevant ClamAV Message",
            "description": "Detects relevant ClamAV messages",
            "references": [
                "https://github.com/ossec/ossec-hids/blob/master/etc/rules/clam_av_rules.xml"
            ],
            "logsource": {
                "product": "linux",
                "service": "clamav"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Trojan*FOUND",
                    "VirTool*FOUND",
                    "Webshell*FOUND",
                    "Rootkit*FOUND",
                    "Htran*FOUND"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--39fea0e5-23c0-4967-839f-dbeaf4c66bf8",
            "created": "2018-12-03T23:30:44.316Z",
            "modified": "2018-12-03T23:30:44.316Z",
            "title": "Suspicious Named Error",
            "status": "experimental",
            "description": "Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts",
            "references": [
                "https://github.com/ossec/ossec-hids/blob/master/etc/rules/named_rules.xml"
            ],
            "author": "Florian Roth",
            "date": "2018/02/20",
            "logsource": {
                "product": "linux",
                "service": "syslog"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "* dropping source port zero packet from *",
                    "* denied AXFR from *",
                    "* exiting (due to fatal error)*"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c6f10d6d-74a9-4c0c-beba-4e3f1f4e7297",
            "created": "2018-12-03T23:30:44.319Z",
            "modified": "2018-12-03T23:30:44.319Z",
            "title": "Suspicious SSHD Error",
            "description": "Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts",
            "references": [
                "https://github.com/openssh/openssh-portable/blob/master/ssherr.c",
                "https://github.com/ossec/ossec-hids/blob/master/etc/rules/sshd_rules.xml"
            ],
            "author": "Florian Roth",
            "date": "2017/06/30",
            "logsource": {
                "product": "linux",
                "service": "sshd"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "*unexpected internal error*",
                    "*unknown or unsupported key type*",
                    "*invalid certificate signing key*",
                    "*invalid elliptic curve value*",
                    "*incorrect signature*",
                    "*error in libcrypto*",
                    "*unexpected bytes remain after decoding*",
                    "*fatal: buffer_get_string: bad string*",
                    "*Local: crc32 compensation attack*",
                    "*bad client public DH value*",
                    "*Corrupted MAC on input*"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3823518d-5137-4b0b-bf87-986df4c50a39",
            "created": "2018-12-03T23:30:44.320Z",
            "modified": "2018-12-03T23:30:44.320Z",
            "title": "JexBoss Command Sequence",
            "description": "Detects suspicious command sequence that JexBoss",
            "references": [
                "https://www.us-cert.gov/ncas/analysis-reports/AR18-312A"
            ],
            "author": "Florian Roth",
            "date": "2017/08/24",
            "logsource": {
                "product": "linux"
            },
            "detection": {
                "condition": "selection1 and selection2",
                "selection1": [
                    "bash -c /bin/bash"
                ],
                "selection2": [
                    "&/dev/tcp/"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--caf6014e-3603-4055-8ae8-0367689369c0",
            "created": "2018-12-03T23:30:44.322Z",
            "modified": "2018-12-03T23:30:44.322Z",
            "title": "Suspicious Log Entries",
            "description": "Detects suspicious log entries in Linux log files",
            "author": "Florian Roth",
            "logsource": {
                "product": "linux"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "entered promiscuous mode",
                    "Deactivating service",
                    "Oversized packet received from",
                    "imuxsock begins to drop messages"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8e2afc8d-7f01-480b-9e17-1e98aa614f70",
            "created": "2018-12-03T23:30:44.323Z",
            "modified": "2018-12-03T23:30:44.323Z",
            "title": "Multiple Modsecurity Blocks",
            "description": "Detects multiple blocks by the mod_security module (Web Application Firewall)",
            "logsource": {
                "product": "linux",
                "service": "modsecurity"
            },
            "detection": {
                "condition": "selection | count() > 6",
                "selection": [
                    "mod_security: Access denied",
                    "ModSecurity: Access denied",
                    "mod_security-message: Access denied"
                ],
                "timeframe": "120m"
            },
            "falsepositives": [
                "Vulnerability scanners",
                "Frequent attacks if system faces Internet"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--41b2880d-af3b-40d8-8b95-99112e97648c",
            "created": "2018-12-03T23:30:44.326Z",
            "modified": "2018-12-03T23:30:44.326Z",
            "title": "Detects Suspicious Commands on Linux systems",
            "status": "experimental",
            "description": "Detects relevant commands often related to malware or hacking activity",
            "references": [
                "Internal Research - mostly derived from exploit code including code in MSF"
            ],
            "author": "Florian Roth",
            "date": "2017/12/12",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "detection": {
                "cmds": [
                    {
                        "a0": "chmod",
                        "a1": "777",
                        "type": "EXECVE"
                    },
                    {
                        "a0": "chmod",
                        "a1": "u+s",
                        "type": "EXECVE"
                    },
                    {
                        "a0": "cp",
                        "a1": "/bin/ksh",
                        "type": "EXECVE"
                    },
                    {
                        "a0": "cp",
                        "a1": "/bin/sh",
                        "type": "EXECVE"
                    }
                ],
                "condition": "1 of cmds"
            },
            "falsepositives": [
                "Admin activity"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7c990be7-00c5-4869-88ea-9efa70b41d8f",
            "created": "2018-12-03T23:30:44.329Z",
            "modified": "2018-12-03T23:30:44.329Z",
            "title": "Program Executions in Suspicious Folders",
            "status": "experimental",
            "description": "Detects program executions in suspicious non-program folders related to malware or hacking activity",
            "references": [
                "Internal Research"
            ],
            "author": "Florian Roth",
            "date": "2018/01/23",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "exe": [
                        "/tmp/*",
                        "/var/www/*",
                        "/home/*/public_html/*",
                        "/usr/local/apache2/*",
                        "/usr/local/httpd/*",
                        "/var/apache/*",
                        "/srv/www/*",
                        "/home/httpd/html/*",
                        "/srv/http/*",
                        "/usr/share/nginx/html/*",
                        "/var/lib/pgsql/data/*",
                        "/usr/local/mysql/data/*",
                        "/var/lib/mysql/*",
                        "/var/vsftpd/*",
                        "/etc/bind/*",
                        "/var/named/*"
                    ],
                    "type": "SYSCALL"
                }
            },
            "falsepositives": [
                "Admin activity (especially in /tmp folders)",
                "Crazy web applications"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--949c29c6-b517-42d0-bf9a-ec60f66ca20c",
            "created": "2018-12-03T23:30:44.331Z",
            "modified": "2018-12-03T23:30:44.331Z",
            "title": "WMIExec VBS Script",
            "description": "Detects suspicious file execution by wscript and cscript",
            "references": [
                "https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": "*.vbs /shell *",
                    "EventID": 1,
                    "Image": "*\\cscript.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.execution",
                "attack.g0045",
                "attack.t1064"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6c88baa7-52aa-4630-b9d2-ba747a4e5d57",
            "created": "2018-12-03T23:30:44.333Z",
            "modified": "2018-12-03T23:30:44.333Z",
            "action": "global",
            "title": "APT29 Google Update Service Install",
            "description": "This method detects malicious services mentioned in APT29 report by FireEye. The legitimate path for the Google update service is C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe so the service names and executable locations used by APT29 are specific enough to be detected in log files.",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html"
            ],
            "logsource": {
                "product": "windows"
            },
            "detection": {
                "condition": "service | near process",
                "service": {
                    "EventID": 7045,
                    "ServiceName": "Google Update"
                },
                "timeframe": "5m"
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.command_and_control",
                "attack.g0016",
                "attack.t1172"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--104eee10-da93-430c-aa17-c00de321dd88",
            "created": "2018-12-03T23:30:44.333Z",
            "modified": "2018-12-03T23:30:44.333Z",
            "detection": {
                "process": {
                    "EventID": 4688,
                    "NewProcessName": [
                        "C:\\Program Files(x86)\\Google\\GoogleService.exe",
                        "C:\\Program Files(x86)\\Google\\GoogleUpdate.exe"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a700ee81-70e7-486a-a3f9-123ce3cfc365",
            "created": "2018-12-03T23:30:44.334Z",
            "modified": "2018-12-03T23:30:44.334Z",
            "detection": {
                "process": {
                    "EventID": 1,
                    "Image": [
                        "C:\\Program Files(x86)\\Google\\GoogleService.exe",
                        "C:\\Program Files(x86)\\Google\\GoogleUpdate.exe"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ece6148d-22fd-4a54-b912-7e719d5b74be",
            "created": "2018-12-03T23:30:44.338Z",
            "modified": "2018-12-03T23:30:44.338Z",
            "title": "Equation Group Indicators",
            "description": "Detects suspicious shell commands used in various Equation Group scripts and tools",
            "references": [
                "https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "linux"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "chown root*chmod 4777 ",
                    "cp /bin/sh .;chown",
                    "chmod 4777 /tmp/.scsi/dev/bin/gsh",
                    "chown root:root /tmp/.scsi/dev/bin/",
                    "chown root:root x;",
                    "/bin/telnet locip locport < /dev/console | /bin/sh",
                    "/tmp/ratload",
                    "ewok -t ",
                    "xspy -display ",
                    "cat > /dev/tcp/127.0.0.1/80 <<END",
                    "rm -f /current/tmp/ftshell.latest",
                    "ghost_* -v ",
                    " --wipe > /dev/null",
                    "ping -c 2 *; grep * /proc/net/arp >/tmp/gx",
                    "iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;",
                    "> /var/log/audit/audit.log; rm -f .",
                    "cp /var/log/audit/audit.log .tmp",
                    "sh >/dev/tcp/* <&1 2>&1",
                    "ncat -vv -l -p * <",
                    "nc -vv -l -p * <",
                    "< /dev/console | uudecode && uncompress",
                    "sendmail -osendmail;chmod +x sendmail",
                    "/usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron",
                    "chmod 666 /var/run/utmp~",
                    "chmod 700 nscd crond",
                    "cp /etc/shadow /tmp/.",
                    "</dev/console |uudecode > /dev/null 2>&1 && uncompress",
                    "chmod 700 jp&&netstat -an|grep",
                    "uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755",
                    "chmod 700 crond",
                    "wget http*; chmod +x /tmp/sendmail",
                    "chmod 700 fp sendmail pt",
                    "chmod 755 /usr/vmsys/bin/pipe",
                    "chmod -R 755 /usr/vmsys",
                    "chmod 755 $opbin/*tunnel",
                    "< /dev/console | uudecode && uncompress",
                    "chmod 700 sendmail",
                    "chmod 0700 sendmail",
                    "/usr/bin/wget http*sendmail;chmod +x sendmail;",
                    "&& telnet * 2>&1 </dev/console"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.g0020",
                "attack.t1059"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--19d30b24-529c-464a-a5cc-64b26ce3c5d2",
            "created": "2018-12-03T23:30:44.340Z",
            "modified": "2018-12-03T23:30:44.340Z",
            "action": "global",
            "title": "Turla Group Lateral Movement",
            "status": "experimental",
            "description": "Detects automated lateral movement by Turla group",
            "references": [
                "https://securelist.com/the-epic-turla-operation/65545/"
            ],
            "author": "Markus Neis",
            "date": "2017/11/07",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "falsepositives": [
                "Unknown"
            ],
            "tags": [
                "attack.lateral_movement",
                "attack.g0010"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--fa45d055-9656-4f79-b63d-c9a8f6cbdea0",
            "created": "2018-12-03T23:30:44.341Z",
            "modified": "2018-12-03T23:30:44.341Z",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "net use \\\\%DomainController%\\C$ \"P@ssw0rd\" *",
                        "dir c:\\*.doc* /s",
                        "dir %TEMP%\\*.exe"
                    ],
                    "EventID": 1
                }
            },
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--67ecde58-2299-4c4a-bd7c-b262a79e85d1",
            "created": "2018-12-03T23:30:44.342Z",
            "modified": "2018-12-03T23:30:44.342Z",
            "detection": {
                "condition": "netCommand1 | near netCommand2 and netCommand3",
                "netCommand1": {
                    "CommandLine": "net view /DOMAIN",
                    "EventID": 1
                },
                "netCommand2": {
                    "CommandLine": "net session",
                    "EventID": 1
                },
                "netCommand3": {
                    "CommandLine": "net share",
                    "EventID": 1
                },
                "timeframe": "1m"
            },
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--989ea2ec-65d4-4917-bfe2-45259c194940",
            "created": "2018-12-03T23:30:44.345Z",
            "modified": "2018-12-03T23:30:44.345Z",
            "title": "Pandemic Registry Key",
            "status": "experimental",
            "description": "Detects Pandemic Windows Implant",
            "references": [
                "https://wikileaks.org/vault7/#Pandemic",
                "https://twitter.com/MalwareJake/status/870349480356454401"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "EventID": 13,
                    "TargetObject": [
                        "\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\services\\null\\Instance*",
                        "\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\services\\null\\Instance*",
                        "\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet002\\services\\null\\Instance*"
                    ]
                },
                "selection2": {
                    "Command": "loaddll -a *",
                    "EventID": 1
                }
            },
            "fields": [
                "EventID",
                "CommandLine",
                "ParentCommandLine",
                "Image",
                "User",
                "TargetObject"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.lateral_movement",
                "attack.t1105"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1e0a7d4b-3ffc-4cce-a872-bb060356d452",
            "created": "2018-12-03T23:30:44.348Z",
            "modified": "2018-12-03T23:30:44.348Z",
            "title": "Turla Group Named Pipes",
            "status": "experimental",
            "description": "Detects a named pipe used by Turla group samples",
            "references": [
                "Internal Research"
            ],
            "author": "Markus Neis",
            "date": "2017/11/06",
            "logsource": {
                "product": "windows",
                "description": "Note that you have to configure logging for PipeEvents in Symson config",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        17,
                        18
                    ],
                    "PipeName": [
                        "\\atctl",
                        "\\userpipe",
                        "\\iehelper",
                        "\\sdlrpc",
                        "\\comnap"
                    ]
                }
            },
            "falsepositives": [
                "Unkown"
            ],
            "level": "critical",
            "tags": [
                "attack.g0010"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c938643c-86b6-4778-93ce-59300f0ca65d",
            "created": "2018-12-03T23:30:44.350Z",
            "modified": "2018-12-03T23:30:44.350Z",
            "title": "Equation Group C2 Communication",
            "description": "Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools",
            "references": [
                "https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation",
                "https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "firewall"
            },
            "detection": {
                "condition": "1 of them",
                "incoming": {
                    "src_ip": [
                        "69.42.98.86",
                        "89.185.234.145"
                    ]
                },
                "outgoing": {
                    "dst_ip": [
                        "69.42.98.86",
                        "89.185.234.145"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.command_and_control",
                "attack.g0020"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3267a282-8e27-4c9b-949e-2a33dbc6d9a4",
            "created": "2018-12-03T23:30:44.352Z",
            "modified": "2018-12-03T23:30:44.352Z",
            "title": "StoneDrill Service Install",
            "description": "This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky",
            "references": [
                "https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7045,
                    "ServiceFileName": "* LocalService",
                    "ServiceName": "NtsSrv"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "tags": [
                "attack.persistence",
                "attack.g0064",
                "attack.t1050"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--97423b0a-3864-4f3f-9d02-5fe4323a3e0c",
            "created": "2018-12-03T23:30:44.354Z",
            "modified": "2018-12-03T23:30:44.354Z",
            "title": "ZxShell Malware",
            "description": "Detects a ZxShell start by the called and well-known function name",
            "references": [
                "https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "Command": [
                        "rundll32.exe *,zxFunction*",
                        "rundll32.exe *,RemoteDiskXXXXX"
                    ],
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.g0001"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--37976598-b8da-4e3b-9552-7edd9ace4d4f",
            "created": "2018-12-03T23:30:44.356Z",
            "modified": "2018-12-03T23:30:44.356Z",
            "action": "global",
            "title": "Chafer Activity",
            "description": "Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018",
            "references": [
                "https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/"
            ],
            "author": "Florian Roth, Markus Neis",
            "date": "2018/03/23",
            "detection": {
                "condition": "1 of them"
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.g0049"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--60c0c8d9-e540-4a50-8ece-6d8d9e9ee701",
            "created": "2018-12-03T23:30:44.356Z",
            "modified": "2018-12-03T23:30:44.356Z",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "selection_service": {
                    "EventID": 7045,
                    "ServiceName": [
                        "SC Scheduled Scan",
                        "UpdatMachine"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--68151f48-5468-4da7-abfb-2000aae985a9",
            "created": "2018-12-03T23:30:44.359Z",
            "modified": "2018-12-03T23:30:44.359Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection_process1": {
                    "CommandLine": [
                        "*\\Service.exe i",
                        "*\\Service.exe u",
                        "*\\microsoft\\Taskbar\\autoit3.exe",
                        "C:\\wsc.exe*"
                    ],
                    "EventID": 1
                },
                "selection_process2": {
                    "EventID": 1,
                    "Image": "*\\Windows\\Temp\\DB\\*.exe"
                },
                "selection_process3": {
                    "CommandLine": "*\\nslookup.exe -q=TXT*",
                    "EventID": 1,
                    "ParentImage": "*\\Autoit*"
                },
                "selection_reg1": {
                    "EventID": 13,
                    "EventType": "SetValue",
                    "TargetObject": [
                        "*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UMe",
                        "*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UT"
                    ]
                },
                "selection_reg2": {
                    "EventID": 13,
                    "Details": "DWORD (0x00000001)",
                    "EventType": "SetValue",
                    "TargetObject": "*\\Control\\SecurityProviders\\WDigest\\UseLogonCredential"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--520bc7d1-e0d7-4aa9-8cee-ec4f3e56543a",
            "created": "2018-12-03T23:30:44.360Z",
            "modified": "2018-12-03T23:30:44.360Z",
            "title": "Turla PNG Dropper Service",
            "description": "This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018",
            "references": [
                "https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/november/turla-png-dropper-is-back/"
            ],
            "author": "Florian Roth",
            "date": "2018/11/23",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7045,
                    "ServiceName": "WerFaultSvc"
                }
            },
            "falsepositives": [
                "unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.command_and_control",
                "attack.g0016",
                "attack.t1172"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b350c899-09ab-447a-a653-c41e0b5c02fd",
            "created": "2018-12-03T23:30:44.362Z",
            "modified": "2018-12-03T23:30:44.362Z",
            "action": "global",
            "title": "Sofacy Zebrocy",
            "description": "Detects Sofacy's Zebrocy malware execution",
            "references": [
                "https://app.any.run/tasks/54acca9a-394e-4384-a0c8-91a96d36c81d"
            ],
            "author": "Florian Roth",
            "date": "2018/03/10",
            "detection": {
                "condition": "selection"
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.execution",
                "attack.g0020",
                "attack.t1059"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--24e58913-d562-4bd2-bda6-9d187170deb6",
            "created": "2018-12-03T23:30:44.363Z",
            "modified": "2018-12-03T23:30:44.363Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "CommandLine": "*cmd.exe /c SYSTEMINFO & TASKLIST",
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--cfd8eda9-4340-4591-91e7-bb0f270f3ab7",
            "created": "2018-12-03T23:30:44.364Z",
            "modified": "2018-12-03T23:30:44.364Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688,
                    "ProcessCommandLine": "*cmd.exe /c SYSTEMINFO & TASKLIST"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d6cc356e-80b9-4bd1-ba1f-6497a9d610ba",
            "created": "2018-12-03T23:30:44.365Z",
            "modified": "2018-12-03T23:30:44.365Z",
            "action": "global",
            "title": "CrackMapExecWin",
            "status": "experimental",
            "description": "Detects CrackMapExecWin Activity as Described by NCSC",
            "references": [
                "https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control"
            ],
            "author": "Markus Neis",
            "detection": {
                "condition": "1 of them"
            },
            "falsepositives": [
                "None"
            ],
            "level": "critical",
            "tags": [
                "attack.g0035"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--bceb4b87-0b7c-48b1-a39d-aaa749953974",
            "created": "2018-12-03T23:30:44.366Z",
            "modified": "2018-12-03T23:30:44.366Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection1": {
                    "EventID": 4688,
                    "NewProcessName": [
                        "*\\crackmapexec.exe"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--2f513e47-4eac-4d5e-84a9-fc5c78e3d612",
            "created": "2018-12-03T23:30:44.367Z",
            "modified": "2018-12-03T23:30:44.367Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection1": {
                    "EventID": 1,
                    "Image": [
                        "*\\crackmapexec.exe"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--175fe24a-f67b-4635-8b63-c133fc9db96b",
            "created": "2018-12-03T23:30:44.369Z",
            "modified": "2018-12-03T23:30:44.369Z",
            "action": "global",
            "title": "Equation Group DLL_U Load",
            "description": "Detects a specific tool and export used by EquationGroup",
            "references": [
                "https://github.com/adamcaudill/EquationGroupLeak/search?utf8=%E2%9C%93&q=dll_u&type=",
                "https://securelist.com/apt-slingshot/84312/",
                "https://twitter.com/cyb3rops/status/972186477512839170"
            ],
            "author": "Florian Roth",
            "date": "2018/03/10",
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "CommandLine": "*,dll_u",
                    "Image": "*\\rundll32.exe"
                },
                "selection2": {
                    "CommandLine": "* -export dll_u *"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.execution",
                "attack.g0020",
                "attack.t1059"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c3882ecc-d34a-413f-852b-ae02b087c9f3",
            "created": "2018-12-03T23:30:44.370Z",
            "modified": "2018-12-03T23:30:44.370Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection1": {
                    "EventID": 1
                },
                "selection2": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0591ac3d-8c94-4304-8f69-ea5151a2f3d1",
            "created": "2018-12-03T23:30:44.370Z",
            "modified": "2018-12-03T23:30:44.370Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection1": {
                    "EventID": 4688
                },
                "selection2": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--93529a64-cdb5-44e7-9c44-c78ff25fc137",
            "created": "2018-12-03T23:30:44.372Z",
            "modified": "2018-12-03T23:30:44.372Z",
            "action": "global",
            "title": "Sofacy Trojan Loader Activity",
            "status": "experimental",
            "description": "Detects Trojan loader acitivty as used by APT28",
            "references": [
                "https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities/",
                "https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100",
                "https://twitter.com/ClearskySec/status/960924755355369472"
            ],
            "author": "Florian Roth",
            "date": "2018/03/01",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "rundll32.exe %APPDATA%\\*.dat\",*",
                        "rundll32.exe %APPDATA%\\*.dll\",#1"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.g0007"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8555d2f8-d34b-47f9-9381-f7ff0c81187b",
            "created": "2018-12-03T23:30:44.373Z",
            "modified": "2018-12-03T23:30:44.373Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--851fc8e4-cb0f-4383-8a4a-91ccb5c6a350",
            "created": "2018-12-03T23:30:44.374Z",
            "modified": "2018-12-03T23:30:44.374Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0dface5f-ae3c-4aa9-81fe-c5023c729dc9",
            "created": "2018-12-03T23:30:44.375Z",
            "modified": "2018-12-03T23:30:44.375Z",
            "action": "global",
            "title": "Hurricane Panda Activity",
            "status": "experimental",
            "description": "Detects Hurricane Panda Activity",
            "references": [
                "https://www.crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/"
            ],
            "author": "Florian Roth",
            "date": "2018/02/25",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "* localgroup administrators admin /add",
                        "*\\Win64.exe*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.privilege_escalation",
                "attack.g0009",
                "attack.t1068"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1e638ec6-5b28-4bbf-adc3-cbe2491e39da",
            "created": "2018-12-03T23:30:44.376Z",
            "modified": "2018-12-03T23:30:44.376Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--2591389d-b915-4222-8da8-34742faf4b6e",
            "created": "2018-12-03T23:30:44.377Z",
            "modified": "2018-12-03T23:30:44.377Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7006cd74-c286-4ffb-9014-7619ad89eb75",
            "created": "2018-12-03T23:30:44.379Z",
            "modified": "2018-12-03T23:30:44.379Z",
            "title": "Ps.exe Renamed SysInternals Tool",
            "description": "Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documentied in TA17-293A report",
            "references": [
                "https://www.us-cert.gov/ncas/alerts/TA17-293A"
            ],
            "author": "Florian Roth",
            "date": "2017/10/22",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": "ps.exe -accepteula",
                    "EventID": 1
                }
            },
            "falsepositives": [
                "Renamed SysInternals tool"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.g0035",
                "attack.t1036"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a299419f-7990-45a5-8ac9-bbf8c0a17a51",
            "created": "2018-12-03T23:30:44.380Z",
            "modified": "2018-12-03T23:30:44.380Z",
            "title": "Turla Service Install",
            "description": "This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET",
            "references": [
                "https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/"
            ],
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7045,
                    "ServiceName": [
                        "srservice",
                        "ipvpn",
                        "hkmsvc"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.command_and_control",
                "attack.g0010",
                "attack.t1050"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ffd92fc2-6cd0-441d-a6b8-4044caf65762",
            "created": "2018-12-03T23:30:44.382Z",
            "modified": "2018-12-03T23:30:44.382Z",
            "title": "Fireball Archer Install",
            "status": "experimental",
            "description": "Detects Archer malware invocation via rundll32",
            "references": [
                "https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/",
                "https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100"
            ],
            "author": "Florian Roth",
            "date": "2017/06/03",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": "*\\rundll32.exe *,InstallArcherSvc",
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e270718c-04e9-4283-b3ee-0839f363dc66",
            "created": "2018-12-03T23:30:44.384Z",
            "modified": "2018-12-03T23:30:44.384Z",
            "action": "global",
            "title": "Defrag Deactivation",
            "description": "Detects the deactivation of the Scheduled defragmentation task as seen by Slingshot APT group",
            "references": [
                "https://securelist.com/apt-slingshot/84312/"
            ],
            "author": "Florian Roth",
            "date": "2018/03/10",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Audit Other Object Access Events > Success",
                "service": "security"
            },
            "detection": {
                "condition": "selection"
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "tags": [
                "attack.persistence"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8cf66534-1138-4900-8fc6-12527ecb5bb7",
            "created": "2018-12-03T23:30:44.385Z",
            "modified": "2018-12-03T23:30:44.385Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "CommandLine": [
                        "*schtasks* /delete *Defrag\\ScheduledDefrag*"
                    ],
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--43b43894-b01b-478c-9e4a-842dfa0bb8e7",
            "created": "2018-12-03T23:30:44.386Z",
            "modified": "2018-12-03T23:30:44.386Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Audit Other Object Access Events > Success",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4701,
                    "TaskName": "\\Microsoft\\Windows\\Defrag\\ScheduledDefrag"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--28bb029d-afae-4275-b3d8-c479dc7c4ccc",
            "created": "2018-12-03T23:30:44.388Z",
            "modified": "2018-12-03T23:30:44.388Z",
            "title": "Elise Backdoor",
            "status": "experimental",
            "description": "Detects Elise backdoor acitivty as used by APT32",
            "references": [
                "https://community.rsa.com/community/products/netwitness/blog/2018/01/30/apt32-continues-asean-targeting"
            ],
            "author": "Florian Roth",
            "date": "2018/01/31",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "CommandLine": "*\\Windows\\Caches\\NavShExt.dll *",
                    "EventID": 1,
                    "Image": "C:\\Windows\\SysWOW64\\cmd.exe"
                },
                "selection2": {
                    "CommandLine": "*\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting",
                    "EventID": 1
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.g0030",
                "attack.g0050",
                "attack.s0081"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--bb112f0c-2d22-487a-8642-38903669867e",
            "created": "2018-12-03T23:30:44.390Z",
            "modified": "2018-12-03T23:30:44.390Z",
            "title": "Telegram Bot API Request",
            "status": "experimental",
            "description": "Detects suspicious DNS queries to api.telegram.org used by Telegram Bots of any kind",
            "references": [
                "https://core.telegram.org/bots/faq",
                "https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/",
                "https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/",
                "https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/"
            ],
            "author": "Florian Roth",
            "date": "2018/06/05",
            "logsource": {
                "category": "dns"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "query": [
                        "api.telegram.org"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of Telegram bots in the company"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b1bee7d6-fb77-4e24-9640-4e394c0f3dff",
            "created": "2018-12-03T23:30:44.392Z",
            "modified": "2018-12-03T23:30:44.392Z",
            "title": "Network Scans",
            "description": "Detects many failed connection attempts to different ports or hosts",
            "author": "Thomas Patzke",
            "logsource": {
                "category": "firewall"
            },
            "detection": {
                "condition": [
                    "selection | count(dst_port) by src_ip > 10",
                    "selection | count(dst_ip) by src_ip > 10"
                ],
                "selection": {
                    "action": "denied"
                },
                "timeframe": "24h"
            },
            "fields": [
                "src_ip",
                "dst_ip",
                "dst_port"
            ],
            "falsepositives": [
                "Inventarization systems",
                "Vulnerability scans",
                "Penetration testing activity"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--748e9974-c3c4-4891-be6f-cca3e1705e07",
            "created": "2018-12-03T23:30:44.393Z",
            "modified": "2018-12-03T23:30:44.393Z",
            "title": "DNS TXT Answer with possible execution strings",
            "status": "experimental",
            "description": "Detects strings used in command execution in DNS TXT Answer",
            "references": [
                "https://twitter.com/stvemillertime/status/1024707932447854592",
                "https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1"
            ],
            "author": "Markus Neis",
            "date": "2018/08/08",
            "logsource": {
                "category": "dns"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "answer": [
                        "*IEX*",
                        "*Invoke-Expression*",
                        "*cmd.exe*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.t1071"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a38d93ee-407c-4072-9d6e-79571476a7c5",
            "created": "2018-12-03T23:30:44.395Z",
            "modified": "2018-12-03T23:30:44.395Z",
            "title": "Suspicious DNS Query with B64 Encoded String",
            "status": "experimental",
            "description": "Detects suspicious DNS queries using base64 encoding",
            "references": [
                "https://github.com/krmaxwell/dns-exfiltration"
            ],
            "author": "Florian Roth",
            "date": "2018/05/10",
            "logsource": {
                "category": "dns"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "query": [
                        "*==.*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--5b614591-dc0a-44ed-8a84-b04a4dae213c",
            "created": "2018-12-03T23:30:44.397Z",
            "modified": "2018-12-03T23:30:44.397Z",
            "title": "Cobalt Strike DNS Beaconing",
            "status": "experimental",
            "description": "Detects suspicious DNS queries known from Cobalt Strike beacons",
            "references": [
                "https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns"
            ],
            "author": "Florian Roth",
            "date": "2018/05/10",
            "logsource": {
                "category": "dns"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "query": [
                        "aaa.stage.*",
                        "post.1*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--87d79d23-5f29-4974-b7e2-76de7722f653",
            "created": "2018-12-03T23:30:44.401Z",
            "modified": "2018-12-03T23:30:44.401Z",
            "title": "Hack Tool User Agent",
            "status": "experimental",
            "description": "Detects suspicious user agent strings user by hack tools in proxy logs",
            "references": [
                "https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb",
                "http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "UserAgent": [
                        "*(hydra)*",
                        "* arachni/*",
                        "* BFAC *",
                        "* brutus *",
                        "* cgichk *",
                        "*core-project/1.0*",
                        "* crimscanner/*",
                        "*datacha0s*",
                        "*dirbuster*",
                        "*domino hunter*",
                        "*dotdotpwn*",
                        "FHScan Core",
                        "*floodgate*",
                        "*get-minimal*",
                        "*gootkit auto-rooter scanner*",
                        "*grendel-scan*",
                        "* inspath *",
                        "*internet ninja*",
                        "*jaascois*",
                        "* zmeu *",
                        "*masscan*",
                        "* metis *",
                        "*morfeus fucking scanner*",
                        "*n-stealth*",
                        "*nsauditor*",
                        "*pmafind*",
                        "*security scan*",
                        "*springenwerk*",
                        "*teh forest lobster*",
                        "*toata dragostea*",
                        "* vega/*",
                        "*voideye*",
                        "*webshag*",
                        "*webvulnscan*",
                        "* whcc/*",
                        "* Havij",
                        "*absinthe*",
                        "*bsqlbf*",
                        "*mysqloit*",
                        "*pangolin*",
                        "*sql power injector*",
                        "*sqlmap*",
                        "*sqlninja*",
                        "*uil2pn*",
                        "ruler",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--be12119c-dfe2-422c-804c-ce9fb6cd2017",
            "created": "2018-12-03T23:30:44.407Z",
            "modified": "2018-12-03T23:30:44.407Z",
            "title": "Download from Suspicious Dyndns Hosts",
            "status": "experimental",
            "description": "Detects download of certain file types from hosts with dynamic DNS names (selected list)",
            "references": [
                "https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats"
            ],
            "author": "Florian Roth",
            "date": "2017/11/08",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri-extension": [
                        "exe",
                        "vbs",
                        "bat",
                        "rar",
                        "ps1",
                        "doc",
                        "docm",
                        "xls",
                        "xlsm",
                        "pptm",
                        "rtf",
                        "hta",
                        "dll",
                        "ws",
                        "wsf",
                        "sct",
                        "zip"
                    ],
                    "r-dns": [
                        "*.hopto.org",
                        "*.no-ip.org",
                        "*.no-ip.info",
                        "*.no-ip.biz",
                        "*.no-ip.com",
                        "*.noip.com",
                        "*.ddns.name",
                        "*.myftp.org",
                        "*.myftp.biz",
                        "*.serveblog.net",
                        "*.servebeer.com",
                        "*.servemp3.com",
                        "*.serveftp.com",
                        "*.servequake.com",
                        "*.servehalflife.com",
                        "*.servehttp.com",
                        "*.servegame.com",
                        "*.servepics.com",
                        "*.myvnc.com",
                        "*.ignorelist.com",
                        "*.jkub.com",
                        "*.dlinkddns.com",
                        "*.jumpingcrab.com",
                        "*.ddns.info",
                        "*.mooo.com",
                        "*.dns-dns.com",
                        "*.strangled.net",
                        "*.ddns.info",
                        "*.adultdns.net",
                        "*.craftx.biz",
                        "*.ddns01.com",
                        "*.dns53.biz",
                        "*.dnsapi.info",
                        "*.dnsd.info",
                        "*.dnsdynamic.com",
                        "*.dnsdynamic.net",
                        "*.dnsget.org",
                        "*.fe100.net",
                        "*.flashserv.net",
                        "*.ftp21.net",
                        "*.http01.com",
                        "*.http80.info",
                        "*.https443.com",
                        "*.imap01.com",
                        "*.kadm5.com",
                        "*.mysq1.net",
                        "*.ns360.info",
                        "*.ntdll.net",
                        "*.ole32.com",
                        "*.proxy8080.com",
                        "*.sql01.com",
                        "*.ssh01.com",
                        "*.ssh22.net",
                        "*.tempors.com",
                        "*.tftpd.net",
                        "*.ttl60.com",
                        "*.ttl60.org",
                        "*.user32.com",
                        "*.voip01.com",
                        "*.wow64.net",
                        "*.x64.me",
                        "*.xns01.com",
                        "*.dyndns.org",
                        "*.dyndns.info",
                        "*.dyndns.tv",
                        "*.dyndns-at-home.com",
                        "*.dnsomatic.com",
                        "*.zapto.org",
                        "*.webhop.net",
                        "*.25u.com",
                        "*.slyip.net"
                    ]
                }
            },
            "fields": [
                "cs-ip",
                "c-uri"
            ],
            "falsepositives": [
                "Software downloads"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9212dcf1-fac7-4f9f-a648-2050853e45af",
            "created": "2018-12-03T23:30:44.413Z",
            "modified": "2018-12-03T23:30:44.413Z",
            "title": "Download from Suspicious TLD",
            "status": "experimental",
            "description": "Detects download of certain file types from hosts in suspicious TLDs",
            "references": [
                "https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap",
                "https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf",
                "https://www.spamhaus.org/statistics/tlds/",
                "https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/"
            ],
            "author": "Florian Roth",
            "date": "2018/06/13",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri-extension": [
                        "exe",
                        "vbs",
                        "bat",
                        "rar",
                        "ps1",
                        "doc",
                        "docm",
                        "xls",
                        "xlsm",
                        "pptm",
                        "rtf",
                        "hta",
                        "dll",
                        "ws",
                        "wsf",
                        "sct",
                        "zip"
                    ],
                    "r-dns": [
                        "*.country",
                        "*.stream",
                        "*.gdn",
                        "*.mom",
                        "*.xin",
                        "*.kim",
                        "*.men",
                        "*.loan",
                        "*.download",
                        "*.racing",
                        "*.online",
                        "*.science",
                        "*.ren",
                        "*.gb",
                        "*.win",
                        "*.top",
                        "*.review",
                        "*.vip",
                        "*.party",
                        "*.tech",
                        "*.tech",
                        "*.xyz",
                        "*.date",
                        "*.faith",
                        "*.zip",
                        "*.cricket",
                        "*.space",
                        "*.top",
                        "*.info",
                        "*.vn",
                        "*.cm",
                        "*.am",
                        "*.cc",
                        "*.asia",
                        "*.ws",
                        "*.tk",
                        "*.biz",
                        "*.su",
                        "*.st",
                        "*.ro",
                        "*.ge",
                        "*.ms",
                        "*.pk",
                        "*.nu",
                        "*.me",
                        "*.ph",
                        "*.to",
                        "*.tt",
                        "*.name",
                        "*.tv",
                        "*.kz",
                        "*.tc",
                        "*.mobi",
                        "*.study",
                        "*.click",
                        "*.link",
                        "*.trade",
                        "*.accountant",
                        "*.click",
                        "*.cf",
                        "*.gq",
                        "*.ml",
                        "*.ga"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL"
            ],
            "falsepositives": [
                "All kinds of software downloads"
            ],
            "level": "low"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d642adff-6bec-409a-9bee-865217aa0bfe",
            "created": "2018-12-03T23:30:44.415Z",
            "modified": "2018-12-03T23:30:44.415Z",
            "title": "CobaltStrike Malleable Amazon browsing traffic profile",
            "status": "experimental",
            "description": "Detects Malleable Amazon Profile",
            "references": [
                "https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile",
                "https://www.hybrid-analysis.com/sample/ee5eca8648e45e2fea9dac0d920ef1a1792d8690c41ee7f20343de1927cc88b9?environmentId=100"
            ],
            "author": "Markus Neis",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection1 or selection2",
                "selection1": {
                    "Cookie": "*=csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996",
                    "Host": "www.amazon.com",
                    "HttpMethod": "GET",
                    "URL": "/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books",
                    "UserAgent": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
                },
                "selection2": {
                    "HttpMethod": "POST",
                    "Host": "www.amazon.com",
                    "URL": "/N4215/adj/amzn.us.sr.aps",
                    "UserAgent": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.t1102"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--4e98b5e4-8eee-4ff1-937f-5ffb3a6294e9",
            "created": "2018-12-03T23:30:44.418Z",
            "modified": "2018-12-03T23:30:44.418Z",
            "title": "Suspicious User Agent",
            "status": "experimental",
            "description": "Detects suspicious malformed user agent strings in proxy logs",
            "references": [
                "https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection and not falsepositives",
                "falsepositives": {
                    "UserAgent": [
                        "Mozilla/3.0 * Acrobat *"
                    ]
                },
                "selection": {
                    "UserAgent": [
                        "user-agent",
                        "* (compatible;MSIE *",
                        "*.0;Windows NT *",
                        "Mozilla/3.0 *",
                        "Mozilla/2.0 *",
                        "Mozilla/1.0 *",
                        "Mozilla *",
                        " Mozilla/*",
                        "Mozila/*",
                        "_",
                        "CertUtil URL Agent"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f8a6b9ea-044a-4280-99ca-bea3537bbf68",
            "created": "2018-12-03T23:30:44.419Z",
            "modified": "2018-12-03T23:30:44.419Z",
            "title": "Empty User Agent",
            "status": "experimental",
            "description": "Detects suspicious empty user agent strings in proxy logs",
            "references": [
                "https://twitter.com/Carlos_Perez/status/883455096645931008"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "UserAgent": ""
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7191ede0-373a-41dc-ae5d-3d35795a8999",
            "created": "2018-12-03T23:30:44.421Z",
            "modified": "2018-12-03T23:30:44.421Z",
            "title": "Windows PowerShell User Agent",
            "status": "experimental",
            "description": "Detects Windows PowerShell Web Access",
            "references": [
                "https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "UserAgent": "* WindowsPowerShell/*"
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Administrative scripts that download files from the Internet",
                "Administrative scripts that retrieve certain website contents"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--97c406b3-0bcf-4d59-b26d-3ba97098c1d0",
            "created": "2018-12-03T23:30:44.423Z",
            "modified": "2018-12-03T23:30:44.423Z",
            "title": "Windows WebDAV User Agent",
            "status": "experimental",
            "description": "Detects WebDav DownloadCradle",
            "references": [
                "https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html"
            ],
            "author": "Florian Roth",
            "date": "2018/04/06",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "UserAgent": "Microsoft-WebDAV-MiniRedir/*",
                    "HttpMethod": "GET"
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent",
                "HttpMethod"
            ],
            "falsepositives": [
                "Administrative scripts that download files from the Internet",
                "Administrative scripts that retrieve certain website contents",
                "Legitimate WebDAV administration"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7fb8de28-073e-41ba-a9f3-c17175687dfc",
            "created": "2018-12-03T23:30:44.429Z",
            "modified": "2018-12-03T23:30:44.429Z",
            "title": "APT User Agent",
            "status": "experimental",
            "description": "Detects suspicious user agent strings used in APT malware in proxy logs",
            "references": [
                "Internal Research"
            ],
            "author": "Florian Roth, Markus Neis",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "UserAgent": [
                        "SJZJ (compatible; MSIE 6.0; Win32)",
                        "Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0",
                        "User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC",
                        "Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)",
                        "webclient",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200",
                        "Mozilla/4.0 (compatible; MSI 6.0;",
                        "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0",
                        "Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/",
                        "Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2",
                        "Mozilla/4.0",
                        "Netscape",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13 GTB7.1",
                        "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)",
                        "Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Win32)",
                        "Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1",
                        "Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)",
                        "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1)",
                        "Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko",
                        "Mozilla v5.1 *",
                        "MSIE 8.0",
                        "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)",
                        "Mozilla/4.0 (compatible; RMS)",
                        "Mozilla/4.0 (compatible; MSIE 6.0; DynGate)",
                        "O/9.27 (W; U; Z)"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Old browsers"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7506fec6-d851-4075-9f28-69895e7775a6",
            "created": "2018-12-03T23:30:44.431Z",
            "modified": "2018-12-03T23:30:44.431Z",
            "title": "Flash Player Update from Suspicious Location",
            "status": "experimental",
            "description": "Detects a flashplayer update from an unofficial location",
            "references": [
                "https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "cs-uri-stem": "*.adobe.com/*"
                },
                "selection": {
                    "cs-uri-query": [
                        "*/install_flash_player.exe",
                        "*/flash_install.php*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown flash download locations"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--df9848ea-afa2-41f1-847d-7082be35cb0a",
            "created": "2018-12-03T23:30:44.433Z",
            "modified": "2018-12-03T23:30:44.433Z",
            "title": "Telegram API Access",
            "status": "experimental",
            "description": "Detects suspicious requests to Telegram API without the usual Telegram User-Agent",
            "references": [
                "https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/",
                "https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/",
                "https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/"
            ],
            "author": "Florian Roth",
            "date": "2018/06/05",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "UserAgent": [
                        "*Telegram*",
                        "*Bot*"
                    ]
                },
                "selection": {
                    "r-dns": [
                        "api.telegram.org"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Legitimate use of Telegram bots in the company"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7083d757-dbba-4bb4-a450-cc032d6e455a",
            "created": "2018-12-03T23:30:44.436Z",
            "modified": "2018-12-03T23:30:44.436Z",
            "title": "Download EXE from Suspicious TLD",
            "status": "experimental",
            "description": "Detects executable downloads from suspicious remote systems",
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "r-dns": [
                        "*.com",
                        "*.org",
                        "*.net",
                        "*.edu",
                        "*.gov",
                        "*.uk",
                        "*.ca",
                        "*.de",
                        "*.jp",
                        "*.fr",
                        "*.au",
                        "*.us",
                        "*.ch",
                        "*.it",
                        "*.nl",
                        "*.se",
                        "*.no",
                        "*.es"
                    ]
                },
                "selection": {
                    "c-uri-extension": [
                        "exe",
                        "vbs",
                        "bat",
                        "rar",
                        "ps1",
                        "doc",
                        "docm",
                        "xls",
                        "xlsm",
                        "pptm",
                        "rtf",
                        "hta",
                        "dll",
                        "ws",
                        "wsf",
                        "sct",
                        "zip"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL"
            ],
            "falsepositives": [
                "All kind of software downloads"
            ],
            "level": "low"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9303f3e1-97c9-49c1-a883-da2f2d06289e",
            "created": "2018-12-03T23:30:44.440Z",
            "modified": "2018-12-03T23:30:44.440Z",
            "title": "Exploit Framework User Agent",
            "status": "experimental",
            "description": "Detects suspicious user agent strings used by exploit / pentest framworks like Metasploit in proxy logs",
            "references": [
                "https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "UserAgent": [
                        "Internet Explorer *",
                        "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)",
                        "Mozilla/4.0 (compatible; Metasploit RSPEC)",
                        "Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)",
                        "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)",
                        "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)",
                        "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E}; SLCC1; .N",
                        "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13",
                        "Mozilla/5.0",
                        "Mozilla/4.0 (compatible; SPIPE/1.0",
                        "Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0",
                        "Sametime Community Agent",
                        "X-FORWARDED-FOR",
                        "DotDotPwn v2.1",
                        "SIPDROID",
                        "*wordpress hash grabber*",
                        "*exploit*"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--cede1ecc-e150-4f2d-899f-cc73d497157c",
            "created": "2018-12-03T23:30:44.445Z",
            "modified": "2018-12-03T23:30:44.445Z",
            "title": "Malware User Agent",
            "status": "experimental",
            "description": "Detects suspicious user agent strings used by malware in proxy logs",
            "references": [
                "http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules",
                "http://www.botopedia.org/search?searchword=scan&searchphrase=all",
                "https://networkraptor.blogspot.com/2015/01/user-agent-strings.html",
                "https://perishablepress.com/blacklist/ua-2013.txt",
                "https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents"
            ],
            "author": "Florian Roth",
            "logsource": {
                "category": "proxy"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "UserAgent": [
                        "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)",
                        "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)",
                        "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)",
                        "HttpBrowser/1.0",
                        "*<|>*",
                        "nsis_inetc (mozilla)",
                        "Wget/1.9+cvs-stable (Red Hat modified)",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)",
                        "*zeroup*",
                        "Mozilla/5.0 (Windows NT 5.1 ; v.*",
                        "* adlib/*",
                        "* tiny",
                        "* BGroom *",
                        "* changhuatong",
                        "* CholTBAgent",
                        "Mozilla/5.0 WinInet",
                        "RookIE/1.0",
                        "M",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)",
                        "Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)",
                        "backdoorbot",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30731)",
                        "Opera/8.81 (Windows NT 6.0; U; en)",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30729)",
                        "Opera",
                        "Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)",
                        "Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)",
                        "MSIE",
                        "*(Charon; Inferno)",
                        "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)",
                        "Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)",
                        "* pxyscand*",
                        "* asd",
                        "* mdms",
                        "sample",
                        "nocase",
                        "Moxilla",
                        "Win32 *",
                        "*Microsoft Internet Explorer*",
                        "agent *",
                        "AutoIt",
                        "IczelionDownLoad"
                    ]
                }
            },
            "fields": [
                "ClientIP",
                "URL",
                "UserAgent"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9cff52f5-43d7-4fb7-9f85-b45d2a349cf1",
            "created": "2018-12-03T23:30:44.447Z",
            "modified": "2018-12-03T23:30:44.447Z",
            "title": "Python SQL Exceptions",
            "description": "Generic rule for SQL exceptions in Python according to PEP 249",
            "references": [
                "https://www.python.org/dev/peps/pep-0249/#exceptions"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "category": "application",
                "product": "python"
            },
            "detection": {
                "condition": "exceptions",
                "exceptions": [
                    "DataError",
                    "IntegrityError",
                    "ProgrammingError",
                    "OperationalError"
                ]
            },
            "falsepositives": [
                "Application bugs",
                "Penetration testing"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b10afd01-4e46-4fb2-b52b-7197223d4c4f",
            "created": "2018-12-03T23:30:44.449Z",
            "modified": "2018-12-03T23:30:44.449Z",
            "title": "Django framework exceptions",
            "description": "Detects suspicious Django web application framework exceptions that could indicate exploitation attempts",
            "references": [
                "https://docs.djangoproject.com/en/1.11/ref/exceptions/",
                "https://docs.djangoproject.com/en/1.11/topics/logging/#django-security"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "category": "application",
                "product": "django"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "SuspiciousOperation",
                    "DisallowedHost",
                    "DisallowedModelAdminLookup",
                    "DisallowedModelAdminToField",
                    "DisallowedRedirect",
                    "InvalidSessionKey",
                    "RequestDataTooBig",
                    "SuspiciousFileOperation",
                    "SuspiciousMultipartForm",
                    "SuspiciousSession",
                    "TooManyFieldsSent",
                    "PermissionDenied"
                ]
            },
            "falsepositives": [
                "Application bugs",
                "Penetration testing"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--07daad85-c525-4404-af21-8f6428a9e443",
            "created": "2018-12-03T23:30:44.451Z",
            "modified": "2018-12-03T23:30:44.451Z",
            "title": "Spring framework exceptions",
            "description": "Detects suspicious Spring framework exceptions that could indicate exploitation attempts",
            "references": [
                "https://docs.spring.io/spring-security/site/docs/current/apidocs/overview-tree.html"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "category": "application",
                "product": "spring"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "AccessDeniedException",
                    "CsrfException",
                    "InvalidCsrfTokenException",
                    "MissingCsrfTokenException",
                    "CookieTheftException",
                    "InvalidCookieException",
                    "RequestRejectedException"
                ]
            },
            "falsepositives": [
                "Application bugs",
                "Penetration testing"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1abc3312-c6dc-4522-9c97-58a8a985f64d",
            "created": "2018-12-03T23:30:44.453Z",
            "modified": "2018-12-03T23:30:44.453Z",
            "title": "Ruby on Rails framework exceptions",
            "description": "Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts",
            "references": [
                "http://edgeguides.rubyonrails.org/security.html",
                "http://guides.rubyonrails.org/action_controller_overview.html",
                "https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception",
                "https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "category": "application",
                "product": "ruby_on_rails"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "ActionController::InvalidAuthenticityToken",
                    "ActionController::InvalidCrossOriginRequest",
                    "ActionController::MethodNotAllowed",
                    "ActionController::BadRequest",
                    "ActionController::ParameterMissing"
                ]
            },
            "falsepositives": [
                "Application bugs",
                "Penetration testing"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7a01bd61-4746-4fc7-87d8-0b79df6e8df7",
            "created": "2018-12-03T23:30:44.455Z",
            "modified": "2018-12-03T23:30:44.455Z",
            "title": "Suspicious SQL Error Messages",
            "status": "experimental",
            "description": "Detects SQL error messages that indicate probing for an injection attack",
            "references": [
                "http://www.sqlinjection.net/errors"
            ],
            "author": "Bjoern Kimminich",
            "logsource": {
                "category": "application",
                "product": "sql"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "quoted string not properly terminated",
                    "You have an error in your SQL syntax",
                    "Unclosed quotation mark",
                    "near \"*\": syntax error",
                    "SELECTs to the left and right of UNION do not have the same number of result columns"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6df977d4-653e-4687-bd34-fdf8a944c8dc",
            "created": "2018-12-03T23:30:44.457Z",
            "modified": "2018-12-03T23:30:44.457Z",
            "title": "Oracle WebLogic Exploit",
            "status": "experimental",
            "description": "Detects access to a webshell droped into a keytore folder on the WebLogic server",
            "references": [
                "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894",
                "https://twitter.com/pyn3rd/status/1020620932967223296",
                "https://github.com/LandGrey/CVE-2018-2894"
            ],
            "author": "Florian Roth",
            "date": "2018/07/22",
            "logsource": {
                "category": "webserver"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri-path": [
                        "*/config/keystore/*.js*"
                    ]
                }
            },
            "fields": [
                "c-ip",
                "c-dns"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.t1100",
                "attack.t1190",
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "cve.2018-2894"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--41bf9109-c88c-4bef-8216-c9234d90e42d",
            "created": "2018-12-03T23:30:44.458Z",
            "modified": "2018-12-03T23:30:44.458Z",
            "title": "Apache Segmentation Fault",
            "description": "Detects a segmentation fault error message caused by a creashing apacke worker process",
            "references": [
                "http://www.securityfocus.com/infocus/1633"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "apache"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "exit signal Segmentation Fault"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9b75d860-60ef-47d6-808c-c13bc3cdb6f8",
            "created": "2018-12-03T23:30:44.460Z",
            "modified": "2018-12-03T23:30:44.460Z",
            "title": "Multiple suspicious Response Codes caused by Single Client",
            "description": "Detects possible exploitation activity or bugs in a web application",
            "author": "Thomas Patzke",
            "logsource": {
                "category": "webserver"
            },
            "detection": {
                "condition": "selection | count() by clientip > 10",
                "selection": {
                    "response": [
                        400,
                        401,
                        403,
                        500
                    ]
                },
                "timeframe": "10m"
            },
            "fields": [
                "client_ip",
                "vhost",
                "url",
                "response"
            ],
            "falsepositives": [
                "Unstable application",
                "Application that misuses the response codes"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e9b0492e-4c4a-43e8-93d2-1fa9d5e11a89",
            "created": "2018-12-03T23:30:44.462Z",
            "modified": "2018-12-03T23:30:44.462Z",
            "title": "Webshell Detection by Keyword",
            "description": "Detects webshells that use GET requests by keyword searches in URL strings",
            "author": "Florian Roth",
            "logsource": {
                "category": "webserver"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "=whoami",
                    "=net%20user",
                    "=cmd%20/c%20"
                ]
            },
            "fields": [
                "client_ip",
                "vhost",
                "url",
                "response"
            ],
            "falsepositives": [
                "Web sites like wikis with articles on os commands and pages that include the os commands in the URLs",
                "User searches in search boxes of the respective website"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3c4e5cf8-8820-4d57-b299-1ae970cf3752",
            "created": "2018-12-03T23:30:44.465Z",
            "modified": "2018-12-03T23:30:44.465Z",
            "title": "Antivirus Exploitation Framework Detection",
            "description": "Detects a highly relevant Antivirus alert that reports an exploitation framework",
            "references": [
                "https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/"
            ],
            "author": "Florian Roth",
            "date": "2018/09/09",
            "logsource": {
                "product": "antivirus"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "Signature": [
                        "*MeteTool*",
                        "*Meterpreter*",
                        "*Metasploit*",
                        "*PowerSploit*",
                        "*CobaltSrike*"
                    ]
                }
            },
            "fields": [
                "FileName",
                "User"
            ],
            "falsepositives": [
                "Unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.execution",
                "attack.t1203",
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--76e59961-1d26-4b20-82b2-17dd3d51d9e5",
            "created": "2018-12-03T23:30:44.468Z",
            "modified": "2018-12-03T23:30:44.468Z",
            "title": "NotPetya Ransomware Activity",
            "status": "experimental",
            "description": "Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil",
            "references": [
                "https://securelist.com/schroedingers-petya/78870/",
                "https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100"
            ],
            "author": "Florian Roth, Tom Ueltschi",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "event_clean": {
                    "CommandLine": "* cl *",
                    "EventID": 1,
                    "Image": "*\\wevtutil.exe"
                },
                "fsutil_clean_journal": {
                    "CommandLine": "* deletejournal *",
                    "EventID": 1,
                    "Image": "*\\fsutil.exe"
                },
                "perfc_keyword": [
                    "*\\perfc.dat*"
                ],
                "pipe_com": {
                    "CommandLine": "*\\AppData\\Local\\Temp\\* \\\\.\\pipe\\*",
                    "EventID": 1
                },
                "rundll32_dash1": {
                    "CommandLine": "*.dat,#1",
                    "EventID": 1,
                    "Image": "*\\rundll32.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Admin activity"
            ],
            "level": "critical",
            "tags": [
                "attack.execution",
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.t1085",
                "attack.t1070",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c4db2ad1-c3a7-4fc0-b75b-49631f704df8",
            "created": "2018-12-03T23:30:44.470Z",
            "modified": "2018-12-03T23:30:44.470Z",
            "title": "Antivirus Web Shell Detection",
            "description": "Detects a highly relevant Antivirus alert that reports a web shell",
            "references": [
                "https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/"
            ],
            "author": "Florian Roth",
            "date": "2018/09/09",
            "logsource": {
                "product": "antivirus"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "Signature": [
                        "PHP/Backdoor",
                        "JSP/Backdoor",
                        "ASP/Backdoor",
                        "Backdoor.PHP",
                        "Backdoor.JSP",
                        "Backdoor.ASP",
                        "*Webshell*"
                    ]
                }
            },
            "fields": [
                "FileName",
                "User"
            ],
            "falsepositives": [
                "Unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.persistence",
                "attack.t1100"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--4c30bc24-dbb9-47a8-b0da-9bcde27692f7",
            "created": "2018-12-03T23:30:44.472Z",
            "modified": "2018-12-03T23:30:44.472Z",
            "title": "Antivirus Password Dumper Detection",
            "description": "Detects a highly relevant Antivirus alert that reports a password dumper",
            "references": [
                "https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/"
            ],
            "author": "Florian Roth",
            "date": "2018/09/09",
            "logsource": {
                "product": "antivirus"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "Signature": [
                        "*DumpCreds*",
                        "*Mimikatz*",
                        "*PWCrack*",
                        "HTool/WCE",
                        "*PSWtool*",
                        "*PWDump*"
                    ]
                }
            },
            "fields": [
                "FileName",
                "User"
            ],
            "falsepositives": [
                "Unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3ae887a8-6eb6-4053-bfb4-ef76538dcde8",
            "created": "2018-12-03T23:30:44.475Z",
            "modified": "2018-12-03T23:30:44.475Z",
            "title": "Antivirus Exploitation Framework Detection",
            "description": "Detects an Antivirus alert in a highly relevant file path or with a relevant file name",
            "references": [
                "https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/"
            ],
            "author": "Florian Roth",
            "date": "2018/09/09",
            "logsource": {
                "product": "antivirus"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "FileName": [
                        "C:\\Windows\\Temp\\*",
                        "C:\\Temp\\*",
                        "*\\\\Client\\*",
                        "C:\\PerfLogs\\*",
                        "C:\\Users\\Public\\*",
                        "C:\\Users\\Default\\*",
                        "*.ps1",
                        "*.vbs",
                        "*.bat",
                        "*.chm",
                        "*.xml",
                        "*.txt",
                        "*.jsp",
                        "*.jspx",
                        "*.asp",
                        "*.aspx",
                        "*.php",
                        "*.war"
                    ]
                }
            },
            "fields": [
                "Signature",
                "User"
            ],
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--02625d96-e25b-4bce-97ba-b18a06346b58",
            "created": "2018-12-03T23:30:44.478Z",
            "modified": "2018-12-03T23:30:44.478Z",
            "title": "WannaCry Ransomware via Sysmon",
            "status": "experimental",
            "description": "Detects WannaCry ransomware activity via Sysmon",
            "references": [
                "https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100"
            ],
            "author": "Florian Roth (rule), Tom U. @c_APT_ure (collection)",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "EventID": 1,
                    "Image": [
                        "*\\tasksche.exe",
                        "*\\mssecsvc.exe",
                        "*\\taskdl.exe",
                        "*\\@WanaDecryptor@*",
                        "*\\taskhsvc.exe",
                        "*\\taskse.exe",
                        "*\\111.exe",
                        "*\\lhdfrgui.exe",
                        "*\\diskpart.exe",
                        "*\\linuxnew.exe",
                        "*\\wannacry.exe"
                    ]
                },
                "selection2": {
                    "CommandLine": [
                        "*vssadmin delete shadows*",
                        "*icacls * /grant Everyone:F /T /C /Q*",
                        "*bcdedit /set {default} recoveryenabled no*",
                        "*wbadmin delete catalog -quiet*",
                        "*@Please_Read_Me@.txt*"
                    ],
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Diskpart.exe usage to manage partitions on the local hard drive"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8fa3012c-0427-4f4a-8995-129c87e0cd39",
            "created": "2018-12-03T23:30:44.479Z",
            "modified": "2018-12-03T23:30:44.479Z",
            "action": "global",
            "title": "Adwind RAT / JRAT",
            "status": "experimental",
            "description": "Detects javaw.exe in AppData folder as used by Adwind / JRAT",
            "references": [
                "https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100",
                "https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf"
            ],
            "author": "Florian Roth, Tom Ueltschi",
            "date": "2017/11/10",
            "detection": {
                "condition": "selection"
            },
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9d9040b8-9f0c-425c-97a8-535eea1d035b",
            "created": "2018-12-03T23:30:44.481Z",
            "modified": "2018-12-03T23:30:44.481Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688,
                    "CommandLine": [
                        "*\\AppData\\Roaming\\Oracle*\\java*.exe *",
                        "*cscript.exe *Retrive*.vbs *"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--25bc327c-ab52-46ff-aca8-cf1719018432",
            "created": "2018-12-03T23:30:44.481Z",
            "modified": "2018-12-03T23:30:44.481Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1,
                    "Image": "*\\AppData\\Roaming\\Oracle\\bin\\java*.exe"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--01f46930-9b33-47a3-a69c-2329c6a75ef5",
            "created": "2018-12-03T23:30:44.482Z",
            "modified": "2018-12-03T23:30:44.482Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 11,
                    "TargetFilename": [
                        "*\\AppData\\Roaming\\Oracle\\bin\\java*.exe",
                        "*\\Retrive*.vbs"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--4f2f25a1-4459-4574-b3cd-7a596cb5c771",
            "created": "2018-12-03T23:30:44.483Z",
            "modified": "2018-12-03T23:30:44.483Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 13,
                    "Details": "%AppData%\\Roaming\\Oracle\\bin\\*",
                    "TargetObject": "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run*"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e4783669-8564-40df-a19d-21a219a7edba",
            "created": "2018-12-03T23:30:44.485Z",
            "modified": "2018-12-03T23:30:44.485Z",
            "action": "global",
            "title": "WannaCry Ransomware",
            "status": "experimental",
            "description": "Detects WannaCry Ransomware Activity",
            "references": [
                "https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa"
            ],
            "author": "Florian Roth",
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "CommandLine": [
                        "*vssadmin delete shadows*",
                        "*icacls * /grant Everyone:F /T /C /Q*",
                        "*bcdedit /set {default} recoveryenabled no*",
                        "*wbadmin delete catalog -quiet*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--83d54c76-fec4-43c5-b7c0-7eb4acef31d6",
            "created": "2018-12-03T23:30:44.486Z",
            "modified": "2018-12-03T23:30:44.486Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection1": {
                    "EventID": 4688
                },
                "selection2": {
                    "EventID": 4688,
                    "NewProcessName": [
                        "*\\tasksche.exe",
                        "*\\mssecsvc.exe",
                        "*\\taskdl.exe",
                        "*\\WanaDecryptor*",
                        "*\\taskhsvc.exe",
                        "*\\taskse.exe",
                        "*\\111.exe",
                        "*\\lhdfrgui.exe",
                        "*\\diskpart.exe",
                        "*\\linuxnew.exe",
                        "*\\wannacry.exe"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--250ef30f-801d-46f2-a167-c3abdfc6f628",
            "created": "2018-12-03T23:30:44.488Z",
            "modified": "2018-12-03T23:30:44.488Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection1": {
                    "EventID": 1
                },
                "selection2": {
                    "EventID": 1,
                    "Image": [
                        "*\\tasksche.exe",
                        "*\\mssecsvc.exe",
                        "*\\taskdl.exe",
                        "*\\WanaDecryptor*",
                        "*\\taskhsvc.exe",
                        "*\\taskse.exe",
                        "*\\111.exe",
                        "*\\lhdfrgui.exe",
                        "*\\diskpart.exe",
                        "*\\linuxnew.exe",
                        "*\\wannacry.exe"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d4846b43-ba07-4f7c-b718-fd3b09e1f463",
            "created": "2018-12-03T23:30:44.490Z",
            "modified": "2018-12-03T23:30:44.490Z",
            "action": "global",
            "title": "MsiExec Web Install",
            "status": "experimental",
            "description": "Detects suspicious msiexec proess starts with web addreses as parameter",
            "references": [
                "https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/"
            ],
            "author": "Florian Roth",
            "date": "2018/02/09",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "* msiexec*:\\/\\/*"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ada244e9-6e69-405b-a594-5c18847078bd",
            "created": "2018-12-03T23:30:44.491Z",
            "modified": "2018-12-03T23:30:44.491Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7476ccf1-ae38-4ceb-b622-dc7630f90960",
            "created": "2018-12-03T23:30:44.491Z",
            "modified": "2018-12-03T23:30:44.491Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--33149f26-0c67-47b3-b703-1e4de99438da",
            "created": "2018-12-03T23:30:44.494Z",
            "modified": "2018-12-03T23:30:44.494Z",
            "title": "Secure Deletion with SDelete",
            "status": "experimental",
            "description": "Detects renaming of file while deletion with SDelete tool",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet",
                "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
                "https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4656,
                        4663,
                        4658
                    ],
                    "ObjectName": [
                        "*.AAA",
                        "*.ZZZ"
                    ]
                }
            },
            "falsepositives": [
                "Legitime usage of SDelete"
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.t1107",
                "attack.t1116",
                "attack.s0195"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c1001be7-4b60-4ea5-ae76-404be2fc936f",
            "created": "2018-12-03T23:30:44.495Z",
            "modified": "2018-12-03T23:30:44.495Z",
            "action": "global",
            "title": "PowerShell Base64 Encoded Shellcode",
            "status": "experimental",
            "description": "Detects Base64 encoded Shellcode",
            "references": [
                "https://twitter.com/cyb3rops/status/1063072865992523776"
            ],
            "author": "Florian Roth",
            "date": "2018/11/17",
            "detection": {
                "condition": "selection1 and selection2"
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--abfc9fa6-18ad-4452-a1ff-d65403cb898d",
            "created": "2018-12-03T23:30:44.496Z",
            "modified": "2018-12-03T23:30:44.496Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection1": {
                    "EventID": 4688,
                    "ProcesssCommandLine": "*AAAAYInlM*"
                },
                "selection2": {
                    "ProcesssCommandLine": [
                        "*OiCAAAAYInlM*",
                        "*OiJAAAAYInlM*"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--79573189-3969-41f0-aa17-dca93da1423e",
            "created": "2018-12-03T23:30:44.497Z",
            "modified": "2018-12-03T23:30:44.497Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection1": {
                    "CommandLine": "*AAAAYInlM*",
                    "EventID": 1
                },
                "selection2": {
                    "CommandLine": [
                        "*OiCAAAAYInlM*",
                        "*OiJAAAAYInlM*"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0f039264-f4f0-4117-99e5-b101a81946ea",
            "created": "2018-12-03T23:30:44.499Z",
            "modified": "2018-12-03T23:30:44.499Z",
            "action": "global",
            "title": "WMI Persistence - Script Event Consumer",
            "status": "experimental",
            "description": "Detects WMI script event consumers",
            "references": [
                "https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/"
            ],
            "author": "Thomas Patzke",
            "date": "2018/03/07",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image": "C:\\WINDOWS\\system32\\wbem\\scrcons.exe",
                    "ParentImage": "C:\\Windows\\System32\\svchost.exe"
                }
            },
            "falsepositives": [
                "Legitimate event consumers"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1047"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--54995a03-0869-4a24-8385-73cb36ef60bd",
            "created": "2018-12-03T23:30:44.500Z",
            "modified": "2018-12-03T23:30:44.500Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b945e40a-2551-4f82-b109-a7b357399c7d",
            "created": "2018-12-03T23:30:44.501Z",
            "modified": "2018-12-03T23:30:44.501Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--cf81025b-3103-4b5d-a235-65f64afca12d",
            "created": "2018-12-03T23:30:44.504Z",
            "modified": "2018-12-03T23:30:44.504Z",
            "action": "global",
            "title": "Quick Execution of a Series of Suspicious Commands",
            "status": "experimental",
            "description": "Detects multiple suspicious process in a limited timeframe",
            "references": [
                "https://car.mitre.org/wiki/CAR-2013-04-002"
            ],
            "author": "juju4",
            "detection": {
                "condition": "selection | count() by MachineName > 5",
                "selection": {
                    "CommandLine": [
                        "arp.exe",
                        "at.exe",
                        "attrib.exe",
                        "cscript.exe",
                        "dsquery.exe",
                        "hostname.exe",
                        "ipconfig.exe",
                        "mimikatz.exe",
                        "nbstat.exe",
                        "net.exe",
                        "netsh.exe",
                        "nslookup.exe",
                        "ping.exe",
                        "quser.exe",
                        "qwinsta.exe",
                        "reg.exe",
                        "runas.exe",
                        "sc.exe",
                        "schtasks.exe",
                        "ssh.exe",
                        "systeminfo.exe",
                        "taskkill.exe",
                        "telnet.exe",
                        "tracert.exe",
                        "wscript.exe",
                        "xcopy.exe",
                        "pscp.exe",
                        "copy.exe",
                        "robocopy.exe",
                        "certutil.exe",
                        "vssadmin.exe",
                        "powershell.exe",
                        "wevtutil.exe",
                        "psexec.exe",
                        "bcedit.exe",
                        "wbadmin.exe",
                        "icacls.exe",
                        "diskpart.exe"
                    ]
                },
                "timeframe": "5m"
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "low"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7379778e-3230-4ec1-93ae-565ac5bd1996",
            "created": "2018-12-03T23:30:44.505Z",
            "modified": "2018-12-03T23:30:44.505Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e595f651-5792-44eb-9ca8-09e9014521a8",
            "created": "2018-12-03T23:30:44.506Z",
            "modified": "2018-12-03T23:30:44.506Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1525b1a2-6452-463d-becd-4b84713f267d",
            "created": "2018-12-03T23:30:44.511Z",
            "modified": "2018-12-03T23:30:44.511Z",
            "title": "Malicious Base64 encoded PowerShell Keywords in command lines",
            "status": "experimental",
            "description": "Detects base64 encoded strings used in hidden malicious PowerShell command lines",
            "references": [
                "http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/"
            ],
            "author": "John Lambert (rule)",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "condition": "encoded and selection",
                "encoded": {
                    "EventID": 4688,
                    "CommandLine": "* hidden *",
                    "Image": "*\\powershell.exe"
                },
                "selection": {
                    "EventID": 4688,
                    "CommandLine": [
                        "*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA*",
                        "*aXRzYWRtaW4gL3RyYW5zZmVy*",
                        "*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA*",
                        "*JpdHNhZG1pbiAvdHJhbnNmZX*",
                        "*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg*",
                        "*Yml0c2FkbWluIC90cmFuc2Zlc*",
                        "*AGMAaAB1AG4AawBfAHMAaQB6AGUA*",
                        "*JABjAGgAdQBuAGsAXwBzAGkAegBlA*",
                        "*JGNodW5rX3Npem*",
                        "*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ*",
                        "*RjaHVua19zaXpl*",
                        "*Y2h1bmtfc2l6Z*",
                        "*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A*",
                        "*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg*",
                        "*lPLkNvbXByZXNzaW9u*",
                        "*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA*",
                        "*SU8uQ29tcHJlc3Npb2*",
                        "*Ty5Db21wcmVzc2lvb*",
                        "*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ*",
                        "*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA*",
                        "*lPLk1lbW9yeVN0cmVhb*",
                        "*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A*",
                        "*SU8uTWVtb3J5U3RyZWFt*",
                        "*Ty5NZW1vcnlTdHJlYW*",
                        "*4ARwBlAHQAQwBoAHUAbgBrA*",
                        "*5HZXRDaHVua*",
                        "*AEcAZQB0AEMAaAB1AG4Aaw*",
                        "*LgBHAGUAdABDAGgAdQBuAGsA*",
                        "*LkdldENodW5r*",
                        "*R2V0Q2h1bm*",
                        "*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A*",
                        "*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA*",
                        "*RIUkVBRF9JTkZPNj*",
                        "*SFJFQURfSU5GTzY0*",
                        "*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA*",
                        "*VEhSRUFEX0lORk82N*",
                        "*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA*",
                        "*cmVhdGVSZW1vdGVUaHJlYW*",
                        "*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA*",
                        "*NyZWF0ZVJlbW90ZVRocmVhZ*",
                        "*Q3JlYXRlUmVtb3RlVGhyZWFk*",
                        "*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA*",
                        "*0AZQBtAG0AbwB2AGUA*",
                        "*1lbW1vdm*",
                        "*AGUAbQBtAG8AdgBlA*",
                        "*bQBlAG0AbQBvAHYAZQ*",
                        "*bWVtbW92Z*",
                        "*ZW1tb3Zl*"
                    ]
                }
            },
            "falsepositives": [
                "Penetration tests"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--33e18d29-c07d-499d-b674-7fed48f2cd58",
            "created": "2018-12-03T23:30:44.513Z",
            "modified": "2018-12-03T23:30:44.513Z",
            "action": "global",
            "title": "Sysprep on AppData Folder",
            "status": "experimental",
            "description": "Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)",
            "references": [
                "https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets",
                "https://app.any.run/tasks/61a296bb-81ad-4fee-955f-3b399f4aaf4b"
            ],
            "author": "Florian Roth",
            "date": "2018/06/22",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*\\sysprep.exe *\\AppData\\*",
                        "sysprep.exe *\\AppData\\*"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--2f34691e-817e-4fe9-906c-83bc4eaa0e8c",
            "created": "2018-12-03T23:30:44.514Z",
            "modified": "2018-12-03T23:30:44.514Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ff0eb06d-f72c-43fa-90e2-df6e540adaeb",
            "created": "2018-12-03T23:30:44.514Z",
            "modified": "2018-12-03T23:30:44.514Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7a7cc053-7658-4c42-97fa-b88d683130e7",
            "created": "2018-12-03T23:30:44.516Z",
            "modified": "2018-12-03T23:30:44.516Z",
            "action": "global",
            "title": "Possible Applocker Bypass",
            "status": "experimental",
            "description": "Detects execution of executables that can be used to bypass Applocker whitelisting",
            "references": [
                "https://github.com/subTee/ApplicationWhitelistBypassTechniques/blob/master/TheList.txt",
                "https://room362.com/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/"
            ],
            "author": "juju4",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*\\msdt.exe*",
                        "*\\installutil.exe*",
                        "*\\regsvcs.exe*",
                        "*\\regasm.exe*",
                        "*\\regsvr32.exe*",
                        "*\\msbuild.exe*",
                        "*\\ieexec.exe*",
                        "*\\mshta.exe*"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "low",
            "tags": [
                "attack.defense_evasion"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--364b9acb-ec48-484a-9805-b7506d62b362",
            "created": "2018-12-03T23:30:44.517Z",
            "modified": "2018-12-03T23:30:44.517Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--cb6e9826-3531-4946-a081-0373bc807d90",
            "created": "2018-12-03T23:30:44.518Z",
            "modified": "2018-12-03T23:30:44.518Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e8293391-646b-4bc3-bb44-a6fdbb032b44",
            "created": "2018-12-03T23:30:44.520Z",
            "modified": "2018-12-03T23:30:44.520Z",
            "title": "Relevant Anti-Virus Event",
            "description": "This detection method points out highly relevant Antivirus events",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "detection": {
                "condition": "keywords and not 1 of filters",
                "filters": [
                    "Keygen",
                    "Crack"
                ],
                "keywords": [
                    "HTool",
                    "Hacktool",
                    "ASP/Backdoor",
                    "JSP/Backdoor",
                    "PHP/Backdoor",
                    "Backdoor.ASP",
                    "Backdoor.JSP",
                    "Backdoor.PHP",
                    "Webshell",
                    "Portscan",
                    "Mimikatz",
                    "WinCred",
                    "PlugX",
                    "Korplug",
                    "Pwdump",
                    "Chopper",
                    "WmiExec",
                    "Xscan",
                    "Clearlog",
                    "ASPXSpy"
                ]
            },
            "falsepositives": [
                "Some software piracy tools (key generators, cracks) are classified as hack tools"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1f8783ae-e04f-41f0-a8d9-d229767ce88e",
            "created": "2018-12-03T23:30:44.522Z",
            "modified": "2018-12-03T23:30:44.522Z",
            "action": "global",
            "title": "Suspicious Encoded PowerShell Command Line",
            "status": "experimental",
            "description": "Detects suspicious powershell process starts with base64 encoded commands",
            "references": [
                "https://app.any.run/tasks/6217d77d-3189-4db2-a957-8ab239f3e01e"
            ],
            "author": "Florian Roth",
            "date": "2018/09/03",
            "detection": {
                "condition": "selection and not 1 of falsepositive*",
                "falsepositive1": {
                    "ImagePath": "*\\GRR\\*"
                },
                "falsepositive2": {
                    "CommandLine": "* -ExecutionPolicy remotesigned *"
                },
                "selection": {
                    "CommandLine": [
                        "* -e JAB*",
                        "* -enc JAB*",
                        "* -encodedcommand JAB*"
                    ]
                }
            },
            "falsepositives": [
                "GRR powershell hacks",
                "PowerSponse Deployments"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--09dd8f82-e788-4174-bbef-4ba609425544",
            "created": "2018-12-03T23:30:44.523Z",
            "modified": "2018-12-03T23:30:44.523Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--10213a10-6d58-4bac-a2bb-69700ae6b2de",
            "created": "2018-12-03T23:30:44.524Z",
            "modified": "2018-12-03T23:30:44.524Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6208fde9-5867-47a1-8835-49673b202ac3",
            "created": "2018-12-03T23:30:44.526Z",
            "modified": "2018-12-03T23:30:44.526Z",
            "title": "Account Tampering - Suspicious Failed Logon Reasons",
            "description": "This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4625,
                        4776
                    ],
                    "Status": [
                        "0xC0000072",
                        "0xC000006F",
                        "0xC0000070",
                        "0xC0000413",
                        "0xC000018C"
                    ]
                }
            },
            "falsepositives": [
                "User using a disabled account"
            ],
            "level": "high",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1078"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--01081c75-e636-4357-9d41-0d88b590350f",
            "created": "2018-12-03T23:30:44.527Z",
            "modified": "2018-12-03T23:30:44.527Z",
            "action": "global",
            "title": "Suspicious Process Start Locations",
            "status": "experimental",
            "description": "Detects suspicious process run from unusual locations",
            "references": [
                "https://car.mitre.org/wiki/CAR-2013-05-002"
            ],
            "author": "juju4",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*:\\RECYCLER\\*",
                        "*:\\SystemVolumeInformation\\*",
                        "%windir%\\Tasks\\*",
                        "%systemroot%\\debug\\*"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--53d8b187-7775-4071-a501-65de3ce879d4",
            "created": "2018-12-03T23:30:44.528Z",
            "modified": "2018-12-03T23:30:44.528Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--24bacb1d-459e-4a76-8e7a-0fe88d22c939",
            "created": "2018-12-03T23:30:44.529Z",
            "modified": "2018-12-03T23:30:44.529Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ccbb7ae4-75e3-4696-abe6-fa6a82638911",
            "created": "2018-12-03T23:30:44.531Z",
            "modified": "2018-12-03T23:30:44.531Z",
            "title": "USB Device Plugged",
            "status": "experimental",
            "description": "Detects plugged USB devices",
            "references": [
                "https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/",
                "https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "driver-framework"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        2003,
                        2100,
                        2102
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "level": "low"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--24622874-1654-4919-89d9-dadf1a5a4ee4",
            "created": "2018-12-03T23:30:44.534Z",
            "modified": "2018-12-03T23:30:44.534Z",
            "action": "global",
            "title": "Reconnaissance Activity with Net Command",
            "status": "experimental",
            "description": "Detects a set of commands often used in recon stages by different attack groups",
            "references": [
                "https://twitter.com/haroonmeer/status/939099379834658817",
                "https://twitter.com/c_APT_ure/status/939475433711722497",
                "https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html"
            ],
            "author": "Florian Roth, Markus Neis",
            "date": "2018/08/22",
            "detection": {
                "condition": "selection | count() > 4",
                "selection": {
                    "CommandLine": [
                        "tasklist",
                        "net time",
                        "systeminfo",
                        "whoami",
                        "nbtstat",
                        "net start",
                        "*\\net1 start",
                        "qprocess",
                        "nslookup",
                        "hostname.exe",
                        "*\\net1 user /domain",
                        "*\\net1 group /domain",
                        "*\\net1 group \"domain admins\" /domain",
                        "*\\net1 group \"Exchange Trusted Subsystem\" /domain",
                        "*\\net1 accounts /domain",
                        "*\\net1 user net localgroup administrators",
                        "netstat -an"
                    ]
                },
                "timeframe": "15s"
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "medium",
            "tags": [
                "attack.discovery",
                "attack.t1073",
                "attack.t1012"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--2fec9669-1c76-4806-ba7c-6b300fa92c7a",
            "created": "2018-12-03T23:30:44.535Z",
            "modified": "2018-12-03T23:30:44.535Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--60ee5e24-7be3-427a-b8a9-2a7ebd5e2fbf",
            "created": "2018-12-03T23:30:44.535Z",
            "modified": "2018-12-03T23:30:44.535Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0cbf5b1d-1094-441d-8d8a-f26381a034f3",
            "created": "2018-12-03T23:30:44.538Z",
            "modified": "2018-12-03T23:30:44.538Z",
            "title": "Kerberos Manipulation",
            "description": "This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        675,
                        4768,
                        4769,
                        4771
                    ],
                    "FailureCode": [
                        "0x9",
                        "0xA",
                        "0xB",
                        "0xF",
                        "0x10",
                        "0x11",
                        "0x13",
                        "0x14",
                        "0x1A",
                        "0x1F",
                        "0x21",
                        "0x22",
                        "0x23",
                        "0x24",
                        "0x26",
                        "0x27",
                        "0x28",
                        "0x29",
                        "0x2C",
                        "0x2D",
                        "0x2E",
                        "0x2F",
                        "0x31",
                        "0x32",
                        "0x3E",
                        "0x3F",
                        "0x40",
                        "0x41",
                        "0x43",
                        "0x44"
                    ]
                }
            },
            "falsepositives": [
                "Faulty legacy applications"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1212"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--2e76ed83-6312-47b7-abb8-0382b6ba7585",
            "created": "2018-12-03T23:30:44.540Z",
            "modified": "2018-12-03T23:30:44.540Z",
            "action": "global",
            "title": "Suspicious RASdial Activity",
            "status": "experimental",
            "description": "Detects suspicious process related to rasdial.exe",
            "references": [
                "https://twitter.com/subTee/status/891298217907830785"
            ],
            "author": "juju4",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "rasdial"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f9c3b5ac-481c-4b72-bc85-69cef43ce902",
            "created": "2018-12-03T23:30:44.541Z",
            "modified": "2018-12-03T23:30:44.541Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--848a65cc-cebd-4cc8-9ef6-fa63801b5223",
            "created": "2018-12-03T23:30:44.541Z",
            "modified": "2018-12-03T23:30:44.541Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b5e15ec9-1b35-46ef-a9f4-76c2e70739ec",
            "created": "2018-12-03T23:30:44.543Z",
            "modified": "2018-12-03T23:30:44.543Z",
            "title": "Malicious Service Install",
            "description": "This method detects well-known keywords of malicious services in the Windows System Eventlog",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "( selection and keywords ) or quarkspwdump",
                "keywords": [
                    "WCE SERVICE",
                    "WCESERVICE",
                    "DumpSvc"
                ],
                "quarkspwdump": {
                    "EventID": 16,
                    "HiveName": "*\\AppData\\Local\\Temp\\SAM*.dmp"
                },
                "selection": {
                    "EventID": [
                        7045,
                        4697
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.s0005"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1ccfe55b-40ef-4854-a71b-a9d327f02b34",
            "created": "2018-12-03T23:30:44.545Z",
            "modified": "2018-12-03T23:30:44.545Z",
            "title": "Rare Service Installs",
            "status": "experimental",
            "description": "Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection | count(ServiceFileName) < 5",
                "selection": {
                    "EventID": 7045
                },
                "timeframe": "7d"
            },
            "falsepositives": [
                "Software installation",
                "Software updates"
            ],
            "level": "low",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1050"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c6862300-7a34-4635-b642-8d23a2c2d2fa",
            "created": "2018-12-03T23:30:44.547Z",
            "modified": "2018-12-03T23:30:44.547Z",
            "title": "smbexec.py Service Installation",
            "description": "Detects the use of smbexec.py tool by detecting a specific service installation",
            "references": [
                "https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/"
            ],
            "author": "Omer Faruk Celik",
            "date": "2018/03/20",
            "logsource": {
                "product": "windows"
            },
            "detection": {
                "condition": "service_installation",
                "service_installation": {
                    "EventID": 7045,
                    "ServiceFileName": "*\\execute.bat",
                    "ServiceName": "BTOBTO"
                }
            },
            "fields": [
                "ServiceName",
                "ServiceFileName"
            ],
            "falsepositives": [
                "Penetration Test",
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.lateral_movement",
                "attack.execution",
                "attack.t1077",
                "attack.t1035"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3788d115-cd38-4593-96ad-29d2b315003c",
            "created": "2018-12-03T23:30:44.550Z",
            "modified": "2018-12-03T23:30:44.550Z",
            "title": "Weak Encryption Enabled and Kerberoast",
            "description": "Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.",
            "references": [
                "https://adsecurity.org/?p=2053",
                "https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/"
            ],
            "author": "@neu5ron",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management",
                "service": "security"
            },
            "detection": {
                "condition": "selection and keywords and filters",
                "filters": [
                    "Enabled"
                ],
                "keywords": [
                    "DES",
                    "Preauth",
                    "Encrypted"
                ],
                "selection": {
                    "EventID": 4738
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--abec3709-a6ac-4060-97bb-2852af685eee",
            "created": "2018-12-03T23:30:44.551Z",
            "modified": "2018-12-03T23:30:44.551Z",
            "action": "global",
            "title": "Suspicious Svchost Processes",
            "status": "experimental",
            "description": "Detects suspicious svchost processes with parent process that is not services.exe, command line missing -k parameter or running outside Windows folder",
            "references": [
                "https://twitter.com/Moti_B/status/1002280132143394816",
                "https://twitter.com/Moti_B/status/1002280287840153601"
            ],
            "author": "Florian Roth, @c_APT_ure",
            "date": "2018/10/26",
            "falsepositives": [
                "Renamed %SystemRoot%s"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a33b9b6f-24f7-4248-a321-ef17ecbdff80",
            "created": "2018-12-03T23:30:44.552Z",
            "modified": "2018-12-03T23:30:44.552Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not ( filter1 or filter2 or filter3 )",
                "filter1": {
                    "ParentImage": [
                        "*\\services.exe",
                        "*\\MsMpEng.exe"
                    ]
                },
                "filter2": {
                    "CommandLine": "* -k *"
                },
                "filter3": {
                    "Image": "C:\\Windows\\S*"
                },
                "selection": {
                    "EventID": 1,
                    "Image": "*\\svchost.exe"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--53634949-b960-4930-91ef-821ad1429079",
            "created": "2018-12-03T23:30:44.554Z",
            "modified": "2018-12-03T23:30:44.554Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "condition": "selection and not filter3",
                "filter3": {
                    "NewProcessName": "C:\\Windows\\S*"
                },
                "selection": {
                    "EventID": 4688,
                    "NewProcessName": "*\\svchost.exe"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f65708d2-ea4c-4c87-902a-55c864eb79e1",
            "created": "2018-12-03T23:30:44.556Z",
            "modified": "2018-12-03T23:30:44.556Z",
            "title": "Password Dumper Activity on LSASS",
            "status": "experimental",
            "description": "Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN",
            "references": [
                "https://twitter.com/jackcr/status/807385668833968128"
            ],
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "AccessMask": "0x705",
                    "EventID": 4656,
                    "ObjectType": "SAM_DOMAIN",
                    "ProcessName": "C:\\Windows\\System32\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unkown"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c070a7a1-c769-490e-a8b3-800b89933a61",
            "created": "2018-12-03T23:30:44.558Z",
            "modified": "2018-12-03T23:30:44.558Z",
            "action": "global",
            "title": "Suspicious Commandline Escape",
            "status": "experimental",
            "description": "Detects suspicious process that use escape characters",
            "references": [
                "https://twitter.com/vysecurity/status/885545634958385153",
                "https://twitter.com/Hexacorn/status/885553465417756673",
                "https://twitter.com/Hexacorn/status/885570278637678592",
                "https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html",
                "http://www.windowsinspired.com/understanding-the-command-line-string-and-arguments-received-by-a-windows-program/"
            ],
            "author": "juju4",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "<TAB>",
                        "^h^t^t^p",
                        "h\"t\"t\"p"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "low",
            "tags": [
                "attack.defense_evasion",
                "attack.t1140"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--814a9ea8-0f88-46f4-8e4a-ef5751fa41e5",
            "created": "2018-12-03T23:30:44.559Z",
            "modified": "2018-12-03T23:30:44.559Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--90b6dd5f-25e0-4c0f-af33-e34a54d6fb15",
            "created": "2018-12-03T23:30:44.559Z",
            "modified": "2018-12-03T23:30:44.559Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--fb14daad-96ca-4fb9-bbda-8d3d93f2dd78",
            "created": "2018-12-03T23:30:44.561Z",
            "modified": "2018-12-03T23:30:44.561Z",
            "title": "DHCP Server Loaded the CallOut DLL",
            "status": "experimental",
            "description": "This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded",
            "references": [
                "https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html",
                "https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx",
                "https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx"
            ],
            "author": "Dimitrios Slamaris",
            "date": "2017/05/15",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1033
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.defense_evasion"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ebd06c57-db0c-4fe2-a9a0-5aa4ffd3c179",
            "created": "2018-12-03T23:30:44.563Z",
            "modified": "2018-12-03T23:30:44.563Z",
            "action": "global",
            "title": "Whoami Execution",
            "status": "experimental",
            "description": "Detects the execution of whoami, which is often used by attackers after exloitation / privilege escalation but rarely used by administrators",
            "references": [
                "https://twitter.com/haroonmeer/status/939099379834658817",
                "https://twitter.com/c_APT_ure/status/939475433711722497"
            ],
            "author": "Florian Roth",
            "date": "2018/05/22",
            "detection": {
                "condition": "selection"
            },
            "falsepositives": [
                "Admin activity",
                "Scripts and administrative tools used in the monitored environment"
            ],
            "level": "high",
            "tags": [
                "attack.discovery",
                "attack.t1033"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f4b0bdcd-fa21-4d7d-852d-76c15e1891b7",
            "created": "2018-12-03T23:30:44.564Z",
            "modified": "2018-12-03T23:30:44.564Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "CommandLine": "whoami",
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--49552c8e-dc2a-41c7-b7a4-37b7055ad101",
            "created": "2018-12-03T23:30:44.565Z",
            "modified": "2018-12-03T23:30:44.565Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688,
                    "NewProcessName": "*\\whoami.exe"
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3030f4de-1468-463c-a71d-c4634040d5bd",
            "created": "2018-12-03T23:30:44.566Z",
            "modified": "2018-12-03T23:30:44.566Z",
            "action": "global",
            "title": "IIS Native-Code Module Command Line Installation",
            "status": "experimental",
            "description": "Detects suspicious IIS native-code module installations via command line",
            "references": [
                "https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/"
            ],
            "author": "Florian Roth",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*\\APPCMD.EXE install module /name:*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown as it may vary from organisation to arganisation how admins use to install IIS modules"
            ],
            "level": "medium",
            "tags": [
                "attack.persistence",
                "attack.t1100"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--01748b54-d419-46ac-9931-23035d737828",
            "created": "2018-12-03T23:30:44.567Z",
            "modified": "2018-12-03T23:30:44.567Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a3b934be-b4b7-4094-8f53-083ec7f151b9",
            "created": "2018-12-03T23:30:44.568Z",
            "modified": "2018-12-03T23:30:44.568Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--fb5f94cc-40a1-47af-9a50-62b5178d2b96",
            "created": "2018-12-03T23:30:44.570Z",
            "modified": "2018-12-03T23:30:44.570Z",
            "action": "global",
            "title": "Suspicious Use of Procdump",
            "status": "experimental",
            "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.",
            "references": [
                "Internal Research"
            ],
            "author": "Florian Roth",
            "date": "2018/10/30",
            "detection": {
                "condition": "selection and selection1 and selection2"
            },
            "falsepositives": [
                "Unlikely, because no one should dump an lsass process memory",
                "Another tool that uses the command line switches of Procdump"
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1260eb52-41a5-4c98-989f-42497a7e70b2",
            "created": "2018-12-03T23:30:44.571Z",
            "modified": "2018-12-03T23:30:44.571Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                },
                "selection1": {
                    "ProcessCommandLine": [
                        "* -ma *"
                    ]
                },
                "selection2": {
                    "ProcessCommandLine": [
                        "* lsass.exe*"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--055f331e-0fc8-44d5-a084-99a0789adcc0",
            "created": "2018-12-03T23:30:44.572Z",
            "modified": "2018-12-03T23:30:44.572Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                },
                "selection1": {
                    "CommandLine": [
                        "* -ma *"
                    ]
                },
                "selection2": {
                    "CommandLine": [
                        "* lsass.exe*"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--dc3b46be-df16-47b0-b94a-93e5c1184028",
            "created": "2018-12-03T23:30:44.574Z",
            "modified": "2018-12-03T23:30:44.574Z",
            "title": "Password Change on Directory Service Restore Mode (DSRM) Account",
            "status": "stable",
            "description": "The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.",
            "references": [
                "https://adsecurity.org/?p=1714"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4794
                }
            },
            "falsepositives": [
                "Initial installation of a domain controller"
            ],
            "level": "high",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1d4980f2-c5af-4a63-8b21-7d05e535f2a4",
            "created": "2018-12-03T23:30:44.577Z",
            "modified": "2018-12-03T23:30:44.577Z",
            "title": "Reconnaissance Activity",
            "status": "experimental",
            "description": "Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"",
            "references": [
                "https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html"
            ],
            "author": "Florian Roth (rule), Jack Croock (method)",
            "logsource": {
                "product": "windows",
                "description": "The volume of Event ID 4661 is high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommandations for server systems",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "AccessMask": "0x2d",
                        "EventID": 4661,
                        "ObjectName": "S-1-5-21-*-500",
                        "ObjectType": "SAM_USER"
                    },
                    {
                        "AccessMask": "0x2d",
                        "EventID": 4661,
                        "ObjectName": "S-1-5-21-*-512",
                        "ObjectType": "SAM_GROUP"
                    }
                ]
            },
            "falsepositives": [
                "Administrator activity",
                "Penetration tests"
            ],
            "level": "high",
            "tags": [
                "attack.discovery",
                "attack.t1087",
                "attack.t1069",
                "attack.s0039"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--879226c9-5106-4345-b334-a7c0f7a125f7",
            "created": "2018-12-03T23:30:44.578Z",
            "modified": "2018-12-03T23:30:44.578Z",
            "action": "global",
            "title": "Suspicious SYSVOL Domain Group Policy Access",
            "status": "experimental",
            "description": "Detects Access to Domain Group Policies stored in SYSVOL",
            "references": [
                "https://adsecurity.org/?p=2288",
                "https://www.hybrid-analysis.com/sample/f2943f5e45befa52fb12748ca7171d30096e1d4fc3c365561497c618341299d5?environmentId=100"
            ],
            "author": "Markus Neis",
            "date": "2018/04/09",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": "*\\SYSVOL\\*\\policies\\*"
                }
            },
            "falsepositives": [
                "administrative activity"
            ],
            "level": "medium",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--773a74a9-9c17-47ea-8480-06a08aa0e0dd",
            "created": "2018-12-03T23:30:44.579Z",
            "modified": "2018-12-03T23:30:44.579Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f7fd07e9-16eb-4c8a-8197-06af8a8810db",
            "created": "2018-12-03T23:30:44.580Z",
            "modified": "2018-12-03T23:30:44.580Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--269c7204-39d7-454f-9990-782ad67e7d6a",
            "created": "2018-12-03T23:30:44.583Z",
            "modified": "2018-12-03T23:30:44.583Z",
            "title": "Multiple Failed Logins with Different Accounts from Single Source System",
            "description": "Detects suspicious failed logins with different user accounts from a single source system",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": [
                    "selection1 | count(UserName) by WorkstationName > 3",
                    "selection2 | count(UserName) by Workstation > 3"
                ],
                "selection1": {
                    "EventID": [
                        529,
                        4625
                    ],
                    "UserName": "*",
                    "WorkstationName": "*"
                },
                "selection2": {
                    "EventID": 4776,
                    "UserName": "*",
                    "Workstation": "*"
                },
                "timeframe": "24h"
            },
            "falsepositives": [
                "Terminal servers",
                "Jump servers",
                "Other multiuser systems like Citrix server farms",
                "Workstations with frequently changing users"
            ],
            "level": "medium",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1078"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--46fa1750-3e9f-47af-ad52-02e37a1c80a2",
            "created": "2018-12-03T23:30:44.585Z",
            "modified": "2018-12-03T23:30:44.585Z",
            "title": "Interactive Logon to Server Systems",
            "description": "Detects interactive console logons to",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "ComputerName": "%Workstations%",
                    "LogonProcessName": "Advapi"
                },
                "selection": {
                    "ComputerName": [
                        "%ServerSystems%",
                        "%DomainControllers%"
                    ],
                    "EventID": [
                        528,
                        529,
                        4624,
                        4625
                    ],
                    "LogonType": 2
                }
            },
            "falsepositives": [
                "Administrative activity via KVM or ILO board"
            ],
            "level": "medium",
            "tags": [
                "attack.lateral_movement",
                "attack.t1078"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1ef06158-314e-499b-b093-a46309d68ccd",
            "created": "2018-12-03T23:30:44.587Z",
            "modified": "2018-12-03T23:30:44.587Z",
            "title": "Mimikatz Use",
            "description": "This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "mimikatz",
                    "mimilib",
                    "<3 eo.oe",
                    "eo.oe.kiwi",
                    "privilege::debug",
                    "sekurlsa::logonpasswords",
                    "lsadump::sam",
                    "mimidrv.sys"
                ]
            },
            "falsepositives": [
                "Naughty administrators",
                "Penetration test"
            ],
            "level": "critical",
            "tags": [
                "attack.s0002",
                "attack.t1003",
                "attack.lateral_movement",
                "attack.credential_access"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--cc7371af-e82b-495e-8392-63144c4c5869",
            "created": "2018-12-03T23:30:44.589Z",
            "modified": "2018-12-03T23:30:44.589Z",
            "action": "global",
            "title": "Suspicious Rundll32 Activity",
            "status": "experimental",
            "description": "Detects suspicious process related to rundll32 based on arguments",
            "references": [
                "http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/",
                "https://twitter.com/Hexacorn/status/885258886428725250",
                "https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52"
            ],
            "author": "juju4",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*\\rundll32.exe* url.dll,*OpenURL *",
                        "*\\rundll32.exe* url.dll,*OpenURLA *",
                        "*\\rundll32.exe* url.dll,*FileProtocolHandler *",
                        "*\\rundll32.exe* zipfldr.dll,*RouteTheCall *",
                        "*\\rundll32.exe* Shell32.dll,*Control_RunDLL *",
                        "*\\rundll32.exe javascript:*",
                        "* url.dll,*OpenURL *",
                        "* url.dll,*OpenURLA *",
                        "* url.dll,*FileProtocolHandler *",
                        "* zipfldr.dll,*RouteTheCall *",
                        "* Shell32.dll,*Control_RunDLL *",
                        "* javascript:*",
                        "*.RegisterXLL*"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1085"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--50d95bc6-dd6c-47bc-98e0-a80551fdb158",
            "created": "2018-12-03T23:30:44.590Z",
            "modified": "2018-12-03T23:30:44.590Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9ff1ad00-e5da-4bc7-a8cb-75bc712ce4f6",
            "created": "2018-12-03T23:30:44.591Z",
            "modified": "2018-12-03T23:30:44.591Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            },
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--babab5fe-4288-493d-890a-89ee98ef71b0",
            "created": "2018-12-03T23:30:44.593Z",
            "modified": "2018-12-03T23:30:44.593Z",
            "title": "Enabled User Right in AD to Control User Objects",
            "description": "Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.",
            "references": [
                "https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/"
            ],
            "author": "@neu5ron",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change",
                "service": "security"
            },
            "detection": {
                "condition": "all of them",
                "keywords": [
                    "SeEnableDelegationPrivilege"
                ],
                "selection": {
                    "EventID": 4704
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.privilege_escalation",
                "attack.t1078"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6edf01f3-d5dd-4ffb-8c9f-7204267fd785",
            "created": "2018-12-03T23:30:44.595Z",
            "modified": "2018-12-03T23:30:44.595Z",
            "title": "Admin User Remote Logon",
            "status": "experimental",
            "description": "Detect remote login by Administrator user depending on internal pattern",
            "references": [
                "https://car.mitre.org/wiki/CAR-2016-04-005"
            ],
            "author": "juju4",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Identifiable administrators usernames (pattern or special unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary account",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "AccountName": "Admin-*",
                    "AuthenticationPackageName": "Negotiate",
                    "EventID": 4624,
                    "LogonType": 10
                }
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "level": "low",
            "tags": [
                "attack.lateral_movement",
                "attack.t1078"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7ec23451-8d87-49b1-a290-06461575523c",
            "created": "2018-12-03T23:30:44.597Z",
            "modified": "2018-12-03T23:30:44.597Z",
            "title": "SAM Dump to AppData",
            "status": "experimental",
            "description": "Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "description": "The source of this type of event is Kernel-General",
                "service": "system"
            },
            "detection": {
                "condition": "all of them",
                "keywords": [
                    "*\\AppData\\Local\\Temp\\SAM-*.dmp *"
                ],
                "selection": {
                    "EventID": 16
                }
            },
            "falsepositives": [
                "Penetration testing"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c6cad88c-8aaf-469b-ac2c-ecb7889e74bd",
            "created": "2018-12-03T23:30:44.599Z",
            "modified": "2018-12-03T23:30:44.599Z",
            "title": "Disabling Windows Event Auditing",
            "description": "Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass local logging to evade detection when windows event logging is enabled and reviewed. Also, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\". Please note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways.\n",
            "references": [
                "https://bit.ly/WinLogsZero2Hero"
            ],
            "author": "@neu5ron",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Computer Management > Audit Policy Configuration, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Audit Policy Change",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "AuditPolicyChanges": "removed",
                    "EventID": 4719
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.t1054"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--49168bf3-e051-41df-8752-728a83f8c796",
            "created": "2018-12-03T23:30:44.601Z",
            "modified": "2018-12-03T23:30:44.601Z",
            "action": "global",
            "title": "NetNTLM Downgrade Attack",
            "description": "Detects post exploitation using NetNTLM downgrade attacks",
            "reference": [
                "https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks"
            ],
            "author": "Florian Roth",
            "date": "2018/03/20",
            "detection": {
                "condition": "1 of them"
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.credential_access",
                "attack.t1212"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a0b163b7-4add-4e9d-93d0-b27e3e52d497",
            "created": "2018-12-03T23:30:44.602Z",
            "modified": "2018-12-03T23:30:44.602Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection1": {
                    "EventID": 13,
                    "TargetObject": [
                        "*SYSTEM\\*ControlSet*\\Control\\Lsa\\lmcompatibilitylevel",
                        "*SYSTEM\\*ControlSet*\\Control\\Lsa\\NtlmMinClientSec",
                        "*SYSTEM\\*ControlSet*\\Control\\Lsa\\RestrictSendingNTLMTraffic"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--5935f1e8-c2ab-4d22-bae2-fcded8f83e34",
            "created": "2018-12-03T23:30:44.603Z",
            "modified": "2018-12-03T23:30:44.603Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Object Access > Audit Registry (Success)",
                "service": "security"
            },
            "detection": {
                "selection2": {
                    "EventID": 4657,
                    "ObjectName": "\\REGISTRY\\MACHINE\\SYSTEM\\*ControlSet*\\Control\\Lsa",
                    "ObjectValueName": [
                        "LmCompatibilityLevel",
                        "NtlmMinClientSec",
                        "RestrictSendingNTLMTraffic"
                    ]
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b4ec96cb-4f8c-4574-8a90-ea3a61971625",
            "created": "2018-12-03T23:30:44.605Z",
            "modified": "2018-12-03T23:30:44.605Z",
            "title": "Backup Catalog Deleted",
            "status": "experimental",
            "description": "Detects backup catalog deletions",
            "references": [
                "https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx",
                "https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100"
            ],
            "author": "Florian Roth (rule), Tom U. @c_APT_ure (collection)",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 524,
                    "Source": "Backup"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.t1107"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9522e39a-7fdf-4e4b-9867-203c6830b442",
            "created": "2018-12-03T23:30:44.606Z",
            "modified": "2018-12-03T23:30:44.606Z",
            "action": "global",
            "title": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)",
            "status": "experimental",
            "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/ntdsutil.htm"
            ],
            "author": "Thomas Patzke",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": "*\\ntdsutil.exe *"
                }
            },
            "falsepositives": [
                "NTDS maintenance"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8d7551d2-1539-40fc-942c-6f4ba0c2f264",
            "created": "2018-12-03T23:30:44.607Z",
            "modified": "2018-12-03T23:30:44.607Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--316d1b2f-a7f5-4810-85ab-c1857d5a7fd8",
            "created": "2018-12-03T23:30:44.608Z",
            "modified": "2018-12-03T23:30:44.608Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--dbe5580b-0f62-4c54-8062-f376cb8ebb9e",
            "created": "2018-12-03T23:30:44.610Z",
            "modified": "2018-12-03T23:30:44.610Z",
            "title": "Successful Overpass the Hash Attempt",
            "status": "experimental",
            "description": "Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.",
            "references": [
                "https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html"
            ],
            "author": "Roberto Rodriguez (source), Dominik Schaudel (rule)",
            "date": "2018/02/12",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "AuthenticationPackageName": "Negotiate",
                    "EventID": 4624,
                    "LogonProcessName": "seclogo",
                    "LogonType": 9
                }
            },
            "falsepositives": [
                "Runas command-line tool using /netonly parameter"
            ],
            "level": "high",
            "tags": [
                "attack.lateral_movement",
                "attack.t1075",
                "attack.s0002"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--838132f8-3ace-4fd1-9e30-009918fdbd10",
            "created": "2018-12-03T23:30:44.612Z",
            "modified": "2018-12-03T23:30:44.612Z",
            "title": "Suspicious Kerberos RC4 Ticket Encryption",
            "status": "experimental",
            "description": "Detects service ticket requests using RC4 encryption type",
            "references": [
                "https://adsecurity.org/?p=3458",
                "https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity"
            ],
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection and not reduction",
                "reduction": [
                    {
                        "ServiceName": "$*"
                    }
                ],
                "selection": {
                    "EventID": 4769,
                    "TicketEncryptionType": "0x17",
                    "TicketOptions": "0x40810000"
                }
            },
            "falsepositives": [
                "Service accounts used on legacy systems (e.g. NetApp)",
                "Windows Domains with DFL 2003 and legacy systems"
            ],
            "level": "medium",
            "tags": [
                "attack.credential_access",
                "attack.t1208"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6045a14f-da6c-4734-9c45-7349703a18e3",
            "created": "2018-12-03T23:30:44.614Z",
            "modified": "2018-12-03T23:30:44.614Z",
            "title": "PsExec Service Start",
            "description": "Detects a PsExec service start",
            "author": "Florian Roth",
            "date": "2018/03/13",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "condition": "1 of them",
                "selection": {
                    "EventID": 4688,
                    "CommandLine": "C:\\Windows\\PSEXESVC.exe"
                }
            },
            "falsepositives": [
                "Administrative activity"
            ],
            "level": "low",
            "tags": [
                "attack.execution",
                "attack.t1035",
                "attack.s0029"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--5558f363-da91-4581-8e64-c4c3761afa58",
            "created": "2018-12-03T23:30:44.617Z",
            "modified": "2018-12-03T23:30:44.617Z",
            "title": "Pass the Hash Activity",
            "status": "experimental",
            "description": "Detects the attack technique pass the hash which is used to move laterally inside the network",
            "references": [
                "https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events"
            ],
            "author": "Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)",
            "logsource": {
                "product": "windows",
                "description": "The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625",
                "service": "security"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "AccountName": "ANONYMOUS LOGON"
                },
                "selection": [
                    {
                        "ComputerName": "%Workstations%",
                        "EventID": 4624,
                        "LogonProcessName": "NtLmSsp",
                        "LogonType": "3",
                        "WorkstationName": "%Workstations%"
                    },
                    {
                        "ComputerName": "%Workstations%",
                        "EventID": 4625,
                        "LogonProcessName": "NtLmSsp",
                        "LogonType": "3",
                        "WorkstationName": "%Workstations%"
                    }
                ]
            },
            "falsepositives": [
                "Administrator activity",
                "Penetration tests"
            ],
            "level": "medium",
            "tags": [
                "attack.lateral_movement",
                "attack.t1075"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ad77c4c5-da60-4ebe-b033-ac492c083a95",
            "created": "2018-12-03T23:30:44.619Z",
            "modified": "2018-12-03T23:30:44.619Z",
            "title": "WCE wceaux.dll Access",
            "status": "experimental",
            "description": "Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host",
            "references": [
                "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
                "https://jpcertcc.github.io/ToolAnalysisResultSheet"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4656,
                        4658,
                        4660,
                        4663
                    ],
                    "ObjectName": "*\\wceaux.dll"
                }
            },
            "falsepositives": [
                "Penetration testing"
            ],
            "level": "critical",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.s0005"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--af530cb5-092c-4d46-b307-82502df5ca4d",
            "created": "2018-12-03T23:30:44.621Z",
            "modified": "2018-12-03T23:30:44.621Z",
            "title": "Mimikatz DC Sync",
            "status": "experimental",
            "description": "Detects Mimikatz DC sync security events",
            "references": [
                "https://twitter.com/gentilkiwi/status/1003236624925413376",
                "https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2"
            ],
            "author": "Benjamin Delpy, Florian Roth",
            "date": "2018/06/03",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4662,
                    "Properties": [
                        "*Replicating Directory Changes All*",
                        "*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*"
                    ]
                }
            },
            "falsepositives": [
                "Unkown"
            ],
            "level": "critical",
            "tags": [
                "attack.credential_access",
                "attack.s0002",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a5961d1e-66a8-4526-a176-bd41a2635045",
            "created": "2018-12-03T23:30:44.623Z",
            "modified": "2018-12-03T23:30:44.623Z",
            "title": "User Added to Local Administrators",
            "status": "stable",
            "description": "This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "SubjectUserName": "*$"
                },
                "selection": {
                    "EventID": 4732,
                    "GroupName": "Administrators"
                }
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "level": "low",
            "tags": [
                "attack.privilege_escalation"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6af13e1f-a088-4e22-8f7a-97e7c6077e95",
            "created": "2018-12-03T23:30:44.625Z",
            "modified": "2018-12-03T23:30:44.625Z",
            "title": "Addition of SID History to Active Directory Object",
            "status": "stable",
            "description": "An attacker can use the SID history attribute to gain additional privileges.",
            "references": [
                "https://adsecurity.org/?p=1772"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4765,
                        4766
                    ]
                }
            },
            "falsepositives": [
                "Migration of an account into a new domain"
            ],
            "level": "medium",
            "tags": [
                "attack.privilege_escalation",
                "attack.t1178"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1e3909be-3a50-4c40-9750-c27bef9d0f4c",
            "created": "2018-12-03T23:30:44.628Z",
            "modified": "2018-12-03T23:30:44.628Z",
            "title": "Active Directory User Backdoors",
            "description": "Detects scenarios where one can control another users or computers account without having to use their credentials.",
            "references": [
                "https://msdn.microsoft.com/en-us/library/cc220234.aspx",
                "https://adsecurity.org/?p=3466",
                "https://www.harmj0y.net/blog/redteaming/another-word-on-delegation/"
            ],
            "author": "@neu5ron",
            "logsource": {
                "product": "windows",
                "description1": "Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management",
                "description2": "Requirements: Audit Policy : DS Access > Audit Directory Service Changes, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Changes",
                "service": "security"
            },
            "detection": {
                "condition": "(selection1 and not filter1) or selection2 or selection3 or selection4",
                "filter1": {
                    "AllowedToDelegateTo": null
                },
                "selection1": {
                    "EventID": 4738
                },
                "selection2": {
                    "AttributeLDAPDisplayName": "msDS-AllowedToDelegateTo",
                    "EventID": 5136
                },
                "selection3": {
                    "AttributeLDAPDisplayName": "servicePrincipalName",
                    "EventID": 5136,
                    "ObjectClass": "user"
                },
                "selection4": {
                    "AttributeLDAPDisplayName": "msDS-AllowedToActOnBehalfOfOtherIdentity",
                    "EventID": 5136
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.t1098",
                "attack.credential_access"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d81a8449-78ab-4c98-a54f-87a1cf03b94d",
            "created": "2018-12-03T23:30:44.631Z",
            "modified": "2018-12-03T23:30:44.631Z",
            "title": "Malicious Service Installations",
            "description": "Detects known malicious service installs that only appear in cases of lateral movement, credential dumping and other suspicious activity",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection and 1 of malsvc_*",
                "selection": {
                    "EventID": 7045
                },
                "malsvc_others": {
                    "ServiceName": [
                        "pwdump*",
                        "gsecdump*",
                        "cachedump*"
                    ]
                },
                "malsvc_paexec": {
                    "ServiceFileName": "*\\PAExec*"
                },
                "malsvc_persistence": {
                    "ServiceFileName": "* net user *"
                },
                "malsvc_pwdumpx": {
                    "ServiceFileName": "*\\DumpSvc.exe"
                },
                "malsvc_wannacry": {
                    "ServiceName": "mssecsvc2.0"
                },
                "malsvc_wce": {
                    "ServiceName": [
                        "WCESERVICE",
                        "WCE SERVICE"
                    ]
                },
                "malsvc_winexe": {
                    "ServiceFileName": "winexesvc.exe*"
                }
            },
            "falsepositives": [
                "Penetration testing"
            ],
            "level": "critical",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1050"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--aa160ea3-c808-4c13-b101-957548da4602",
            "created": "2018-12-03T23:30:44.634Z",
            "modified": "2018-12-03T23:30:44.634Z",
            "title": "NTLM Logon",
            "status": "experimental",
            "description": "Detects logons using NTLM, which could be caused by a legacy source or attackers",
            "references": [
                "https://twitter.com/JohnLaTwC/status/1004895028995477505",
                "https://goo.gl/PsqrhT"
            ],
            "author": "Florian Roth",
            "date": "2018/06/08",
            "logsource": {
                "product": "windows",
                "description": "Reqiures events from Microsoft-Windows-NTLM/Operational",
                "service": "ntlm"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CallingProcessName": "*",
                    "EventID": 8002
                }
            },
            "falsepositives": [
                "Legacy hosts"
            ],
            "level": "low",
            "tags": [
                "attack.credential_access",
                "attack.t1208"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--563a5c71-aa7e-4110-ae9d-940851b973ff",
            "created": "2018-12-03T23:30:44.635Z",
            "modified": "2018-12-03T23:30:44.635Z",
            "title": "Eventlog Cleared",
            "description": "One of the Windows Eventlogs has been cleared",
            "references": [
                "https://twitter.com/deviouspolack/status/832535435960209408"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 104
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--43d5dcae-f672-4ca9-83fe-0de0269d45cf",
            "created": "2018-12-03T23:30:44.638Z",
            "modified": "2018-12-03T23:30:44.638Z",
            "title": "LSASS Access Detected via Attack Surface Reduction",
            "status": "experimental",
            "description": "Detects Access to LSASS Process",
            "references": [
                "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?WT.mc_id=twitter"
            ],
            "author": "Markus Neis",
            "date": "2018/08/26",
            "logsource": {
                "description": "Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)",
                "product": "windows_defender"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1121,
                    "Path": "*\\lsass.exe"
                }
            },
            "falsepositives": [
                "Google Chrome GoogleUpdate.exe",
                "Some Taskmgr.exe related activity"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--94735329-2032-4344-8de9-a10d4ae19a27",
            "created": "2018-12-03T23:30:44.639Z",
            "modified": "2018-12-03T23:30:44.639Z",
            "title": "Security Eventlog Cleared",
            "description": "Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        517,
                        1102
                    ]
                }
            },
            "falsepositives": [
                "Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)",
                "System provisioning (system reset before the golden image creation)"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c66cf6d2-efea-4d3b-bc4a-c6513fb3f8fc",
            "created": "2018-12-03T23:30:44.641Z",
            "modified": "2018-12-03T23:30:44.641Z",
            "title": "Possible Remote Password Change Through SAMR",
            "description": "Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). \"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.",
            "author": "Dimitrios Slamaris",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "( passwordchanged and not passwordchanged_filter ) | near samrpipe",
                "passwordchanged": {
                    "EventID": 4738
                },
                "passwordchanged_filter": {
                    "PasswordLastSet": null
                },
                "timeframe": "15s",
                "samrpipe": {
                    "EventID": 5145,
                    "RelativeTargetName": "samr"
                }
            },
            "level": "medium",
            "tags": [
                "attack.credential_access",
                "attack.t1212"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3136d4e3-0f50-4861-bfc4-ad4eb7c0e61c",
            "created": "2018-12-03T23:30:44.646Z",
            "modified": "2018-12-03T23:30:44.646Z",
            "action": "global",
            "title": "Suspicious Process Creation",
            "status": "experimental",
            "description": "Detects suspicious process starts on Windows systems based on keywords",
            "references": [
                "https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/",
                "https://www.youtube.com/watch?v=H3t_kHQG1Js&feature=youtu.be&t=15m35s",
                "https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/",
                "https://twitter.com/subTee/status/872244674609676288",
                "https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/remote-tool-examples",
                "https://tyranidslair.blogspot.ca/2017/07/dg-on-windows-10-s-executing-arbitrary.html",
                "https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/",
                "https://subt0x10.blogspot.ca/2017/04/bypassing-application-whitelisting.html",
                "https://gist.github.com/subTee/7937a8ef07409715f15b84781e180c46#file-rat-bat",
                "https://twitter.com/vector_sec/status/896049052642533376"
            ],
            "author": "Florian Roth",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "vssadmin.exe delete shadows*",
                        "vssadmin delete shadows*",
                        "vssadmin create shadow /for=C:*",
                        "copy \\\\?\\GLOBALROOT\\Device\\*\\windows\\ntds\\ntds.dit*",
                        "copy \\\\?\\GLOBALROOT\\Device\\*\\config\\SAM*",
                        "reg SAVE HKLM\\SYSTEM *",
                        "* sekurlsa:*",
                        "net localgroup adminstrators * /add",
                        "net group \"Domain Admins\" * /ADD /DOMAIN",
                        "certutil.exe *-urlcache* http*",
                        "certutil.exe *-urlcache* ftp*",
                        "netsh advfirewall firewall *\\AppData\\*",
                        "attrib +S +H +R *\\AppData\\*",
                        "schtasks* /create *\\AppData\\*",
                        "schtasks* /sc minute*",
                        "*\\Regasm.exe *\\AppData\\*",
                        "*\\Regasm *\\AppData\\*",
                        "*\\bitsadmin* /transfer*",
                        "*\\certutil.exe * -decode *",
                        "*\\certutil.exe * -decodehex *",
                        "*\\certutil.exe -ping *",
                        "icacls * /grant Everyone:F /T /C /Q",
                        "* wmic shadowcopy delete *",
                        "* wbadmin.exe delete catalog -quiet*",
                        "*\\wscript.exe *.jse",
                        "*\\wscript.exe *.js",
                        "*\\wscript.exe *.vba",
                        "*\\wscript.exe *.vbe",
                        "*\\cscript.exe *.jse",
                        "*\\cscript.exe *.js",
                        "*\\cscript.exe *.vba",
                        "*\\cscript.exe *.vbe",
                        "*\\fodhelper.exe",
                        "*waitfor*/s*",
                        "*waitfor*/si persist*",
                        "*remote*/s*",
                        "*remote*/c*",
                        "*remote*/q*",
                        "*AddInProcess*"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--79de35f9-9c0c-49db-8fc0-9d955ef70af4",
            "created": "2018-12-03T23:30:44.647Z",
            "modified": "2018-12-03T23:30:44.647Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--aafab10a-f55a-4f11-8faf-976d5ed37890",
            "created": "2018-12-03T23:30:44.648Z",
            "modified": "2018-12-03T23:30:44.648Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--36e0a77d-cb18-45f8-8fb0-36c0f8526bac",
            "created": "2018-12-03T23:30:44.650Z",
            "modified": "2018-12-03T23:30:44.650Z",
            "title": "DHCP Server Error Failed Loading the CallOut DLL",
            "status": "experimental",
            "description": "This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded",
            "references": [
                "https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html",
                "https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx",
                "https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx"
            ],
            "author": "Dimitrios Slamaris",
            "date": "2017/05/15",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        1031,
                        1032,
                        1034
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--72c798f1-cf5d-46c2-9ac1-077751ead784",
            "created": "2018-12-03T23:30:44.652Z",
            "modified": "2018-12-03T23:30:44.652Z",
            "title": "Hacktool Use",
            "description": "This method detects well-known keywords, certain field combination that appear in Windows Eventlog when certain hack tools are used",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "selection1",
                "selection1": {
                    "EventID": [
                        4776,
                        4624,
                        4625
                    ],
                    "WorkstationName": "RULER"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.discovery",
                "attack.execution",
                "attack.t1087",
                "attack.t1075",
                "attack.t1114",
                "attack.t1059"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--73ebb8e6-da0c-4f4c-9c61-345db2ba6c77",
            "created": "2018-12-03T23:30:44.654Z",
            "modified": "2018-12-03T23:30:44.654Z",
            "title": "DNS Server Error Failed Loading the ServerLevelPluginDLL",
            "status": "experimental",
            "description": "This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded",
            "references": [
                "https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83",
                "https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx",
                "https://twitter.com/gentilkiwi/status/861641945944391680"
            ],
            "author": "Florian Roth",
            "date": "2017/05/08",
            "logsource": {
                "product": "windows",
                "service": "dns-server"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        150,
                        770
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--90856154-881b-49f0-850b-e8279c8b1a44",
            "created": "2018-12-03T23:30:44.656Z",
            "modified": "2018-12-03T23:30:44.656Z",
            "title": "Eventlog Cleared",
            "status": "experimental",
            "description": "Detects a cleared Windows Eventlog as e.g. caused by \"wevtutil cl\" command execution",
            "references": [
                "https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100"
            ],
            "author": "Florian Roth",
            "date": "2017/06/27",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 104,
                    "Source": "Eventlog"
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--dec99bb0-3a4e-4470-b574-4464a065eccc",
            "created": "2018-12-03T23:30:44.659Z",
            "modified": "2018-12-03T23:30:44.659Z",
            "title": "Rare Schtasks Creations",
            "status": "experimental",
            "description": "Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "description": "The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection (not in the baseline recommendations by Microsoft). We also recommend extracting the Command field from the embedded XML in the event data.",
                "service": "security"
            },
            "detection": {
                "condition": "selection | count(TaskName) < 5",
                "selection": {
                    "EventID": 4698
                },
                "timeframe": "7d"
            },
            "falsepositives": [
                "Software installation",
                "Software updates"
            ],
            "level": "low",
            "tags": [
                "attack.execution",
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.t1053"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--2825d070-b159-44f6-8c1e-a02ae24bda8b",
            "created": "2018-12-03T23:30:44.669Z",
            "modified": "2018-12-03T23:30:44.669Z",
            "title": "Executable used by PlugX in Uncommon Location",
            "status": "experimental",
            "description": "Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location",
            "references": [
                "http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/",
                "https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/"
            ],
            "author": "Florian Roth",
            "date": "2017/06/12",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "detection": {
                "condition": "( selection_cammute and not filter_cammute ) or ( selection_chrome_frame and not filter_chrome_frame ) or ( selection_devemu and not filter_devemu ) or ( selection_gadget and not filter_gadget ) or ( selection_hcc and not filter_hcc ) or ( selection_hkcmd and not filter_hkcmd ) or ( selection_mc and not filter_mc ) or ( selection_msmpeng and not filter_msmpeng ) or ( selection_msseces and not filter_msseces ) or ( selection_oinfo and not filter_oinfo ) or ( selection_oleview and not filter_oleview ) or ( selection_rc and not filter_rc )",
                "filter_cammute": {
                    "EventID": 4688,
                    "CommandLine": "*\\Lenovo\\Communication Utility\\*"
                },
                "filter_chrome_frame": {
                    "EventID": 4688,
                    "CommandLine": "*\\Google\\Chrome\\application\\*"
                },
                "filter_devemu": {
                    "EventID": 4688,
                    "CommandLine": "*\\Microsoft Device Emulator\\*"
                },
                "filter_gadget": {
                    "EventID": 4688,
                    "CommandLine": "*\\Windows Media Player\\*"
                },
                "filter_hcc": {
                    "EventID": 4688,
                    "CommandLine": "*\\HTML Help Workshop\\*"
                },
                "filter_hkcmd": {
                    "EventID": 4688,
                    "CommandLine": [
                        "*\\System32\\*",
                        "*\\SysNative\\*",
                        "*\\SysWowo64\\*"
                    ]
                },
                "filter_mc": {
                    "EventID": 4688,
                    "CommandLine": [
                        "*\\Microsoft Visual Studio*",
                        "*\\Microsoft SDK*",
                        "*\\Windows Kit*"
                    ]
                },
                "filter_msmpeng": {
                    "EventID": 4688,
                    "CommandLine": [
                        "*\\Microsoft Security Client\\*",
                        "*\\Windows Defender\\*",
                        "*\\AntiMalware\\*"
                    ]
                },
                "filter_msseces": {
                    "EventID": 4688,
                    "CommandLine": "*\\Microsoft Security Center\\*"
                },
                "filter_oinfo": {
                    "EventID": 4688,
                    "CommandLine": "*\\Common Files\\Microsoft Shared\\*"
                },
                "filter_oleview": {
                    "EventID": 4688,
                    "CommandLine": [
                        "*\\Microsoft Visual Studio*",
                        "*\\Microsoft SDK*",
                        "*\\Windows Kit*",
                        "*\\Windows Resource Kit\\*"
                    ]
                },
                "filter_rc": {
                    "EventID": 4688,
                    "CommandLine": [
                        "*\\Microsoft Visual Studio*",
                        "*\\Microsoft SDK*",
                        "*\\Windows Kit*",
                        "*\\Windows Resource Kit\\*",
                        "*\\Microsoft.NET\\*"
                    ]
                },
                "selection_cammute": {
                    "EventID": 4688,
                    "CommandLine": "*\\CamMute.exe"
                },
                "selection_chrome_frame": {
                    "EventID": 4688,
                    "CommandLine": "*\\chrome_frame_helper.exe"
                },
                "selection_devemu": {
                    "EventID": 4688,
                    "CommandLine": "*\\dvcemumanager.exe"
                },
                "selection_gadget": {
                    "EventID": 4688,
                    "CommandLine": "*\\Gadget.exe"
                },
                "selection_hcc": {
                    "EventID": 4688,
                    "CommandLine": "*\\hcc.exe"
                },
                "selection_hkcmd": {
                    "EventID": 4688,
                    "CommandLine": "*\\hkcmd.exe"
                },
                "selection_mc": {
                    "EventID": 4688,
                    "CommandLine": "*\\Mc.exe"
                },
                "selection_msmpeng": {
                    "EventID": 4688,
                    "CommandLine": "*\\MsMpEng.exe"
                },
                "selection_msseces": {
                    "EventID": 4688,
                    "CommandLine": "*\\msseces.exe"
                },
                "selection_oinfo": {
                    "EventID": 4688,
                    "CommandLine": "*\\OInfoP11.exe"
                },
                "selection_oleview": {
                    "EventID": 4688,
                    "CommandLine": "*\\OleView.exe"
                },
                "selection_rc": {
                    "EventID": 4688,
                    "CommandLine": "*\\OleView.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.s0013"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--728d1c7a-188f-4dce-811f-d8566161705a",
            "created": "2018-12-03T23:30:44.671Z",
            "modified": "2018-12-03T23:30:44.671Z",
            "title": "Access to ADMIN$ Share",
            "status": "experimental",
            "description": "Detects access to $ADMIN share",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "description": "The advanced audit policy setting \"Object Access > Audit File Share\" must be configured for Success/Failure",
                "service": "security"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "SubjectUserName": "*$"
                },
                "selection": {
                    "EventID": 5140,
                    "ShareName": "Admin$"
                }
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "level": "low",
            "tags": [
                "attack.lateral_movement",
                "attack.t1077"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f928e5bb-b5fc-41aa-a78c-8da92d3febe8",
            "created": "2018-12-03T23:30:44.673Z",
            "modified": "2018-12-03T23:30:44.673Z",
            "title": "Microsoft Malware Protection Engine Crash",
            "status": "experimental",
            "description": "This rule detects a suspicious crash of the Microsoft Malware Protection Engine",
            "references": [
                "https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5",
                "https://technet.microsoft.com/en-us/library/security/4022344"
            ],
            "author": "Florian Roth",
            "date": "2017/05/09",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "detection": {
                "condition": "1 of selection* and all of keywords",
                "keywords": [
                    "MsMpEng.exe",
                    "mpengine.dll"
                ],
                "selection1": {
                    "EventID": 1000,
                    "Source": "Application Error"
                },
                "selection2": {
                    "EventID": 1001,
                    "Source": "Windows Error Reporting"
                }
            },
            "falsepositives": [
                "MsMpEng.exe can crash when C:\\ is full"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.t1089",
                "attack.t1211"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1fcb93e7-a4fc-4dd4-bd6a-4bc503ae89ae",
            "created": "2018-12-03T23:30:44.675Z",
            "modified": "2018-12-03T23:30:44.675Z",
            "title": "Rare Scheduled Task Creations",
            "status": "experimental",
            "description": "This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names.",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "taskscheduler"
            },
            "detection": {
                "condition": "selection | count() by TaskName < 5",
                "selection": {
                    "EventID": 106
                },
                "timeframe": "7d"
            },
            "falsepositives": [
                "Software installation"
            ],
            "level": "low",
            "tags": [
                "attack.t1053",
                "attack.s0111"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d75e808e-de36-4ead-a68d-b533990b5030",
            "created": "2018-12-03T23:30:44.679Z",
            "modified": "2018-12-03T23:30:44.679Z",
            "title": "PsExec Tool Execution",
            "status": "experimental",
            "description": "Detects PsExec service installation and execution events (service and Sysmon)",
            "references": [
                "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
                "https://jpcertcc.github.io/ToolAnalysisResultSheet"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "product": "windows"
            },
            "detection": {
                "condition": "1 of them",
                "service_execution": {
                    "EventID": 7036,
                    "ServiceName": "PSEXESVC"
                },
                "service_installation": {
                    "EventID": 7045,
                    "ServiceFileName": "*\\PSEXESVC.exe",
                    "ServiceName": "PSEXESVC"
                },
                "sysmon_processcreation": {
                    "EventID": 1,
                    "Image": "*\\PSEXESVC.exe",
                    "User": "NT AUTHORITY\\SYSTEM"
                }
            },
            "fields": [
                "EventID",
                "CommandLine",
                "ParentCommandLine",
                "ServiceName",
                "ServiceFileName"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "low",
            "tags": [
                "attack.execution",
                "attack.t1035",
                "attack.s0029"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--139e4d49-96e5-4d79-8164-cc4bc130f67d",
            "created": "2018-12-03T23:30:44.681Z",
            "modified": "2018-12-03T23:30:44.681Z",
            "title": "WMI Persistence",
            "status": "experimental",
            "description": "Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10, 2012 and higher)",
            "references": [
                "https://twitter.com/mattifestation/status/899646620148539397",
                "https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "wmi"
            },
            "detection": {
                "condition": "selection and 1 of keywords or selection2",
                "keywords": [
                    "ActiveScriptEventConsumer",
                    "CommandLineEventConsumer",
                    "CommandLineTemplate",
                    "Binding EventFilter"
                ],
                "selection": {
                    "EventID": 5861
                },
                "selection2": {
                    "EventID": 5859
                }
            },
            "falsepositives": [
                "Unknown (data set is too small; further testing needed)"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1047"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f7c59f88-1fbc-4e9e-88a8-edc3c699ff55",
            "created": "2018-12-03T23:30:44.683Z",
            "modified": "2018-12-03T23:30:44.683Z",
            "title": "NTFS Alternate Data Stream",
            "status": "experimental",
            "description": "Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.",
            "references": [
                "http://www.powertheshell.com/ntfsstreams/"
            ],
            "author": "Sami Ruohonen",
            "logsource": {
                "product": "windows",
                "description": "It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277",
                "service": "powershell"
            },
            "detection": {
                "condition": "keyword1 and keyword2",
                "keyword1": [
                    "set-content"
                ],
                "keyword2": [
                    "-stream"
                ]
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.t1096"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--20c56d2a-e251-45d6-b577-f04a7e61d313",
            "created": "2018-12-03T23:30:44.686Z",
            "modified": "2018-12-03T23:30:44.686Z",
            "title": "PowerShell Downgrade Attack",
            "status": "experimental",
            "description": "Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0",
            "references": [
                "http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/"
            ],
            "author": "Florian Roth (rule), Lee Holmes (idea)",
            "logsource": {
                "product": "windows",
                "service": "powershell-classic"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "HostVersion": "2.*"
                },
                "selection": {
                    "EngineVersion": "2.*",
                    "EventID": 400
                }
            },
            "falsepositives": [
                "Penetration Test",
                "Unknown"
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9333ebdd-f7ac-4e39-a21c-ebce9ea037ee",
            "created": "2018-12-03T23:30:44.687Z",
            "modified": "2018-12-03T23:30:44.687Z",
            "title": "Suspicious PowerShell Download",
            "status": "experimental",
            "description": "Detects suspicious PowerShell download command",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "powershell"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "System.Net.WebClient).DownloadString(",
                    "system.net.webclient).downloadfile("
                ]
            },
            "falsepositives": [
                "PowerShell scripts that download content from the Internet"
            ],
            "level": "medium",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1abd7428-b19a-4b86-a55d-118f72d50d70",
            "created": "2018-12-03T23:30:44.689Z",
            "modified": "2018-12-03T23:30:44.689Z",
            "action": "global",
            "title": "Suspicious Encoded PowerShell Command Line",
            "status": "experimental",
            "description": "Detects suspicious powershell process which includes bxor command, alternatvide obfuscation method to b64 encoded commands.",
            "author": "Sami Ruohonen",
            "date": "2018/09/05",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "* -bxor*"
                    ]
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b2ef2e3a-9bf9-436f-98ff-fdd8e7e3254e",
            "created": "2018-12-03T23:30:44.689Z",
            "modified": "2018-12-03T23:30:44.689Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--012840af-4c96-46f0-bc10-226b2106b282",
            "created": "2018-12-03T23:30:44.690Z",
            "modified": "2018-12-03T23:30:44.690Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--664d0821-3efe-4bc5-91e0-c621b0904606",
            "created": "2018-12-03T23:30:44.692Z",
            "modified": "2018-12-03T23:30:44.692Z",
            "title": "Suspicious PowerShell Invocations - Generic",
            "status": "experimental",
            "description": "Detects suspicious PowerShell invocation command parameters",
            "author": "Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "service": "powershell"
            },
            "detection": {
                "condition": "all of them",
                "encoded": [
                    " -enc ",
                    " -EncodedCommand "
                ],
                "hidden": [
                    " -w hidden ",
                    " -window hidden ",
                    " - windowstyle hidden "
                ],
                "noninteractive": [
                    " -noni ",
                    " -noninteractive "
                ]
            },
            "falsepositives": [
                "Penetration tests",
                "Very special / sneaky PowerShell scripts"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8390c12c-99d6-4101-b4c3-18d507d2db28",
            "created": "2018-12-03T23:30:44.694Z",
            "modified": "2018-12-03T23:30:44.694Z",
            "title": "PowerShell called from an Executable Version Mismatch",
            "status": "experimental",
            "description": "Detects PowerShell called from an executable by the version mismatch method",
            "references": [
                "https://adsecurity.org/?p=2921"
            ],
            "author": "Sean Metcalf (source), Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "service": "powershell-classic"
            },
            "detection": {
                "condition": "selection1",
                "selection1": {
                    "EngineVersion": [
                        "2.*",
                        "4.*",
                        "5.*"
                    ],
                    "EventID": 400,
                    "HostVersion": "3.*"
                }
            },
            "falsepositives": [
                "Penetration Tests",
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--15026178-860c-456f-b129-136f041cb0fa",
            "created": "2018-12-03T23:30:44.697Z",
            "modified": "2018-12-03T23:30:44.697Z",
            "title": "Malicious PowerShell Keywords",
            "status": "experimental",
            "description": "Detects keywords from well-known PowerShell exploitation frameworks",
            "references": [
                "https://adsecurity.org/?p=2921"
            ],
            "author": "Sean Metcalf (source), Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "description": "It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277",
                "service": "powershell"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "AdjustTokenPrivileges",
                    "IMAGE_NT_OPTIONAL_HDR64_MAGIC",
                    "Management.Automation.RuntimeException",
                    "Microsoft.Win32.UnsafeNativeMethods",
                    "ReadProcessMemory.Invoke",
                    "Runtime.InteropServices",
                    "SE_PRIVILEGE_ENABLED",
                    "System.Security.Cryptography",
                    "System.Runtime.InteropServices",
                    "LSA_UNICODE_STRING",
                    "MiniDumpWriteDump",
                    "PAGE_EXECUTE_READ",
                    "Net.Sockets.SocketFlags",
                    "Reflection.Assembly",
                    "SECURITY_DELEGATION",
                    "TOKEN_ADJUST_PRIVILEGES",
                    "TOKEN_ALL_ACCESS",
                    "TOKEN_ASSIGN_PRIMARY",
                    "TOKEN_DUPLICATE",
                    "TOKEN_ELEVATION",
                    "TOKEN_IMPERSONATE",
                    "TOKEN_INFORMATION_CLASS",
                    "TOKEN_PRIVILEGES",
                    "TOKEN_QUERY",
                    "Metasploit",
                    "Mimikatz"
                ]
            },
            "falsepositives": [
                "Penetration tests"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--05e8a7d9-0dd9-4170-820c-2531e4f6b6b1",
            "created": "2018-12-03T23:30:44.704Z",
            "modified": "2018-12-03T23:30:44.704Z",
            "title": "Malicious PowerShell Commandlets",
            "status": "experimental",
            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
            "references": [
                "https://adsecurity.org/?p=2921"
            ],
            "author": "Sean Metcalf (source), Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "description": "It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277",
                "service": "powershell"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Invoke-DllInjection",
                    "Invoke-Shellcode",
                    "Invoke-WmiCommand",
                    "Get-GPPPassword",
                    "Get-Keystrokes",
                    "Get-TimedScreenshot",
                    "Get-VaultCredential",
                    "Invoke-CredentialInjection",
                    "Invoke-Mimikatz",
                    "Invoke-NinjaCopy",
                    "Invoke-TokenManipulation",
                    "Out-Minidump",
                    "VolumeShadowCopyTools",
                    "Invoke-ReflectivePEInjection",
                    "Invoke-UserHunter",
                    "Find-GPOLocation",
                    "Invoke-ACLScanner",
                    "Invoke-DowngradeAccount",
                    "Get-ServiceUnquoted",
                    "Get-ServiceFilePermission",
                    "Get-ServicePermission",
                    "Invoke-ServiceAbuse",
                    "Install-ServiceBinary",
                    "Get-RegAutoLogon",
                    "Get-VulnAutoRun",
                    "Get-VulnSchTask",
                    "Get-UnattendedInstallFile",
                    "Get-WebConfig",
                    "Get-ApplicationHost",
                    "Get-RegAlwaysInstallElevated",
                    "Get-Unconstrained",
                    "Add-RegBackdoor",
                    "Add-ScrnSaveBackdoor",
                    "Gupt-Backdoor",
                    "Invoke-ADSBackdoor",
                    "Enabled-DuplicateToken",
                    "Invoke-PsUaCme",
                    "Remove-Update",
                    "Check-VM",
                    "Get-LSASecret",
                    "Get-PassHashes",
                    "Invoke-Mimikatz",
                    "Show-TargetScreen",
                    "Port-Scan",
                    "Invoke-PoshRatHttp",
                    "Invoke-PowerShellTCP",
                    "Invoke-PowerShellWMI",
                    "Add-Exfiltration",
                    "Add-Persistence",
                    "Do-Exfiltration",
                    "Start-CaptureServer",
                    "Invoke-DllInjection",
                    "Invoke-ReflectivePEInjection",
                    "Invoke-ShellCode",
                    "Get-ChromeDump",
                    "Get-ClipboardContents",
                    "Get-FoxDump",
                    "Get-IndexedItem",
                    "Get-Keystrokes",
                    "Get-Screenshot",
                    "Invoke-Inveigh",
                    "Invoke-NetRipper",
                    "Invoke-NinjaCopy",
                    "Out-Minidump",
                    "Invoke-EgressCheck",
                    "Invoke-PostExfil",
                    "Invoke-PSInject",
                    "Invoke-RunAs",
                    "MailRaider",
                    "New-HoneyHash",
                    "Set-MacAttribute",
                    "Get-VaultCredential",
                    "Invoke-DCSync",
                    "Invoke-Mimikatz",
                    "Invoke-PowerDump",
                    "Invoke-TokenManipulation",
                    "Exploit-Jboss",
                    "Invoke-ThunderStruck",
                    "Invoke-VoiceTroll",
                    "Set-Wallpaper",
                    "Invoke-InveighRelay",
                    "Invoke-PsExec",
                    "Invoke-SSHCommand",
                    "Get-SecurityPackages",
                    "Install-SSP",
                    "Invoke-BackdoorLNK",
                    "PowerBreach",
                    "Get-GPPPassword",
                    "Get-SiteListPassword",
                    "Get-System",
                    "Invoke-BypassUAC",
                    "Invoke-Tater",
                    "Invoke-WScriptBypassUAC",
                    "PowerUp",
                    "PowerView",
                    "Get-RickAstley",
                    "Find-Fruit",
                    "HTTP-Login",
                    "Find-TrustedDocuments",
                    "Invoke-Paranoia",
                    "Invoke-WinEnum",
                    "Invoke-ARPScan",
                    "Invoke-PortScan",
                    "Invoke-ReverseDNSLookup",
                    "Invoke-SMBScanner",
                    "Invoke-Mimikittenz"
                ]
            },
            "falsepositives": [
                "Penetration testing"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6cf44b17-f61a-4aee-9af1-8c2d37060ef6",
            "created": "2018-12-03T23:30:44.706Z",
            "modified": "2018-12-03T23:30:44.706Z",
            "title": "PowerShell Credential Prompt",
            "status": "experimental",
            "description": "Detects PowerShell calling a credential prompt",
            "references": [
                "https://twitter.com/JohnLaTwC/status/850381440629981184",
                "https://t.co/ezOTGy1a1G"
            ],
            "author": "John Lambert (idea), Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "description": "Script block logging must be enabled",
                "service": "powershell"
            },
            "detection": {
                "condition": "all of them",
                "keyword": [
                    "PromptForCredential"
                ],
                "selection": {
                    "EventID": 4104
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.credential_access",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8acdfd17-9811-45db-9a4f-8cae885aba7a",
            "created": "2018-12-03T23:30:44.708Z",
            "modified": "2018-12-03T23:30:44.708Z",
            "title": "Suspicious PowerShell Invocations - Specific",
            "status": "experimental",
            "description": "Detects suspicious PowerShell invocation command parameters",
            "author": "Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "service": "powershell"
            },
            "detection": {
                "condition": "keywords",
                "keywords": [
                    " -nop -w hidden -c * [Convert]::FromBase64String",
                    " -w hidden -noni -nop -c \"iex(New-Object",
                    " -w hidden -ep bypass -Enc",
                    "powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run",
                    "bypass -noprofile -windowstyle hidden (new-object system.net.webclient).download",
                    "iex(New-Object Net.WebClient).Download"
                ]
            },
            "falsepositives": [
                "Penetration tests"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--5e72e301-de3f-4f75-89fe-adc216c33f83",
            "created": "2018-12-03T23:30:44.710Z",
            "modified": "2018-12-03T23:30:44.710Z",
            "title": "PowerShell ShellCode",
            "status": "experimental",
            "description": "Detects Base64 encoded Shellcode",
            "references": [
                "https://twitter.com/cyb3rops/status/1063072865992523776"
            ],
            "author": "David Ledbetter (shellcode), Florian Roth (rule)",
            "date": "2018/11/17",
            "logsource": {
                "product": "windows",
                "description": "Script block logging must be enabled",
                "service": "powershell"
            },
            "detection": {
                "condition": "selection and keyword1 and keyword2",
                "keyword1": [
                    "*AAAAYInlM*"
                ],
                "selection": {
                    "EventID": 4104
                },
                "keyword2": [
                    "*OiCAAAAYInlM*",
                    "*OiJAAAAYInlM*"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.execution"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--68543904-2eed-49f1-9500-f6704c67d5c2",
            "created": "2018-12-03T23:30:44.712Z",
            "modified": "2018-12-03T23:30:44.712Z",
            "title": "PowerShell PSAttack",
            "status": "experimental",
            "description": "Detects the use of PSAttack PowerShell hack tool",
            "references": [
                "https://adsecurity.org/?p=2921"
            ],
            "author": "Sean Metcalf (source), Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "description": "It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277",
                "service": "powershell"
            },
            "detection": {
                "condition": "all of them",
                "keyword": [
                    "PS ATTACK!!!"
                ],
                "selection": {
                    "EventID": 4103
                }
            },
            "falsepositives": [
                "Pentesters"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0b663e0c-af8a-494c-88a2-86f9df5c0a71",
            "created": "2018-12-03T23:30:44.714Z",
            "modified": "2018-12-03T23:30:44.714Z",
            "title": "Execution in Non-Executable Folder",
            "status": "experimental",
            "description": "Detects a suspicious exection from an uncommon folder",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\$Recycle.bin",
                        "*\\Users\\All Users\\*",
                        "*\\Users\\Default\\*",
                        "*\\Users\\Public\\*",
                        "C:\\Perflogs\\*",
                        "*\\config\\systemprofile\\*",
                        "*\\Windows\\Fonts\\*",
                        "*\\Windows\\IME\\*",
                        "*\\Windows\\addins\\*"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c91beae4-52a5-4c1f-80c2-21a2fbd394b3",
            "created": "2018-12-03T23:30:44.716Z",
            "modified": "2018-12-03T23:30:44.716Z",
            "title": "Office Macro Starts Cmd",
            "status": "experimental",
            "description": "Detects a Windows command line executable started from Microsoft Word or Excel",
            "references": [
                "https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\cmd.exe",
                    "ParentImage": [
                        "*\\WINWORD.EXE",
                        "*\\EXCEL.EXE"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--934c56d7-c2bf-4024-b6b3-70872f69f2ed",
            "created": "2018-12-03T23:30:44.719Z",
            "modified": "2018-12-03T23:30:44.719Z",
            "title": "PowerShell Network Connections",
            "status": "experimental",
            "description": "Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')",
            "references": [
                "https://www.youtube.com/watch?v=DLtJTxMWZ2o"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "DestinationIp": [
                        "10.*",
                        "192.168.*",
                        "172.*",
                        "127.0.0.1"
                    ],
                    "DestinationIsIpv6": "false",
                    "User": "NT AUTHORITY\\SYSTEM"
                },
                "selection": {
                    "EventID": 3,
                    "Image": "*\\powershell.exe"
                }
            },
            "falsepositives": [
                "Administrative scripts"
            ],
            "level": "low",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--baa13c99-83c4-401a-8d31-c3c13cfdbfa4",
            "created": "2018-12-03T23:30:44.721Z",
            "modified": "2018-12-03T23:30:44.721Z",
            "title": "CobaltStrike Process Injection",
            "status": "experimental",
            "description": "Detects a possible remote threat creation with certain characteristics which are typical for Cobalt Strike beacons",
            "references": [
                "https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f"
            ],
            "author": "Olaf Hartong, Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 8,
                    "TargetProcessAddress": "*0B80"
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.process_injection",
                "attack.t1055"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--510d719c-c407-4480-9ed0-adab2d523872",
            "created": "2018-12-03T23:30:44.724Z",
            "modified": "2018-12-03T23:30:44.724Z",
            "title": "Suspicious PowerShell Parameter Substring",
            "status": "experimental",
            "description": "Detects suspicious PowerShell invocation with a parameter substring",
            "references": [
                "http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier"
            ],
            "author": "Florian Roth (rule), Daniel Bohannon (idea)",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "all of them",
                "keywords": {
                    "Image": "*\\powershell.exe"
                },
                "substrings": [
                    " -windowstyle h ",
                    " -windowstyl h",
                    " -windowsty h",
                    " -windowst h",
                    " -windows h",
                    " -windo h",
                    " -wind h",
                    " -win h",
                    " -wi h",
                    " -win h ",
                    " -win hi ",
                    " -win hid ",
                    " -win hidd ",
                    " -win hidde ",
                    " -NoPr ",
                    " -NoPro ",
                    " -NoProf ",
                    " -NoProfi ",
                    " -NoProfil ",
                    " -nonin ",
                    " -nonint ",
                    " -noninte ",
                    " -noninter ",
                    " -nonintera ",
                    " -noninterac ",
                    " -noninteract ",
                    " -noninteracti ",
                    " -noninteractiv ",
                    " -ec ",
                    " -encodedComman ",
                    " -encodedComma ",
                    " -encodedComm ",
                    " -encodedCom ",
                    " -encodedCo ",
                    " -encodedC ",
                    " -encoded ",
                    " -encode ",
                    " -encod ",
                    " -enco ",
                    " -en "
                ]
            },
            "falsepositives": [
                "Penetration tests"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3a2b4cd1-fd23-4b71-8d77-504097234b99",
            "created": "2018-12-03T23:30:44.726Z",
            "modified": "2018-12-03T23:30:44.726Z",
            "title": "WMI Persistence - Script Event Consumer File Write",
            "status": "experimental",
            "description": "Detects file writes of WMI script event consumer",
            "references": [
                "https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/"
            ],
            "author": "Thomas Patzke",
            "date": "2018/03/07",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 11,
                    "Image": "C:\\WINDOWS\\system32\\wbem\\scrcons.exe"
                }
            },
            "falsepositives": [
                "Unknown (data set is too small; further testing needed)"
            ],
            "level": "high",
            "tags": [
                "attack.t1084",
                "attack.persistence"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--49002af3-9970-4097-8256-6f865ee0fe6b",
            "created": "2018-12-03T23:30:44.728Z",
            "modified": "2018-12-03T23:30:44.728Z",
            "title": "Microsoft Binary Suspicious Communication Endpoint",
            "status": "experimental",
            "description": "Detects an executable in the Windows folder accessing suspicious domains",
            "references": [
                "https://twitter.com/M_haggis/status/900741347035889665",
                "https://twitter.com/M_haggis/status/1032799638213066752"
            ],
            "author": "Florian Roth",
            "date": "2018/08/30",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "DestinationHostname": [
                        "*dl.dropboxusercontent.com",
                        "*.pastebin.com"
                    ],
                    "Image": "C:\\Windows\\*"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3de1a11a-ff6a-4155-8fcc-026b46bd9b73",
            "created": "2018-12-03T23:30:44.731Z",
            "modified": "2018-12-03T23:30:44.731Z",
            "title": "PowerShell Rundll32 Remote Thread Creation",
            "status": "experimental",
            "description": "Detects PowerShell remote thread creation in Rundll32.exe",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html"
            ],
            "author": "Florian Roth",
            "date": "2018/06/25",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 8,
                    "SourceImage": "*\\powershell.exe",
                    "TargetImage": "*\\rundll32.exe"
                }
            },
            "falsepositives": [
                "Unkown"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1085",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b4773eaa-ce3f-418a-a1d8-bc309862a9ac",
            "created": "2018-12-03T23:30:44.733Z",
            "modified": "2018-12-03T23:30:44.733Z",
            "title": "CMSTP Execution",
            "status": "stable",
            "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution",
            "references": [
                "http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/"
            ],
            "author": "Nik Seetharaman",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "EventID": 1,
                    "ParentImage": "*\\cmstp.exe"
                },
                "selection2": {
                    "EventID": 12,
                    "TargetObject": "*\\cmmgr32.exe*"
                },
                "selection3": {
                    "EventID": 13,
                    "TargetObject": "*\\cmmgr32.exe*"
                },
                "selection4": {
                    "CallTrace": "*cmlua.dll*",
                    "EventID": 10
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "Details"
            ],
            "falsepositives": [
                "Legitimate CMSTP use (unlikely in modern enterprise environments)"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1191",
                "attack.g0069"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e202d3cb-568e-4226-b9ef-08ab55af8a04",
            "created": "2018-12-03T23:30:44.735Z",
            "modified": "2018-12-03T23:30:44.735Z",
            "title": "Exploit for CVE-2017-8759",
            "description": "Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759",
            "references": [
                "https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100",
                "https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100"
            ],
            "author": "Florian Roth",
            "date": "15.09.2017",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\csc.exe",
                    "ParentImage": "*\\WINWORD.EXE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--179189af-c2b8-4cc9-b5c0-20b7e7467924",
            "created": "2018-12-03T23:30:44.737Z",
            "modified": "2018-12-03T23:30:44.737Z",
            "title": "Scheduled Task Creation",
            "status": "experimental",
            "description": "Detects the creation of scheduled tasks in user session",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "User": "NT AUTHORITY\\SYSTEM"
                },
                "selection": {
                    "CommandLine": "* /create *",
                    "EventID": 1,
                    "Image": "*\\schtasks.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Administrative activity",
                "Software installation"
            ],
            "level": "low",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privelege_escalation",
                "attack.t1053",
                "attack.s0111"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e5e075d3-e50c-4a9a-ad34-e7d90d6e6abd",
            "created": "2018-12-03T23:30:44.739Z",
            "modified": "2018-12-03T23:30:44.739Z",
            "title": "Usage of Sysinternals Tools",
            "status": "experimental",
            "description": "Detects the usage of Sysinternals Tools due to accepteula key beeing added to Registry",
            "references": [
                "https://twitter.com/Moti_B/status/1008587936735035392"
            ],
            "author": "Markus Neis",
            "date": "2017/08/28",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 13,
                    "TargetObject": "*\\EulaAccepted"
                }
            },
            "falsepositives": [
                "Legitimate use of SysInternals tools",
                "Programs that use the same Registry Key"
            ],
            "level": "low"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1c58eee4-8b30-4a25-92e1-6aee1f916416",
            "created": "2018-12-03T23:30:44.742Z",
            "modified": "2018-12-03T23:30:44.742Z",
            "title": "Malware Shellcode in Verclsid Target Process",
            "status": "experimental",
            "description": "Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro",
            "references": [
                "https://twitter.com/JohnLaTwC/status/837743453039534080"
            ],
            "author": "John Lambert (tech), Florian Roth (rule)",
            "date": "2017/03/04",
            "logsource": {
                "product": "windows",
                "description": "Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>",
                "service": "sysmon"
            },
            "detection": {
                "combination1": {
                    "CallTrace": "*|UNKNOWN(*VBE7.DLL*"
                },
                "combination2": {
                    "CallTrace": "*|UNKNOWN*",
                    "SourceImage": "*\\Microsoft Office\\*"
                },
                "condition": "selection and 1 of combination*",
                "selection": {
                    "EventID": 10,
                    "GrantedAccess": "0x1FFFFF",
                    "TargetImage": "*\\verclsid.exe"
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--9c778471-4771-4df4-a66f-a40232eff288",
            "created": "2018-12-03T23:30:44.744Z",
            "modified": "2018-12-03T23:30:44.744Z",
            "title": "Suspicious Svchost Process",
            "status": "experimental",
            "description": "Detects a suspicious svchost process start",
            "author": "Florian Roth",
            "date": "2017/08/15",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "ParentImage": [
                        "*\\services.exe",
                        "*\\MsMpEng.exe"
                    ]
                },
                "selection": {
                    "EventID": 1,
                    "Image": "*\\svchost.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d937559b-601f-457b-8106-f3b2f63269f0",
            "created": "2018-12-03T23:30:44.747Z",
            "modified": "2018-12-03T23:30:44.747Z",
            "title": "Mimikatz In-Memory",
            "status": "experimental",
            "description": "Detects certain DLL loads when Mimikatz gets executed",
            "references": [
                "https://securityriskadvisors.com/blog/post/detecting-in-memory-mimikatz/"
            ],
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selector | near dllload1 and dllload2 and not exclusion",
                "dllload1": {
                    "ImageLoaded": "*\\vaultcli.dll"
                },
                "dllload2": {
                    "ImageLoaded": "*\\wlanapi.dll"
                },
                "exclusion": {
                    "ImageLoaded": [
                        "ntdsapi.dll",
                        "netapi32.dll",
                        "imm32.dll",
                        "samlib.dll",
                        "combase.dll",
                        "srvcli.dll",
                        "shcore.dll",
                        "ntasn1.dll",
                        "cryptdll.dll",
                        "logoncli.dll"
                    ]
                },
                "selector": {
                    "EventID": 7,
                    "Image": "C:\\Windows\\System32\\rundll32.exe"
                },
                "timeframe": "30s"
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "medium",
            "tags": [
                "attack.s0002",
                "attack.lateral_movement",
                "attack.credential_access"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--4ebd8c01-42dd-4134-b7e6-09370f44dc9e",
            "created": "2018-12-03T23:30:44.748Z",
            "modified": "2018-12-03T23:30:44.748Z",
            "title": "MSHTA spwaned by SVCHOST as seen in LethalHTA",
            "status": "experimental",
            "description": "Detects MSHTA.EXE spwaned by SVCHOST described in report",
            "references": [
                "https://codewhitesec.blogspot.com/2018/07/lethalhta.html"
            ],
            "author": "Markus Neis",
            "date": "2018/06/07",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\mshta.exe",
                    "ParentImage": "*\\svchost.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b0068d5b-11b4-46f6-8a1b-8fa1532570e1",
            "created": "2018-12-03T23:30:44.754Z",
            "modified": "2018-12-03T23:30:44.754Z",
            "title": "Processes created by MMC",
            "status": "experimental",
            "description": "Processes started by MMC could be a sign of lateral movement using MMC application COM object",
            "references": [
                "https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/"
            ],
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not exclusion",
                "exclusion": {
                    "CommandLine": "*\\RunCmd.cmd"
                },
                "selection": {
                    "EventID": 1,
                    "Image": "*\\cmd.exe",
                    "ParentImage": "*\\mmc.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--bdd5025b-e877-46fc-8f59-ad13c2521ad4",
            "created": "2018-12-03T23:30:44.756Z",
            "modified": "2018-12-03T23:30:44.756Z",
            "title": "Rundll32 Internet Connection",
            "status": "experimental",
            "description": "Detects a rundll32 that communicates with public IP addresses",
            "references": [
                "https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100"
            ],
            "author": "Florian Roth",
            "date": "2017/11/04",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "DestinationIp": [
                        "10.*",
                        "192.168.*",
                        "172.*"
                    ]
                },
                "selection": {
                    "EventID": 3,
                    "Image": "*\\rundll32.exe"
                }
            },
            "falsepositives": [
                "Communication to other corporate systems that use IP addresses from public address spaces"
            ],
            "level": "medium",
            "tags": [
                "attack.t1085",
                "attack.defense_evasion",
                "attack.execution"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--21656353-bed6-4e38-be91-f15752ccb565",
            "created": "2018-12-03T23:30:44.759Z",
            "modified": "2018-12-03T23:30:44.759Z",
            "title": "Net.exe Execution",
            "status": "experimental",
            "description": "Detects execution of Net.exe, whether suspicious or benign.",
            "references": [
                "https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/"
            ],
            "author": "Michael Haag, Mark Woan (improvements)",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "* group*",
                        "* localgroup*",
                        "* user*",
                        "* view*",
                        "* share",
                        "* accounts*",
                        "* use*"
                    ],
                    "EventID": 1,
                    "Image": [
                        "*\\net.exe",
                        "*\\net1.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Will need to be tuned. If using Splunk, I recommend | stats count by Computer,CommandLine following the search for easy hunting by computer/CommandLine."
            ],
            "level": "low",
            "tags": [
                "attack.s0039",
                "attack.lateral_movement",
                "attack.discovery"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--c9e88676-1695-4376-b7e8-132e439c763d",
            "created": "2018-12-03T23:30:44.761Z",
            "modified": "2018-12-03T23:30:44.761Z",
            "title": "Microsoft Binary Github Communication",
            "status": "experimental",
            "description": "Detects an executable in the Windows folder accessing github.com",
            "references": [
                "https://twitter.com/M_haggis/status/900741347035889665",
                "https://twitter.com/M_haggis/status/1032799638213066752"
            ],
            "author": "Michael Haag (idea), Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "DestinationHostname": [
                        "*.github.com",
                        "*.githubusercontent.com"
                    ],
                    "Image": "C:\\Windows\\*"
                }
            },
            "falsepositives": [
                "Unknown",
                "@subTee in your network"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3f9b76e2-c9f3-4fb9-b890-c45df4e5f863",
            "created": "2018-12-03T23:30:44.764Z",
            "modified": "2018-12-03T23:30:44.764Z",
            "title": "Webshell Detection With Command Line Keywords",
            "description": "Detects certain command line parameters often used during reconnaissance activity via web shells",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "whoami",
                        "net user",
                        "ping -n",
                        "systeminfo"
                    ],
                    "EventID": 1,
                    "ParentImage": [
                        "*\\apache*",
                        "*\\tomcat*",
                        "*\\w3wp.exe",
                        "*\\php-cgi.exe",
                        "*\\nginx.exe",
                        "*\\httpd.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.t1100"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--aeece2cc-4b1c-49fe-9bf0-aab05743b860",
            "created": "2018-12-03T23:30:44.766Z",
            "modified": "2018-12-03T23:30:44.766Z",
            "title": "Powershell AMSI Bypass via .NET Reflection",
            "status": "experimental",
            "description": "Detects Request to amsiInitFailed that can be used to disable AMSI Scanning",
            "references": [
                "https://twitter.com/mattifestation/status/735261176745988096",
                "https://www.hybrid-analysis.com/sample/0ced17419e01663a0cd836c9c2eb925e3031ffb5b18ccf35f4dea5d586d0203e?environmentId=120"
            ],
            "author": "Markus Neis",
            "date": "2018/08/17",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection1 and selection2",
                "falsepositives": [
                    "Potential Admin Activity"
                ],
                "selection1": {
                    "CommandLine": [
                        "*System.Management.Automation.AmsiUtils*"
                    ],
                    "EventID": 1
                },
                "selection2": {
                    "CommandLine": [
                        "*amsiInitFailed*"
                    ]
                }
            },
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e76f00f0-d2ba-40d9-a0fb-12513bb32f29",
            "created": "2018-12-03T23:30:44.768Z",
            "modified": "2018-12-03T23:30:44.768Z",
            "title": "Java Running with Remote Debugging",
            "description": "Detects a JAVA process running with remote debugging allowing more than just localhost to connect",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not exclusion",
                "exclusion": [
                    {
                        "CommandLine": "*address=127.0.0.1*"
                    },
                    {
                        "CommandLine": "*address=localhost*"
                    }
                ],
                "selection": {
                    "CommandLine": "*transport=dt_socket,address=*",
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--459c483f-9b20-47dd-9c45-d2f61516ba2f",
            "created": "2018-12-03T23:30:44.771Z",
            "modified": "2018-12-03T23:30:44.771Z",
            "title": "UAC Bypass via Event Viewer",
            "status": "experimental",
            "description": "Detects UAC bypass method using Windows event viewer",
            "references": [
                "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/",
                "https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "methregistry or ( methprocess and not filterprocess )",
                "filterprocess": {
                    "Image": "*\\mmc.exe"
                },
                "methprocess": {
                    "EventID": 1,
                    "ParentImage": "*\\eventvwr.exe"
                },
                "methregistry": {
                    "EventID": 13,
                    "TargetObject": "HKEY_USERS\\*\\mscfile\\shell\\open\\command"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.defense_evasion",
                "attack.privilege_escalation",
                "attack.t1088"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--70e15b5a-6eda-4709-9935-e7324b39823c",
            "created": "2018-12-03T23:30:44.774Z",
            "modified": "2018-12-03T23:30:44.774Z",
            "title": "Microsoft Workflow Compiler",
            "status": "experimental",
            "description": "Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code.",
            "references": [
                "https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb"
            ],
            "author": "Nik Seetharaman",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\Microsoft.Workflow.Compiler.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Legitimate MWC use (unlikely in modern enterprise environments)"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.execution"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--df18048a-a06d-49a9-8ac3-77e06a9123fa",
            "created": "2018-12-03T23:30:44.785Z",
            "modified": "2018-12-03T23:30:44.785Z",
            "title": "Executable used by PlugX in Uncommon Location",
            "status": "experimental",
            "description": "Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location",
            "references": [
                "http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/",
                "https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/"
            ],
            "author": "Florian Roth",
            "date": "2017/06/12",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "( selection_cammute and not filter_cammute ) or ( selection_chrome_frame and not filter_chrome_frame ) or ( selection_devemu and not filter_devemu ) or ( selection_gadget and not filter_gadget ) or ( selection_hcc and not filter_hcc ) or ( selection_hkcmd and not filter_hkcmd ) or ( selection_mc and not filter_mc ) or ( selection_msmpeng and not filter_msmpeng ) or ( selection_msseces and not filter_msseces ) or ( selection_oinfo and not filter_oinfo ) or ( selection_oleview and not filter_oleview ) or ( selection_rc and not filter_rc )",
                "filter_cammute": {
                    "EventID": 1,
                    "Image": "*\\Lenovo\\Communication Utility\\*"
                },
                "filter_chrome_frame": {
                    "EventID": 1,
                    "Image": "*\\Google\\Chrome\\application\\*"
                },
                "filter_devemu": {
                    "EventID": 1,
                    "Image": "*\\Microsoft Device Emulator\\*"
                },
                "filter_gadget": {
                    "EventID": 1,
                    "Image": "*\\Windows Media Player\\*"
                },
                "filter_hcc": {
                    "EventID": 1,
                    "Image": "*\\HTML Help Workshop\\*"
                },
                "filter_hkcmd": {
                    "EventID": 1,
                    "Image": [
                        "*\\System32\\*",
                        "*\\SysNative\\*",
                        "*\\SysWowo64\\*"
                    ]
                },
                "filter_mc": {
                    "EventID": 1,
                    "Image": [
                        "*\\Microsoft Visual Studio*",
                        "*\\Microsoft SDK*",
                        "*\\Windows Kit*"
                    ]
                },
                "filter_msmpeng": {
                    "EventID": 1,
                    "Image": [
                        "*\\Microsoft Security Client\\*",
                        "*\\Windows Defender\\*",
                        "*\\AntiMalware\\*"
                    ]
                },
                "filter_msseces": {
                    "EventID": 1,
                    "Image": "*\\Microsoft Security Center\\*"
                },
                "filter_oinfo": {
                    "EventID": 1,
                    "Image": "*\\Common Files\\Microsoft Shared\\*"
                },
                "filter_oleview": {
                    "EventID": 1,
                    "Image": [
                        "*\\Microsoft Visual Studio*",
                        "*\\Microsoft SDK*",
                        "*\\Windows Kit*",
                        "*\\Windows Resource Kit\\*"
                    ]
                },
                "filter_rc": {
                    "EventID": 1,
                    "Image": [
                        "*\\Microsoft Visual Studio*",
                        "*\\Microsoft SDK*",
                        "*\\Windows Kit*",
                        "*\\Windows Resource Kit\\*",
                        "*\\Microsoft.NET\\*"
                    ]
                },
                "selection_cammute": {
                    "EventID": 1,
                    "Image": "*\\CamMute.exe"
                },
                "selection_chrome_frame": {
                    "EventID": 1,
                    "Image": "*\\chrome_frame_helper.exe"
                },
                "selection_devemu": {
                    "EventID": 1,
                    "Image": "*\\dvcemumanager.exe"
                },
                "selection_gadget": {
                    "EventID": 1,
                    "Image": "*\\Gadget.exe"
                },
                "selection_hcc": {
                    "EventID": 1,
                    "Image": "*\\hcc.exe"
                },
                "selection_hkcmd": {
                    "EventID": 1,
                    "Image": "*\\hkcmd.exe"
                },
                "selection_mc": {
                    "EventID": 1,
                    "Image": "*\\Mc.exe"
                },
                "selection_msmpeng": {
                    "EventID": 1,
                    "Image": "*\\MsMpEng.exe"
                },
                "selection_msseces": {
                    "EventID": 1,
                    "Image": "*\\msseces.exe"
                },
                "selection_oinfo": {
                    "EventID": 1,
                    "Image": "*\\OInfoP11.exe"
                },
                "selection_oleview": {
                    "EventID": 1,
                    "Image": "*\\OleView.exe"
                },
                "selection_rc": {
                    "EventID": 1,
                    "Image": "*\\OleView.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8a148db1-f37a-4073-bc2f-108cb3ef4c12",
            "created": "2018-12-03T23:30:44.788Z",
            "modified": "2018-12-03T23:30:44.788Z",
            "title": "SquiblyTwo",
            "status": "experimental",
            "description": "Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash",
            "references": [
                "https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html",
                "https://twitter.com/mattifestation/status/986280382042595328"
            ],
            "author": "Markus Neis / Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "CommandLine": [
                        "wmic * *format:\\\"http*",
                        "wmic * /format:'http",
                        "wmic * /format:http*"
                    ],
                    "EventID": 1,
                    "Image": [
                        "*\\wmic.exe"
                    ]
                },
                "selection2": {
                    "CommandLine": [
                        "* *format:\\\"http*",
                        "* /format:'http",
                        "* /format:http*"
                    ],
                    "EventID": 1,
                    "Imphash": [
                        "1B1A3F43BF37B5BFE60751F2EE2F326E",
                        "37777A96245A3C74EB217308F3546F4C",
                        "9D87C9D67CE724033C0B40CC4CA1B206"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.t1047"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--54370bbc-1d74-4543-a7ec-6345879b2846",
            "created": "2018-12-03T23:30:44.790Z",
            "modified": "2018-12-03T23:30:44.790Z",
            "title": "Possible Process Hollowing Image Loading",
            "status": "experimental",
            "description": "Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz",
            "references": [
                "https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for.html"
            ],
            "author": "Markus Neis",
            "date": "2018/01/07",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7,
                    "Image": [
                        "*\\notepad.exe"
                    ],
                    "ImageLoaded": [
                        "*\\samlib.dll",
                        "*\\WinSCard.dll"
                    ]
                }
            },
            "falsepositives": [
                "Very likely, needs more tuning"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a933b8a1-f4aa-4220-b6c0-2552fb51d2dc",
            "created": "2018-12-03T23:30:44.793Z",
            "modified": "2018-12-03T23:30:44.793Z",
            "title": "Activity Related to NTDS.dit Domain Hash Retrieval",
            "status": "experimental",
            "description": "Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely",
            "references": [
                "https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/",
                "https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/",
                "https://www.trustwave.com/Resources/SpiderLabs-Blog/Tutorial-for-NTDS-goodness-(VSSADMIN,-WMIS,-NTDS-dit,-SYSTEM)/",
                "https://securingtomorrow.mcafee.com/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/"
            ],
            "author": "Florian Roth, Michael Haag",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "vssadmin.exe Delete Shadows",
                        "vssadmin create shadow /for=C:",
                        "copy \\\\?\\GLOBALROOT\\Device\\*\\windows\\ntds\\ntds.dit",
                        "copy \\\\?\\GLOBALROOT\\Device\\*\\config\\SAM",
                        "vssadmin delete shadows /for=C:",
                        "reg SAVE HKLM\\SYSTEM "
                    ],
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Administrative activity"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--4201c8fa-fb4b-44e8-8097-66263acbc232",
            "created": "2018-12-03T23:30:44.796Z",
            "modified": "2018-12-03T23:30:44.796Z",
            "title": "MSHTA Spawning Windows Shell",
            "status": "experimental",
            "description": "Detects a Windows command line executable started from MSHTA.",
            "references": [
                "https://www.trustedsec.com/july-2015/malicious-htas/"
            ],
            "author": "Michael Haag",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "CommandLine": [
                        "*/HP/HP*",
                        "*\\HP\\HP*"
                    ]
                },
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\cmd.exe",
                        "*\\powershell.exe",
                        "*\\wscript.exe",
                        "*\\cscript.exe",
                        "*\\sh.exe",
                        "*\\bash.exe",
                        "*\\reg.exe",
                        "*\\regsvr32.exe",
                        "*\\BITSADMIN*"
                    ],
                    "ParentImage": "*\\mshta.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Printer software / driver installations"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1170"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--afbc8fa2-8d1a-4db1-8ab8-a73d8f2dc2a0",
            "created": "2018-12-03T23:30:44.798Z",
            "modified": "2018-12-03T23:30:44.798Z",
            "title": "Exploit for CVE-2015-1641",
            "status": "experimental",
            "description": "Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641",
            "references": [
                "https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/",
                "https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100"
            ],
            "author": "Florian Roth",
            "date": "2018/02/22",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\MicroScMgmt.exe ",
                    "ParentImage": "*\\WINWORD.EXE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8ee2ec61-88f3-41f7-aea7-749a58ae9355",
            "created": "2018-12-03T23:30:44.801Z",
            "modified": "2018-12-03T23:30:44.801Z",
            "title": "Suspicious WMI execution",
            "status": "experimental",
            "description": "Detects WMI executing suspicious commands",
            "references": [
                "https://digital-forensics.sans.org/blog/2010/06/04/wmic-draft/",
                "https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1",
                "https://blog.malwarebytes.com/threat-analysis/2016/04/rokku-ransomware/"
            ],
            "author": "Michael Haag, Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*/NODE:*process call create *",
                        "* path AntiVirusProduct get *",
                        "* path FirewallProduct get *",
                        "* shadowcopy delete *"
                    ],
                    "EventID": 1,
                    "Image": [
                        "*\\wmic.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Will need to be tuned",
                "If using Splunk, I recommend | stats count by Computer,CommandLine following for easy hunting by Computer/CommandLine."
            ],
            "level": "medium",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8bc51622-4f52-4204-a6b0-fa4f466942aa",
            "created": "2018-12-03T23:30:44.803Z",
            "modified": "2018-12-03T23:30:44.803Z",
            "title": "UAC Bypass via sdclt",
            "status": "experimental",
            "description": "Detects changes to HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand",
            "references": [
                "https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/"
            ],
            "author": "Omer Yampel",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 13,
                    "TargetObject": "HKEY_USERS\\*\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand"
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.privilege_escalation",
                "attack.t1088"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ef30838a-e180-4807-ab81-87132682b9d2",
            "created": "2018-12-03T23:30:44.804Z",
            "modified": "2018-12-03T23:30:44.804Z",
            "action": "global",
            "title": "Suspicious RDP Redirect Using TSCON",
            "status": "experimental",
            "description": "Detects a suspicious RDP session redirect using tscon.exe",
            "reference": [
                "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html",
                "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6"
            ],
            "author": "Florian Roth",
            "date": "2018/03/17",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": "* /dest:rdp-tcp:*"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e72ac89b-df5b-4308-a660-f2a1553c9f81",
            "created": "2018-12-03T23:30:44.805Z",
            "modified": "2018-12-03T23:30:44.805Z",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "selection": {
                    "EventID": 1
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--476b6b4c-7acc-4985-a0bf-7c4d4f5c407c",
            "created": "2018-12-03T23:30:44.806Z",
            "modified": "2018-12-03T23:30:44.806Z",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation",
                "service": "security"
            },
            "detection": {
                "selection": {
                    "EventID": 4688
                }
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--57e57d7f-5f88-4fed-9a68-ad0366d7cfb1",
            "created": "2018-12-03T23:30:44.810Z",
            "modified": "2018-12-03T23:30:44.810Z",
            "title": "Microsoft Office Product Spawning Windows Shell",
            "status": "experimental",
            "description": "Detects a Windows command line executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio.",
            "references": [
                "https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100",
                "https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html"
            ],
            "author": "Michael Haag, Florian Roth, Markus Neis",
            "date": "2018/04/06",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\cmd.exe",
                        "*\\powershell.exe",
                        "*\\wscript.exe",
                        "*\\cscript.exe",
                        "*\\sh.exe",
                        "*\\bash.exe",
                        "*\\scrcons.exe",
                        "*\\schtasks.exe",
                        "*\\regsvr32.exe",
                        "*\\hh.exe",
                        "*\\wmic.exe",
                        "*\\mshta.exe",
                        "*\\rundll32.exe",
                        "*\\msiexec.exe",
                        "*\\forfiles.exe",
                        "*\\scriptrunner.exe",
                        "*\\mftrace.exe",
                        "*\\AppVLP.exe"
                    ],
                    "ParentImage": [
                        "*\\WINWORD.EXE",
                        "*\\EXCEL.EXE",
                        "*\\POWERPNT.exe",
                        "*\\MSPUB.exe",
                        "*\\VISIO.exe",
                        "*\\OUTLOOK.EXE"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1059",
                "attack.T1202"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f0beca5d-19bf-475b-a97c-45bacf4b7d72",
            "created": "2018-12-03T23:30:44.812Z",
            "modified": "2018-12-03T23:30:44.812Z",
            "title": "Registry Persistence via Explorer Run Key",
            "status": "experimental",
            "description": "Detects a possible persistence mechanism using RUN key for Windows Explorer and poiting to a suspicious folder",
            "reference": [
                "https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/"
            ],
            "author": "Florian Roth",
            "date": "2018/07/18",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 13,
                    "Details": [
                        "C:\\Windows\\Temp\\*",
                        "C:\\ProgramData\\*",
                        "*\\AppData\\*",
                        "C:\\$Recycle.bin\\*",
                        "C:\\Temp\\*",
                        "C:\\Users\\Public\\*",
                        "C:\\Users\\Default\\*"
                    ],
                    "TargetObject": "*\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"
                }
            },
            "fields": [
                "Image",
                "ParentImage"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.persistence",
                "attack.t1060",
                "capec.270"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ef279a69-48f6-4785-85c6-c7c6f540b721",
            "created": "2018-12-03T23:30:44.814Z",
            "modified": "2018-12-03T23:30:44.814Z",
            "title": "Suspicious Driver Load from Temp",
            "description": "Detects a driver load from a temporary directory",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 6,
                    "ImageLoaded": "*\\Temp\\*"
                }
            },
            "falsepositives": [
                "there is a relevant set of false positives depending on applications in the environment"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--dcadd11c-5cb9-491e-96c8-8f68ab3c5b10",
            "created": "2018-12-03T23:30:44.822Z",
            "modified": "2018-12-03T23:30:44.822Z",
            "title": "Malicious PowerShell Commandlet Names",
            "status": "experimental",
            "description": "Detects the creation of known powershell scripts for exploitation",
            "references": [
                "https://raw.githubusercontent.com/Neo23x0/sigma/f35c50049fa896dff91ff545cb199319172701e8/rules/windows/powershell/powershell_malicious_commandlets.yml"
            ],
            "author": "Markus Neis",
            "date": "2018/04/07",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 11,
                    "TargetFilename": [
                        "*\\Invoke-DllInjection.ps1",
                        "*\\Invoke-WmiCommand.ps1",
                        "*\\Get-GPPPassword.ps1",
                        "*\\Get-Keystrokes.ps1",
                        "*\\Get-VaultCredential.ps1",
                        "*\\Invoke-CredentialInjection.ps1",
                        "*\\Invoke-Mimikatz.ps1",
                        "*\\Invoke-NinjaCopy.ps1",
                        "*\\Invoke-TokenManipulation.ps1",
                        "*\\Out-Minidump.ps1",
                        "*\\VolumeShadowCopyTools.ps1",
                        "*\\Invoke-ReflectivePEInjection.ps1",
                        "*\\Get-TimedScreenshot.ps1",
                        "*\\Invoke-UserHunter.ps1",
                        "*\\Find-GPOLocation.ps1",
                        "*\\Invoke-ACLScanner.ps1",
                        "*\\Invoke-DowngradeAccount.ps1",
                        "*\\Get-ServiceUnquoted.ps1",
                        "*\\Get-ServiceFilePermission.ps1",
                        "*\\Get-ServicePermission.ps1",
                        "*\\Invoke-ServiceAbuse.ps1",
                        "*\\Install-ServiceBinary.ps1",
                        "*\\Get-RegAutoLogon.ps1",
                        "*\\Get-VulnAutoRun.ps1",
                        "*\\Get-VulnSchTask.ps1",
                        "*\\Get-UnattendedInstallFile.ps1",
                        "*\\Get-WebConfig.ps1",
                        "*\\Get-ApplicationHost.ps1",
                        "*\\Get-RegAlwaysInstallElevated.ps1",
                        "*\\Get-Unconstrained.ps1",
                        "*\\Add-RegBackdoor.ps1",
                        "*\\Add-ScrnSaveBackdoor.ps1",
                        "*\\Gupt-Backdoor.ps1",
                        "*\\Invoke-ADSBackdoor.ps1",
                        "*\\Enabled-DuplicateToken.ps1",
                        "*\\Invoke-PsUaCme.ps1",
                        "*\\Remove-Update.ps1",
                        "*\\Check-VM.ps1",
                        "*\\Get-LSASecret.ps1",
                        "*\\Get-PassHashes.ps1",
                        "*\\Invoke-Mimikatz.ps1",
                        "*\\Show-TargetScreen.ps1",
                        "*\\Port-Scan.ps1",
                        "*\\Invoke-PoshRatHttp.ps1",
                        "*\\Invoke-PowerShellTCP.ps1",
                        "*\\Invoke-PowerShellWMI.ps1",
                        "*\\Add-Exfiltration.ps1",
                        "*\\Add-Persistence.ps1",
                        "*\\Do-Exfiltration.ps1",
                        "*\\Start-CaptureServer.ps1",
                        "*\\Invoke-ShellCode.ps1",
                        "*\\Get-ChromeDump.ps1",
                        "*\\Get-ClipboardContents.ps1",
                        "*\\Get-FoxDump.ps1",
                        "*\\Get-IndexedItem.ps1",
                        "*\\Get-Screenshot.ps1",
                        "*\\Invoke-Inveigh.ps1",
                        "*\\Invoke-NetRipper.ps1",
                        "*\\Invoke-EgressCheck.ps1",
                        "*\\Invoke-PostExfil.ps1",
                        "*\\Invoke-PSInject.ps1",
                        "*\\Invoke-RunAs.ps1",
                        "*\\MailRaider.ps1",
                        "*\\New-HoneyHash.ps1",
                        "*\\Set-MacAttribute.ps1",
                        "*\\Invoke-DCSync.ps1",
                        "*\\Invoke-PowerDump.ps1",
                        "*\\Exploit-Jboss.ps1",
                        "*\\Invoke-ThunderStruck.ps1",
                        "*\\Invoke-VoiceTroll.ps1",
                        "*\\Set-Wallpaper.ps1",
                        "*\\Invoke-InveighRelay.ps1",
                        "*\\Invoke-PsExec.ps1",
                        "*\\Invoke-SSHCommand.ps1",
                        "*\\Get-SecurityPackages.ps1",
                        "*\\Install-SSP.ps1",
                        "*\\Invoke-BackdoorLNK.ps1",
                        "*\\PowerBreach.ps1",
                        "*\\Get-SiteListPassword.ps1",
                        "*\\Get-System.ps1",
                        "*\\Invoke-BypassUAC.ps1",
                        "*\\Invoke-Tater.ps1",
                        "*\\Invoke-WScriptBypassUAC.ps1",
                        "*\\PowerUp.ps1",
                        "*\\PowerView.ps1",
                        "*\\Get-RickAstley.ps1",
                        "*\\Find-Fruit.ps1",
                        "*\\HTTP-Login.ps1",
                        "*\\Find-TrustedDocuments.ps1",
                        "*\\Invoke-Paranoia.ps1",
                        "*\\Invoke-WinEnum.ps1",
                        "*\\Invoke-ARPScan.ps1",
                        "*\\Invoke-PortScan.ps1",
                        "*\\Invoke-ReverseDNSLookup.ps1",
                        "*\\Invoke-SMBScanner.ps1",
                        "*\\Invoke-Mimikittenz.ps1"
                    ]
                }
            },
            "falsepositives": [
                "Penetration Tests"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a3c7e4eb-be9e-411e-a347-755ac6f27b82",
            "created": "2018-12-03T23:30:44.825Z",
            "modified": "2018-12-03T23:30:44.825Z",
            "title": "CMSTP UAC Bypass via COM Object Access",
            "status": "stable",
            "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects",
            "references": [
                "http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/",
                "https://twitter.com/hFireF0X/status/897640081053364225"
            ],
            "author": "Nik Seetharaman",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection1 and selection2",
                "selection1": {
                    "EventID": 1,
                    "ParentCommandLine": "*\\DllHost.exe"
                },
                "selection2": {
                    "ParentCommandLine": [
                        "*\\{3E5FC7F9-9A51-4367-9063-A120244FBEC7}",
                        "*\\{3E000D72-A845-4CD9-BD83-80C07C3B881F}"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "Hashes"
            ],
            "falsepositives": [
                "Legitimate CMSTP use (unlikely in modern enterprise environments)"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.privilege_escalation",
                "attack.execution",
                "attack.t1088",
                "attack.t1191",
                "attack.g0069"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e4132405-df40-4b2a-8b51-e3d543f5813a",
            "created": "2018-12-03T23:30:44.827Z",
            "modified": "2018-12-03T23:30:44.827Z",
            "title": "Suspicious Reconnaissance Activity",
            "status": "experimental",
            "description": "Detects suspicious command line activity on Windows systems",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "net group \"domain admins\" /domain",
                        "net localgroup administrators"
                    ],
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Inventory tool runs",
                "Penetration tests",
                "Administrative activity"
            ],
            "level": "medium",
            "analysis": {
                "recommendation": "Check if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)"
            }
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ae5e6f21-8c90-494b-86e8-86e9520b3129",
            "created": "2018-12-03T23:30:44.830Z",
            "modified": "2018-12-03T23:30:44.830Z",
            "title": "New RUN Key Pointing to Suspicious Folder",
            "status": "experimental",
            "description": "Detects suspicious new RUN key element pointing to an executable in a suspicious folder",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html"
            ],
            "author": "Florian Roth, Markus Neis",
            "date": "2018/25/08",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 13,
                    "Details": [
                        "C:\\Windows\\Temp\\*",
                        "*\\AppData\\*",
                        "C:\\$Recycle.bin\\*",
                        "C:\\Temp\\*",
                        "C:\\Users\\Public\\*",
                        "C:\\Users\\Default\\*",
                        "C:\\Users\\Desktop\\*"
                    ],
                    "TargetObject": [
                        "*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\*",
                        "*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\*"
                    ]
                }
            },
            "fields": [
                "Image"
            ],
            "falsepositives": [
                "Software with rare behaviour"
            ],
            "level": "high",
            "tags": [
                "attack.persistence",
                "attack.t1060"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--bdddd9a0-244a-440e-b2a3-ff08fe8ae9db",
            "created": "2018-12-03T23:30:44.833Z",
            "modified": "2018-12-03T23:30:44.833Z",
            "title": "Suspicious Control Panel DLL Load",
            "status": "experimental",
            "description": "Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits",
            "references": [
                "https://twitter.com/rikvduijn/status/853251879320662017"
            ],
            "author": "Florian Roth",
            "date": "2017/04/15",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "CommandLine": "*Shell32.dll*"
                },
                "selection": {
                    "CommandLine": "*\\rundll32.exe *",
                    "EventID": 1,
                    "ParentImage": "*\\System32\\control.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--aa480f1c-1eee-4e17-9c56-39c8dcc9272e",
            "created": "2018-12-03T23:30:44.835Z",
            "modified": "2018-12-03T23:30:44.835Z",
            "title": "PowerShell Download from URL",
            "status": "experimental",
            "description": "Detects a Powershell process that contains download commands in its command line string",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*new-object system.net.webclient).downloadstring(*",
                        "*new-object system.net.webclient).downloadfile(*"
                    ],
                    "EventID": 1,
                    "Image": "*\\powershell.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "medium",
            "tags": [
                "attack.t1086",
                "attack.execution"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--72b3bc38-d48d-488c-a117-3efc9c74db7a",
            "created": "2018-12-03T23:30:44.838Z",
            "modified": "2018-12-03T23:30:44.838Z",
            "title": "Executable in ADS",
            "status": "experimental",
            "description": "Detects the creation of an ADS data stream that contains an executable (non-empty imphash)",
            "references": [
                "https://twitter.com/0xrawsec/status/1002478725605273600?s=21"
            ],
            "author": "Florian Roth, @0xrawsec",
            "date": "2018/06/03",
            "logsource": {
                "product": "windows",
                "description": "Requirements: Sysmon config with Imphash logging activated",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Imphash": "00000000000000000000000000000000"
                },
                "selection": {
                    "EventID": 15
                }
            },
            "fields": [
                "TargetFilename",
                "Image"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.defense_evasion",
                "attack.t1027",
                "attack.s0139"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f07d0885-a592-4a14-8438-d7507ec70e4b",
            "created": "2018-12-03T23:30:44.840Z",
            "modified": "2018-12-03T23:30:44.840Z",
            "title": "Windows Shell Spawning Suspicious Program",
            "status": "experimental",
            "description": "Detects a suspicious child process of a Windows shell",
            "references": [
                "https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html"
            ],
            "author": "Florian Roth",
            "date": "2018/04/06",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\schtasks.exe",
                        "*\\nslookup.exe",
                        "*\\certutil.exe",
                        "*\\bitsadmin.exe",
                        "*\\mshta.exe"
                    ],
                    "ParentImage": [
                        "*\\mshta.exe",
                        "*\\powershell.exe",
                        "*\\cmd.exe",
                        "*\\rundll32.exe",
                        "*\\cscript.exe",
                        "*\\wscript.exe",
                        "*\\wmiprvse.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Administrative scripts"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b7057a6b-76c0-4658-85ba-cbac5bc5af45",
            "created": "2018-12-03T23:30:44.842Z",
            "modified": "2018-12-03T23:30:44.842Z",
            "title": "WMI Persistence - Command Line Event Consumer",
            "status": "experimental",
            "description": "Detects WMI command line event consumers",
            "references": [
                "https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/"
            ],
            "author": "Thomas Patzke",
            "date": "2018/03/07",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7,
                    "Image": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
                    "ImageLoaded": "wbemcons.dll"
                }
            },
            "falsepositives": [
                "Unknown (data set is too small; further testing needed)"
            ],
            "level": "high",
            "tags": [
                "attack.t1084",
                "attack.persistence"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--ab4974ed-db21-4662-898b-abafea4e9914",
            "created": "2018-12-03T23:30:44.845Z",
            "modified": "2018-12-03T23:30:44.845Z",
            "title": "Hiding files with attrib.exe",
            "status": "experimental",
            "description": "Detects usage of attrib.exe to hide files from users.",
            "author": "Sami Ruohonen",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not (ini or intel)",
                "ini": {
                    "CommandLine": "*\\desktop.ini *"
                },
                "intel": {
                    "CommandLine": "+R +H +S +A \\*.cui",
                    "ParentCommandLine": "C:\\WINDOWS\\system32\\\\*.bat",
                    "ParentImage": "*\\cmd.exe"
                },
                "selection": {
                    "CommandLine": "* +h *",
                    "EventID": 1,
                    "Image": "*\\attrib.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "User"
            ],
            "falsepositives": [
                "igfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)",
                "msiexec.exe hiding desktop.ini"
            ],
            "level": "low",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1158"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e7542d2e-4946-411d-aea0-6e226bc6cc97",
            "created": "2018-12-03T23:30:44.847Z",
            "modified": "2018-12-03T23:30:44.847Z",
            "title": "Execution in Webserver Root Folder",
            "status": "experimental",
            "description": "Detects a suspicious program execution in a web service root folder (filter out false positives)",
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image": [
                        "*bin\\*",
                        "*\\Tools\\*",
                        "*\\SMSComponent\\*"
                    ],
                    "ParentImage": [
                        "*\\services.exe"
                    ]
                },
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\wwwroot\\*",
                        "*\\wmpub\\*",
                        "*\\htdocs\\*"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Various applications",
                "Tools that include ping or nslookup command invocations"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--697ca830-f886-48a0-b16b-895cd7a01fe6",
            "created": "2018-12-03T23:30:44.850Z",
            "modified": "2018-12-03T23:30:44.850Z",
            "title": "WSF/JSE/JS/VBA/VBE File Execution",
            "status": "experimental",
            "description": "Detects suspicious file execution by wscript and cscript",
            "author": "Michael Haag",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*.jse",
                        "*.vbe",
                        "*.js",
                        "*.vba"
                    ],
                    "EventID": 1,
                    "Image": [
                        "*\\wscript.exe",
                        "*\\cscript.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy."
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--43b5205e-cf47-4d8f-87d0-48ab8aa8100f",
            "created": "2018-12-03T23:30:44.853Z",
            "modified": "2018-12-03T23:30:44.853Z",
            "title": "Sticky Key Like Backdoor Usage",
            "description": "Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen",
            "references": [
                "https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/"
            ],
            "author": "Florian Roth, @twjackomo",
            "date": "2018/03/15",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection_process": {
                    "CommandLine": [
                        "*\\cmd.exe sethc.exe *",
                        "*\\cmd.exe utilman.exe *",
                        "*\\cmd.exe osk.exe *",
                        "*\\cmd.exe Magnify.exe *",
                        "*\\cmd.exe Narrator.exe *",
                        "*\\cmd.exe DisplaySwitch.exe *"
                    ],
                    "EventID": 1,
                    "ParentImage": [
                        "*\\winlogon.exe"
                    ]
                },
                "selection_registry": {
                    "EventID": 13,
                    "EventType": "SetValue",
                    "TargetObject": [
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger",
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger",
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger",
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger",
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger",
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "critical",
            "tags": [
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.t1015"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a48104d2-83ff-4825-a091-3a7ce404e77b",
            "created": "2018-12-03T23:30:44.857Z",
            "modified": "2018-12-03T23:30:44.857Z",
            "title": "System File Execution Location Anomaly",
            "status": "experimental",
            "description": "Detects a Windows program executable started in a suspicious folder",
            "references": [
                "https://twitter.com/GelosSnake/status/934900723426439170"
            ],
            "author": "Florian Roth",
            "date": "2017/11/27",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image": [
                        "*\\System32\\*",
                        "*\\SysWow64\\*"
                    ]
                },
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\svchost.exe",
                        "*\\rundll32.exe",
                        "*\\services.exe",
                        "*\\powershell.exe",
                        "*\\regsvr32.exe",
                        "*\\spoolsv.exe",
                        "*\\lsass.exe",
                        "*\\smss.exe",
                        "*\\csrss.exe",
                        "*\\conhost.exe"
                    ]
                }
            },
            "falsepositives": [
                "Exotic software"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--521cb94e-6e3b-4b94-8ccb-4c002faf4881",
            "created": "2018-12-03T23:30:44.859Z",
            "modified": "2018-12-03T23:30:44.859Z",
            "title": "Bitsadmin Download",
            "status": "experimental",
            "description": "Detects usage of bitsadmin downloading a file",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264"
            ],
            "author": "Michael Haag",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "/transfer"
                    ],
                    "EventID": 1,
                    "Image": [
                        "*\\bitsadmin.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Some legitimate apps use this, but limited."
            ],
            "level": "medium",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--5612bd43-91df-4bfe-b945-3532307fd7e4",
            "created": "2018-12-03T23:30:44.861Z",
            "modified": "2018-12-03T23:30:44.861Z",
            "title": "Exploit for CVE-2017-0261",
            "status": "experimental",
            "description": "Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html"
            ],
            "author": "Florian Roth",
            "date": "2018/02/22",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\FLTLDR.exe*",
                    "ParentImage": "*\\WINWORD.EXE"
                }
            },
            "falsepositives": [
                "Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3dc66d0c-3b4d-47b3-af2f-a83c2db00131",
            "created": "2018-12-03T23:30:44.863Z",
            "modified": "2018-12-03T23:30:44.863Z",
            "title": "Registry Persistence Mechanisms",
            "description": "Detects persistence registry keys",
            "references": [
                "https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/"
            ],
            "author": "Karneades",
            "date": "2018/04/11",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection_reg1": {
                    "EventID": 13,
                    "EventType": "SetValue",
                    "TargetObject": [
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\*\\GlobalFlag",
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\ReportingMode",
                        "*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\MonitorProcess"
                    ]
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "critical",
            "tags": [
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.defense_evasion",
                "attack.t1183"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d73df325-f9c0-4254-8af3-6ca35cd470c7",
            "created": "2018-12-03T23:30:44.867Z",
            "modified": "2018-12-03T23:30:44.867Z",
            "title": "Regsvr32 Anomaly",
            "status": "experimental",
            "description": "Detects various anomalies in relation to regsvr32.exe",
            "references": [
                "https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "selection1": {
                    "CommandLine": "*\\Temp\\*",
                    "EventID": 1,
                    "Image": "*\\regsvr32.exe"
                },
                "selection2": {
                    "EventID": 1,
                    "Image": "*\\regsvr32.exe",
                    "ParentImage": "*\\powershell.exe"
                },
                "selection3": {
                    "CommandLine": [
                        "*/i:http* scrobj.dll",
                        "*/i:ftp* scrobj.dll"
                    ],
                    "EventID": 1,
                    "Image": "*\\regsvr32.exe"
                },
                "selection4": {
                    "EventID": 1,
                    "Image": "*\\wscript.exe",
                    "ParentImage": "*\\regsvr32.exe"
                },
                "selection5": {
                    "CommandLine": "*..\\..\\..\\Windows\\System32\\regsvr32.exe *",
                    "EventID": 1,
                    "Image": "*\\EXCEL.EXE"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.t1117",
                "attack.defense_evasion",
                "attack.execution"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--d856849c-4afd-4dd5-8508-f4fae535b11d",
            "created": "2018-12-03T23:30:44.869Z",
            "modified": "2018-12-03T23:30:44.869Z",
            "title": "Taskmgr as LOCAL_SYSTEM",
            "status": "experimental",
            "description": "Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM",
            "author": "Florian Roth",
            "date": "2018/03/18",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\taskmgr.exe",
                    "User": "NT AUTHORITY\\SYSTEM"
                }
            },
            "falsepositives": [
                "Unkown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--308b96b2-8f0e-4284-b3a4-51d0a11b401d",
            "created": "2018-12-03T23:30:44.871Z",
            "modified": "2018-12-03T23:30:44.871Z",
            "title": "Detection of PowerShell Execution via DLL",
            "status": "experimental",
            "description": "Detects PowerShell Strings applied to rundllas seen in PowerShdll.dll",
            "references": [
                "https://github.com/p3nt4/PowerShdll/blob/master/README.md"
            ],
            "author": "Markus Neis",
            "date": "2018/08/25",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "(selection1 or selection2) and selection3",
                "selection1": {
                    "EventID": 1,
                    "Image": [
                        "*\\rundll32.exe"
                    ]
                },
                "selection2": {
                    "Description": [
                        "*Windows-Hostprozess (Rundll32)*"
                    ],
                    "EventID": 1
                },
                "selection3": {
                    "CommandLine": [
                        "*Default.GetString*",
                        "*FromBase64String*"
                    ],
                    "EventID": 1
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--12235c58-522d-4ee7-a946-1e39a847ba3b",
            "created": "2018-12-03T23:30:44.873Z",
            "modified": "2018-12-03T23:30:44.873Z",
            "title": "Command Line Execution with suspicious URL and AppData Strings",
            "status": "experimental",
            "description": "Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)",
            "references": [
                "https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100",
                "https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "cmd.exe /c *http://*%AppData%",
                        "cmd.exe /c *https://*%AppData%"
                    ],
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "High"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--42b5fb7a-6ab0-4bc2-93d1-76f978f77d69",
            "created": "2018-12-03T23:30:44.875Z",
            "modified": "2018-12-03T23:30:44.875Z",
            "title": "Password Dumper Remote Thread in LSASS",
            "status": "stable",
            "description": "Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundreds of events.",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/WCE.htm"
            ],
            "author": "Thomas Patzke",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 8,
                    "StartModule": null,
                    "TargetImage": "C:\\Windows\\System32\\lsass.exe"
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.s0005"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--3564add8-9f88-417e-8269-964e59cede6e",
            "created": "2018-12-03T23:30:44.877Z",
            "modified": "2018-12-03T23:30:44.877Z",
            "title": "Possible Shim Database Persistence via sdbinst.exe",
            "status": "experimental",
            "description": "Detects execution of sdbinst writing to default shim database path C:\\Windows\\AppPatch\\*",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html"
            ],
            "author": "Markus Neis",
            "date": "2018-08-03",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*\\AppPatch\\*}.sdb*"
                    ],
                    "EventID": 1,
                    "Image": [
                        "*\\sdbinst.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.persistence",
                "attack.t1138"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b7edcab0-8cca-4f82-a6a3-004a1ef1e8e7",
            "created": "2018-12-03T23:30:44.880Z",
            "modified": "2018-12-03T23:30:44.880Z",
            "title": "Shells Spawned by Web Servers",
            "status": "experimental",
            "description": "Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack",
            "author": "Thomas Patzke",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\cmd.exe",
                        "*\\sh.exe",
                        "*\\bash.exe",
                        "*\\powershell.exe"
                    ],
                    "ParentImage": [
                        "*\\w3wp.exe",
                        "*\\httpd.exe",
                        "*\\nginx.exe",
                        "*\\php-cgi.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Particular web applications may spawn a shell process legitimately"
            ],
            "level": "high",
            "tags": [
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.t1100"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--4e102667-dd70-4edc-b875-298454e4aba6",
            "created": "2018-12-03T23:30:44.882Z",
            "modified": "2018-12-03T23:30:44.882Z",
            "title": "Cmdkey Cached Credentials Recon",
            "status": "experimental",
            "description": "Detects usage of cmdkey to look for cached credentials",
            "reference": [
                "https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation",
                "https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx"
            ],
            "author": "jmallette",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": "* /list *",
                    "EventID": 1,
                    "Image": "*\\cmdkey.exe"
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "User"
            ],
            "falsepositives": [
                "Legitimate administrative tasks."
            ],
            "level": "low"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--b8483575-67ab-4b0f-80ce-3e508b83e661",
            "created": "2018-12-03T23:30:44.884Z",
            "modified": "2018-12-03T23:30:44.884Z",
            "title": "Suspicious Program Location with Network Connections",
            "status": "experimental",
            "description": "Detects programs with network connections running in suspicious files system locations",
            "references": [
                "https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo"
            ],
            "author": "Florian Roth",
            "date": "2017/03/19",
            "logsource": {
                "product": "windows",
                "description": "Use the following config to generate the necessary Event ID 3 Network Connection events",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "Image": [
                        "*\\ProgramData\\*",
                        "*\\$Recycle.bin",
                        "*\\Users\\All Users\\*",
                        "*\\Users\\Default\\*",
                        "*\\Users\\Public\\*",
                        "C:\\Perflogs\\*",
                        "*\\config\\systemprofile\\*",
                        "*\\Windows\\Fonts\\*",
                        "*\\Windows\\IME\\*",
                        "*\\Windows\\addins\\*"
                    ]
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--00ce5ac3-1b93-4aa7-aec2-76e851232dcf",
            "created": "2018-12-03T23:30:44.887Z",
            "modified": "2018-12-03T23:30:44.887Z",
            "title": "WScript or CScript Dropper",
            "status": "experimental",
            "description": "Detects wscript/cscript executions of scripts located in user directories",
            "author": "Margaritis Dimitrios (idea), Florian Roth (rule)",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "falsepositive": {
                    "ParentImage": "*\\winzip*"
                },
                "selection": {
                    "CommandLine": [
                        "* C:\\Users\\*.jse *",
                        "* C:\\Users\\*.vbe *",
                        "* C:\\Users\\*.js *",
                        "* C:\\Users\\*.vba *",
                        "* C:\\Users\\*.vbs *",
                        "* C:\\ProgramData\\*.jse *",
                        "* C:\\ProgramData\\*.vbe *",
                        "* C:\\ProgramData\\*.js *",
                        "* C:\\ProgramData\\*.vba *",
                        "* C:\\ProgramData\\*.vbs *"
                    ],
                    "EventID": 1,
                    "Image": [
                        "*\\wscript.exe",
                        "*\\cscript.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Winzip",
                "Other self-extractors"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--098b8202-e89c-45cc-97ca-6d606339ffa0",
            "created": "2018-12-03T23:30:44.889Z",
            "modified": "2018-12-03T23:30:44.889Z",
            "title": "Detection of SafetyKatz",
            "status": "experimental",
            "description": "Detects possible SafetyKatz Behaviour",
            "references": [
                "https://github.com/GhostPack/SafetyKatz"
            ],
            "author": "Markus Neis",
            "date": "2018/24/07",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 11,
                    "TargetFilename": "*\\Temp\\debug.bin"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "tags": [
                "attack.credential_access",
                "attack.T1003"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--92134e1d-496d-4c86-a53e-158fd0977bc9",
            "created": "2018-12-03T23:30:44.890Z",
            "modified": "2018-12-03T23:30:44.890Z",
            "title": "Mimikatz Detection LSASS Access",
            "status": "experimental",
            "description": "Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION, 0x0010 PROCESS_VM_READ)",
            "references": [
                "https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow"
            ],
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 10,
                    "GrantedAccess": "0x1410",
                    "TargetImage": "C:\\windows\\system32\\lsass.exe"
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high",
            "tags": [
                "attack.t1003",
                "attack.s0002",
                "attack.lateral_movement",
                "attack.credential_access"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--48fa6ef1-f422-45cc-9070-67a6db19d4a4",
            "created": "2018-12-03T23:30:44.895Z",
            "modified": "2018-12-03T23:30:44.895Z",
            "title": "Suspicious Typical Malware Back Connect Ports",
            "status": "experimental",
            "description": "Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases",
            "references": [
                "https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo"
            ],
            "author": "Florian Roth",
            "date": "2017/03/19",
            "logsource": {
                "product": "windows",
                "description": "Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image": "*\\Program Files*"
                },
                "selection": {
                    "EventID": 3,
                    "DestinationPort": [
                        "4443",
                        "2448",
                        "8143",
                        "1777",
                        "1443",
                        "243",
                        "65535",
                        "13506",
                        "3360",
                        "200",
                        "198",
                        "49180",
                        "13507",
                        "6625",
                        "4444",
                        "4438",
                        "1904",
                        "13505",
                        "13504",
                        "12102",
                        "9631",
                        "5445",
                        "2443",
                        "777",
                        "13394",
                        "13145",
                        "12103",
                        "5552",
                        "3939",
                        "3675",
                        "666",
                        "473",
                        "5649",
                        "4455",
                        "4433",
                        "1817",
                        "100",
                        "65520",
                        "1960",
                        "1515",
                        "743",
                        "700",
                        "14154",
                        "14103",
                        "14102",
                        "12322",
                        "10101",
                        "7210",
                        "4040",
                        "9943"
                    ]
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "medium"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--7bc95ead-b861-42dc-838e-5e6bfe162a60",
            "created": "2018-12-03T23:30:44.897Z",
            "modified": "2018-12-03T23:30:44.897Z",
            "title": "QuarksPwDump Dump File",
            "status": "experimental",
            "description": "Detects a dump file written by QuarksPwDump password dumper",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm"
            ],
            "author": "Florian Roth",
            "date": "2018/02/10",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 11,
                    "TargetFilename": "*\\AppData\\Local\\Temp\\SAM-*.dmp*"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1f71eec5-aa84-4995-99ca-80cb198582ec",
            "created": "2018-12-03T23:30:44.899Z",
            "modified": "2018-12-03T23:30:44.899Z",
            "title": "DHCP Callout DLL installation",
            "status": "experimental",
            "description": "Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)",
            "references": [
                "https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html",
                "https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx",
                "https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx"
            ],
            "author": "Dimitrios Slamaris",
            "date": "2017/05/15",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 13,
                    "TargetObject": [
                        "*\\Services\\DHCPServer\\Parameters\\CalloutDlls",
                        "*\\Services\\DHCPServer\\Parameters\\CalloutEnabled"
                    ]
                }
            },
            "falsepositives": [
                "unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--8c2f65f3-c3bf-4abf-b67d-82007e1b82c4",
            "created": "2018-12-03T23:30:44.901Z",
            "modified": "2018-12-03T23:30:44.901Z",
            "title": "Suspicious TSCON Start",
            "status": "experimental",
            "description": "Detects a tscon.exe start as LOCAL SYSTEM",
            "reference": [
                "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html",
                "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6"
            ],
            "author": "Florian Roth",
            "date": "2018/03/17",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": "*\\tscon.exe",
                    "User": "NT AUTHORITY\\SYSTEM"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--66f23392-206e-4e4a-a3c3-e53d49ee61f7",
            "created": "2018-12-03T23:30:44.904Z",
            "modified": "2018-12-03T23:30:44.904Z",
            "title": "Malicious Named Pipe",
            "status": "experimental",
            "description": "Detects the creation of a named pipe used by known APT malware",
            "references": [
                "Various sources"
            ],
            "author": "Florian Roth",
            "date": "2017/11/06",
            "logsource": {
                "product": "windows",
                "description": "Note that you have to configure logging for PipeEvents in Symson config",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        17,
                        18
                    ],
                    "PipeName": [
                        "\\isapi_http",
                        "\\isapi_dg",
                        "\\isapi_dg2",
                        "\\sdlrpc",
                        "\\ahexec",
                        "\\winsession",
                        "\\lsassw",
                        "\\46a676ab7f179e511e30dd2dc41bd388",
                        "\\9f81f59bc58452127884ce513865ed20",
                        "\\e710f28d59aa529d6792ca6ff0ca1b34",
                        "\\rpchlp_3",
                        "\\NamePipe_MoreWindows",
                        "\\pcheap_reuse"
                    ]
                }
            },
            "falsepositives": [
                "Unkown"
            ],
            "level": "critical",
            "tags": [
                "attack.defense_evasion",
                "attack.privelege_escalation",
                "attack.t1055"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--bc1ef471-f1ce-45ba-9599-264c719f5cf9",
            "created": "2018-12-03T23:30:44.906Z",
            "modified": "2018-12-03T23:30:44.906Z",
            "title": "Executables Started in Suspicious Folder",
            "status": "experimental",
            "description": "Detects process starts of binaries from a suspicious folder",
            "references": [
                "https://github.com/mbevilacqua/appcompatprocessor/blob/master/AppCompatSearch.txt",
                "https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses"
            ],
            "author": "Florian Roth",
            "date": "2017/10/14",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "C:\\PerfLogs\\*",
                        "C:\\$Recycle.bin\\*",
                        "C:\\Intel\\Logs\\*",
                        "C:\\Users\\Default\\*",
                        "C:\\Users\\Public\\*",
                        "C:\\Users\\NetworkService\\*",
                        "C:\\Windows\\Fonts\\*",
                        "C:\\Windows\\Debug\\*",
                        "C:\\Windows\\Media\\*",
                        "C:\\Windows\\Help\\*",
                        "C:\\Windows\\addins\\*",
                        "C:\\Windows\\repair\\*",
                        "C:\\Windows\\security\\*",
                        "*\\RSA\\MachineKeys\\*",
                        "C:\\Windows\\system32\\config\\systemprofile\\*"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--0bb2fab4-f790-4a1c-a13d-229d159a630f",
            "created": "2018-12-03T23:30:44.909Z",
            "modified": "2018-12-03T23:30:44.909Z",
            "title": "DNS ServerLevelPluginDll Install",
            "status": "experimental",
            "description": "Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)",
            "references": [
                "https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83"
            ],
            "author": "Florian Roth",
            "date": "2017/05/08",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "1 of them",
                "dnsadmin": {
                    "CommandLine": "dnscmd.exe /config /serverlevelplugindll *",
                    "EventID": 1
                },
                "dnsregmod": {
                    "EventID": 13,
                    "TargetObject": "*\\services\\DNS\\Parameters\\ServerLevelPluginDll"
                }
            },
            "fields": [
                "EventID",
                "CommandLine",
                "ParentCommandLine",
                "Image",
                "User",
                "TargetObject"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--a119e984-9765-444b-b62e-aaaad1c31bb7",
            "created": "2018-12-03T23:30:44.912Z",
            "modified": "2018-12-03T23:30:44.912Z",
            "title": "Suspicious Certutil Command",
            "status": "experimental",
            "description": "Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility",
            "references": [
                "https://twitter.com/JohnLaTwC/status/835149808817991680",
                "https://twitter.com/subTee/status/888102593838362624",
                "https://twitter.com/subTee/status/888071631528235010",
                "https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/",
                "https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/"
            ],
            "author": "Florian Roth, juju4",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*certutil * -decode *",
                        "*certutil * -decodehex *",
                        "*certutil *-urlcache* http*",
                        "*certutil *-urlcache* ftp*",
                        "*certutil *-URL*",
                        "*certutil *-ping*",
                        "*certutil.exe * -decode *",
                        "*certutil.exe * -decodehex *",
                        "*certutil.exe *-urlcache* http*",
                        "*certutil.exe *-urlcache* ftp*",
                        "*certutil.exe *-URL*",
                        "*certutil.exe *-ping*"
                    ],
                    "EventID": 1
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "level": "high",
            "tags": [
                "attack.defense_evasion",
                "attack.t1140",
                "attack.s0189",
                "attack.g0007"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--91e64d5f-9ece-4eb9-a439-1213700f2451",
            "created": "2018-12-03T23:30:44.914Z",
            "modified": "2018-12-03T23:30:44.914Z",
            "title": "Droppers exploiting CVE-2017-11882",
            "status": "experimental",
            "description": "Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe",
            "references": [
                "https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100",
                "https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw"
            ],
            "author": "Florian Roth",
            "date": "2017/11/23",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "ParentImage": "*\\EQNEDT32.EXE"
                }
            },
            "fields": [
                "CommandLine"
            ],
            "falsepositives": [
                "unknown"
            ],
            "level": "critical"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--f8b63b72-ea8b-45e7-89d6-d983ba59e304",
            "created": "2018-12-03T23:30:44.916Z",
            "modified": "2018-12-03T23:30:44.916Z",
            "title": "Taskmgr as Parent",
            "status": "experimental",
            "description": "Detects the creation of a process from Windows task manager",
            "author": "Florian Roth",
            "date": "2018/03/13",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image": [
                        "resmon.exe",
                        "mmc.exe"
                    ]
                },
                "selection": {
                    "EventID": 1,
                    "ParentImage": "*\\taskmgr.exe"
                }
            },
            "fields": [
                "Image",
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Administrative activity"
            ],
            "level": "low"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--6d237007-77f0-40dd-a739-7f790456dc92",
            "created": "2018-12-03T23:30:44.919Z",
            "modified": "2018-12-03T23:30:44.919Z",
            "title": "Microsoft Outlook Spawning Windows Shell",
            "status": "experimental",
            "description": "Detects a Windows command line executable started from Microsoft Outlook",
            "references": [
                "https://www2.cybereason.com/asset/60:research-cobalt-kitty-attack-lifecycle"
            ],
            "author": "Florian Roth",
            "date": "2018/03/06",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\cmd.exe",
                        "*\\powershell.exe",
                        "*\\wscript.exe",
                        "*\\cscript.exe",
                        "*\\sh.exe",
                        "*\\bash.exe",
                        "*\\schtasks.exe"
                    ],
                    "ParentImage": [
                        "*\\OUTLOOK.EXE"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "False positives are possible, depends on organisation and processes"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--1b5a1c0c-6cb5-4d90-bb8e-6847439f71b8",
            "created": "2018-12-03T23:30:44.921Z",
            "modified": "2018-12-03T23:30:44.921Z",
            "title": "Ping Hex IP",
            "description": "Detects a ping command that uses a hex encoded IP address",
            "references": [
                "https://github.com/vysec/Aggressor-VYSEC/blob/master/ping.cna",
                "https://twitter.com/vysecurity/status/977198418354491392"
            ],
            "author": "Florian Roth",
            "date": "2018/03/23",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*\\ping.exe 0x*",
                        "*\\ping 0x*"
                    ],
                    "EventID": 1
                }
            },
            "fields": [
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Unlikely, because no sane admin pings IP addresses in a hexadecimal form"
            ],
            "level": "high"
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--108a7daa-019c-4ec6-9ba6-a5e884c3ccf8",
            "created": "2018-12-03T23:30:44.923Z",
            "modified": "2018-12-03T23:30:44.923Z",
            "title": "Default PowerSploit Schtasks Persistence",
            "status": "experimental",
            "description": "Detects the creation of a schtask via PowerSploit Default Configuration",
            "references": [
                "https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1"
            ],
            "author": "Markus Neis",
            "date": "2018/03/06",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine": [
                        "*\\schtasks.exe*/Create*/RU*system*/SC*ONLOGON*",
                        "*\\schtasks.exe*/Create*/RU*system*/SC*DAILY*",
                        "*\\schtasks.exe*/Create*/RU*system*/SC*ONIDLE*",
                        "*\\schtasks.exe*/Create*/RU*system*/SC*HOURLY*"
                    ],
                    "ParentImage": [
                        "*\\Powershell.exe"
                    ]
                }
            },
            "falsepositives": [
                "False positives are possible, depends on organisation and processes"
            ],
            "level": "high",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privelege_escalation",
                "attack.t1053",
                "attack.t1086",
                "attack.s0111",
                "attack.g0022",
                "attack.g0060"
            ]
        },
        {
            "type": "x-detection-rule",
            "id": "x-detection-rule--e4d60178-f084-4ce4-8812-300b1ce73432",
            "created": "2018-12-03T23:30:44.926Z",
            "modified": "2018-12-03T23:30:44.926Z",
            "title": "Suspicious PowerShell Invocation based on Parent Process",
            "status": "experimental",
            "description": "Detects suspicious powershell invocations from interpreters or unusual programs",
            "references": [
                "https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/"
            ],
            "author": "Florian Roth",
            "logsource": {
                "product": "windows",
                "service": "sysmon"
            },
            "detection": {
                "condition": "selection and not falsepositive",
                "falsepositive": {
                    "CurrentDirectory": "*\\Health Service State\\*"
                },
                "selection": {
                    "EventID": 1,
                    "Image": [
                        "*\\powershell.exe"
                    ],
                    "ParentImage": [
                        "*\\wscript.exe",
                        "*\\cscript.exe"
                    ]
                }
            },
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "falsepositives": [
                "Microsoft Operations Manager (MOM)",
                "Other scripts"
            ],
            "level": "medium",
            "tags": [
                "attack.execution",
                "attack.t1086"
            ]
        }
    ]
}