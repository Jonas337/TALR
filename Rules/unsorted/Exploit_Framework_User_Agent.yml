type: x-detection-rule
id: x-detection-rule--9303f3e1-97c9-49c1-a883-da2f2d06289e
created: '2018-12-03T23:30:44.440Z'
modified: '2018-12-03T23:30:44.440Z'
title: Exploit Framework User Agent
status: experimental
description: Detects suspicious user agent strings used by exploit / pentest framworks
  like Metasploit in proxy logs
references:
- https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/
author: Florian Roth
logsource:
  category: proxy
detection:
  condition: selection
  selection:
    UserAgent:
    - Internet Explorer *
    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)
    - Mozilla/4.0 (compatible; Metasploit RSPEC)
    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)
    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)
    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)
    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E};
      SLCC1; .N
    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML,
      like Gecko) Chrome/4.0.221.6 Safari/525.13
    - Mozilla/5.0
    - Mozilla/4.0 (compatible; SPIPE/1.0
    - Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0
    - Sametime Community Agent
    - X-FORWARDED-FOR
    - DotDotPwn v2.1
    - SIPDROID
    - '*wordpress hash grabber*'
    - '*exploit*'
fields:
- ClientIP
- URL
- UserAgent
falsepositives:
- Unknown
level: high
source: sigma
